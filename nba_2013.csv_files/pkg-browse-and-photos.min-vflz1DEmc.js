define("modules/clean/react/browse/browse_drag_and_drop",["require","exports","modules/clean/react/browse/models","modules/clean/react/browse/no-jquery"],function(e,t,o,n){"use strict";function i(e,t,o,i,r,a,s){l.add(e,"dragenter",function(e){(t()||o())&&!n.closestElement(e.target,r)&&a()&&(s(null),i())})}function r(e){l.remove(e,"dragenter")}function a(e,t,n,i,r,a,l,s){if(t||n){if(e.is_dir&&!(i&&n)){if(r)return;var c=a.isCurrentPathWriteable()&&!o.File.isReadOnlySharedFolder(e);l(e),s({path:e.fq_path,hasPermissionToUploadToFolder:c})}else l(null),s()}}Object.defineProperty(t,"__esModule",{value:!0});var l=new n.ScopedEventHandlers(document);t.setupExternalDragHandler=i,t.cleanupExternalDragHandler=r,t.onFileDragEnterItem=a}),define("modules/clean/react/browse/file_grouper",["require","exports","modules/core/i18n","modules/clean/datetime","modules/clean/react/browse/constants","modules/clean/react/browse/models"],function(e,t,o,n,i,r){"use strict";function a(e){return e instanceof r.File?r.File.getCategoryDescription(e,!0):i.ExtensionCategories.DOCUMENT}function l(e){return e instanceof r.File?e.is_dir?i.FileTypeCapitalizedCategoryTranslations.FOLDER:r.File.getExtension(e).toUpperCase():d}function s(e){return e instanceof r.File&&e.ts?1e3*e.ts:e instanceof r.Paper?Date.parse(e.last_modified_date):0}function c(e,t,r){var c=[],p=[],h=null;if(t===i.BrowseSortField.CATEGORY)e.forEach(function(e,t){if(e){var o=a(e);o!==h&&(c.push(o),p.push(t),h=o)}});else if(t===i.BrowseSortField.EXTENSION)e.forEach(function(e,t){if(e){var o=l(e);if(o!==h){var n=o;""===o&&(n=d),c.push(n),p.push(t),h=o}}});else if(t===i.BrowseSortField.MODIFIED)if(r===i.SortDirection.DESCENDING){var m=n.getTimeBands(Date.now());e.forEach(function(e,t){if(e){var n,i=s(e);n=i>=m.today?o._("Today"):i>=m.yesterday?o._("Yesterday"):i>=m.thisWeek?o._("This week"):i>=m.lastWeek?o._("Last week"):i>=m.thisMonth?o._("This month"):i>=m.lastMonth?o._("Last month"):i>=m.lastThreeMonths?o._("Three months ago"):o._("Older"),n!==h&&(c.push(n),p.push(t),h=n)}})}else e.forEach(function(e,t){if(e){var o;if(s(e)){var i=new Date(s(e)),r=i.getMonth(),a=i.getFullYear();o=n.month_with_year(r,a)}else o=u;o!==h&&(c.push(o),p.push(t),h=o)}});return{sectionLabels:c,sectionStartIndices:p}}Object.defineProperty(t,"__esModule",{value:!0});var d=o._("Extensionless",{comment:"Label for files without extensions like .txt or .png"}),u=o._("Missing dates",{comment:"label for group of files without dates marking when they are created or modified"});t.getSections=c}),define("modules/clean/react/browse/files_view/constants",["require","exports","modules/clean/react/browse/constants","modules/core/i18n"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PAGE_HEADER_HEIGHT=96,t.DEFAULT_COLUMN_HEADER_HEIGHT=40,t.DEFAULT_ROW_HEIGHT=72,t.DEFAULT_VIEWPORT_TOP_OFFSET=t.DEFAULT_PAGE_HEADER_HEIGHT+t.DEFAULT_COLUMN_HEADER_HEIGHT,t.COMPACT_PAGE_HEADER_HEIGHT=76,t.COMPACT_COLUMN_HEADER_HEIGHT=48,t.COMPACT_VIEWPORT_TOP_OFFSET=t.COMPACT_PAGE_HEADER_HEIGHT+t.COMPACT_COLUMN_HEADER_HEIGHT,t.PINNED_TEAM_FOLDER_SECONDARY_HEADER_PADDING_TOP=12;t.LIST_VIEW_COLUMN_FLEX={3:["0 0 36px","1 1 50%","0 0 25%","0 0 25%"],2:["0 0 36px","1 1 60%","0 0 40%"],1:["0 0 36px","1 1 100%"]},t.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX={2:["0 0 36px","1 1 66%","0 0 34%"],1:["0 0 36px","1 1 100%"]},t.GRID_VIEW_COLUMN_FLEX=["0 0 36px","1 1"],t.LIST_VIEW_COLUMNS=[{sortField:o.BrowseSortField.FILENAME,label:n._("Name"),isLocked:!0},{sortField:o.BrowseSortField.MODIFIED,label:n._("Modified")},{sortField:o.BrowseSortField.SHARED_WITH,label:n._("Members")},{sortField:o.BrowseSortField.CATEGORY,label:n._("Type")},{sortField:o.BrowseSortField.EXTENSION,label:n._("Extension")},{sortField:o.BrowseSortField.SIZE,label:n._("Size")}],t.GRID_VIEW_COLUMNS=[{sortField:o.BrowseSortField.FILENAME,label:n._("Name")},{sortField:o.BrowseSortField.MODIFIED,label:n._("Modified")},{sortField:o.BrowseSortField.CATEGORY,label:n._("Type")},{sortField:o.BrowseSortField.EXTENSION,label:n._("Extension")},{sortField:o.BrowseSortField.SIZE,label:n._("Size")}],t.SEARCH_LIST_VIEW_COLUMNS=[{sortField:o.BrowseSortField.FILENAME,label:"",isLocked:!0,isSortDisabled:!0},{sortField:o.BrowseSortField.MODIFIED,label:n._("Modified"),isLocked:!0,isSortDisabled:!0}],t.SELECTABLE_LIST_KEY_SCOPE="FilesViewSelectableList",t.TILE_GRID_SCOPE="BrowseTileGrid",t.SELECTABLE_LIST_LINKED_OUTSIDE_CLASSES=[".bubble-menu-item-wrapper",".browse-menu",".context-menu",".react-file-viewer",".db-modal"]}),define("modules/clean/react/browse/files_view/star",["require","exports","external/react"],function(e,t,o){"use strict";function n(t){var n=t.fileId,i=t.user,r=t.className,a=t.onStarClick,l=e("modules/clean/react/starred/browse_exports"),s=l.Star,c=l.HOME_RESOURCE_ID_TYPE,d=l.StarredSource;return o.createElement("div",{className:r},o.createElement(s,{id:n,key:"star",idType:c.ENCODED_FILE_OBJ_ID,user:i,onStarClick:a,source:d.BROWSE}))}Object.defineProperty(t,"__esModule",{value:!0}),t.StarContainer=n}),define("modules/clean/react/browse/files_view/tile_grid",["require","exports","tslib","external/classnames","external/immutable","external/react","external/spectrum/button","modules/clean/em_string","modules/clean/filepath","modules/clean/react/browse/browse_drag_and_drop","modules/clean/react/browse/constants","modules/clean/react/browse/file_grouper","modules/clean/react/browse/keyboard_shortcuts","modules/clean/react/browse/models","modules/clean/react/browse/overflow_menu","modules/clean/react/browse/tile_label_input","modules/clean/react/maestro/tile_grid","modules/clean/react/title_bubble","modules/core/i18n","modules/core/uri","modules/clean/browse_interface","modules/clean/react/browse/files_view/constants","modules/clean/react/browse/files_view/star","modules/clean/react/browse/util"],function(e,t,o,n,i,r,a,l,s,c,d,u,p,h,m,f,_,g,T,b,E,S,w,v){"use strict";function y(e){var t;return e.thumbnail_url_tmpl&&(t=b.parse(e.thumbnail_url_tmpl),t=t.removeQuery("size").removeQuery("size_mode"),t=t.updateQuery({size:"256x256",size_mode:"2"}).toString()),t}Object.defineProperty(t,"__esModule",{value:!0}),t.getThumbnailUrlForItem=y;var I=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onStarClickCallback=function(e){var o=t.props,n=o.onStarClick,i=o.item,r=i;n&&n(r,e)},t}return o.__extends(t,e),t.prototype.render=function(){var e,t=this.props,o=t.fileRename,n=t.arePostTTIModulesLoaded,i=t.user,a=t.item,c=t.inSelectMode,u=t.createRenameCancelHandler,p=t.createRenameSubmitHandler,m=a instanceof h.File,b=a,E=a;if(e=m?s.filename(b.fq_path):E.title,m&&o&&s.paths_are_equal(o.file.fq_path,b.fq_path)){if(o.state===d.RenameState.PENDING_INPUT)return r.createElement(f.TileLabelInput,{defaultValue:e,label:e,onCancel:u(b),onSubmit:p(b)});if(o.state===d.RenameState.SAVING_INPUT)return r.createElement(_.TileItemLabelText,{className:"tile-label__text--saving",label:T._("Renaming…")})}var S=l.Emstring.em_snippet(e,14,.5),v=n&&!c&&!h.File.isNoAccessSharedFolder(b),y=r.createElement(_.TileItemLabelText,{key:"label",label:S});e!==S&&(y=r.createElement(g.TitleBubble,{content:e,position:g.TitleBubble.POSITIONS.BOTTOM,className:"tile-label__title-bubble",key:"tooltip"},y));var I=r.createElement(w.StarContainer,{fileId:b.file_id,user:i,className:"tile-star",key:"tileStar",onStarClick:this.onStarClickCallback});return r.createElement("span",null,[y,v&&!o&&I])},t})(r.PureComponent);t.TileLabel=I;var L=(function(t){function l(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={inSelectMode:!1,sectionLabels:i.List(),sectionStartIndices:i.List(),selectedIds:i.Set(),totalNumItems:0},e.handleFileViewerUnmount=function(){e.tileGrid&&e.tileGrid.getAndUpdateTileLayout();var t=e.props.selectedFiles.first();t&&e.props.onFocusFile(t.fq_path)},e.createRenameCancelHandler=function(t){return function(){e.props.onRenameCancel(t)}},e.createRenameSubmitHandler=function(t){return function(o){e.props.onRenameSubmit(t,o)}},e.setTileGridRef=function(t){e.tileGrid=t},e.getTileItem=function(t,n){var i,l=e.props,c=l.activeDropTarget,d=l.isCreateFolderUIActive,u=l.isPhotosPage,p=l.items,m=l.selection,f=l.user,_=e.state.inSelectMode;if(d){if(0===t)return e.getCreateFolderTile();t-=1}var g=p.get(t);if(!g){var b="Placeholder "+t;return{altText:b,id:b,isViewOnly:!0,isDraggable:!1,isSelectable:!1}}var S=g instanceof h.File,w=g,v=g,I=e.createViewFileHandler(w),L=e.createToggleSelectHandler(w),C=I,N=!1,P=!1;S&&(i=e.renderTileOverflowMenu(w,n)),_&&S&&(N=m.selected.last()===w.fq_path,P=m.selected.has(w.fq_path),C=L,S&&(i=r.createElement(a.Button,{className:"tile__action-button--view-file",variant:"secondary",size:"small","aria-label":T._("View File"),onClick:I})));var O=u?void 0:e.renderLabelElement(g),A=S?s.filename(w.fq_path):v.title,R=S?y(w):void 0,F=g===c,M=S?w.is_dir?w.href:E.preview_uri_for_fq_path(f,w.fq_path).toString():void 0,D={file:w,id:S?w.sjid.toString():v.pad_id,labelNode:O,altText:A,thumbnailUrl:R,actionNode:i,onTileAction:C,isDraggable:!1,isFocused:N,isSelectable:S,handleToggleSelect:L,checkboxAriaText:T._("Select tile"),href:M};return u||(D=o.__assign({},D,{isDraggable:!0,onDragEnter:e.createDragEnterHandler(w,P,F),onDragStart:e.createDragStartHandler(w,P,L)})),D},e}return o.__extends(l,t),l.prototype.componentWillMount=function(){this.setState({inSelectMode:this.props.selectedFiles.count()>0}),this.setTotalNumItems(this.props),this.setTileItemsSections(this.props),this.setSelectedTiles(this.props)},l.prototype.componentDidMount=function(){this.setupExternalDragHandler(),this.setupKeyboardShortcuts()},l.prototype.componentWillUnmount=function(){this.props.isPhotosPage||p.resetFileJumpKeyboardShortcuts(S.TILE_GRID_SCOPE),p.resetBrowseKeyboardShortcuts(S.TILE_GRID_SCOPE)},l.prototype.componentWillReceiveProps=function(e){e.items===this.props.items&&e.createNewFolderState===this.props.createNewFolderState||this.setTotalNumItems(e),e.selectedFiles!==this.props.selectedFiles&&(this.setSelectedTiles(e),this.setState({inSelectMode:e.selectedFiles.count()>0})),e.activeSortField===this.props.activeSortField&&e.activeSortDirection===this.props.activeSortDirection&&e.sections===this.props.sections&&e.items===this.props.items||this.setTileItemsSections(e)},l.prototype.componentDidUpdate=function(e){(e.createNewFolderState===d.NewFolderCreationState.PENDING_INPUT&&this.props.createNewFolderState===d.NewFolderCreationState.SAVING_INPUT||e.fileRename!==this.props.fileRename||e.items!==this.props.items)&&this.tileGrid.forceUpdate()},l.prototype.setTotalNumItems=function(e){var t=Math.max(e.items.size,e.totalNumItems);e.isCreateFolderUIActive&&(t+=1),this.setState({totalNumItems:t})},l.prototype.setTileItemsSections=function(e){var t;t=e.sections?e.sections:e.activeSortField?u.getSections(e.items,e.activeSortField,e.activeSortDirection):{sectionLabels:[],sectionStartIndices:[]},this.setState({sectionLabels:i.List(t.sectionLabels),sectionStartIndices:i.List(t.sectionStartIndices)})},l.prototype.createToggleSelectHandler=function(e){var t=this,o=e.fq_path;return function(e){e.preventDefault(),e.stopPropagation();var n=t.props.selection;n=n.selected.has(o)?n.update("selected",function(e){return e.delete(o)}):n.update("selected",function(e){return e.add(o)}).set("anchor",o),t.props.onSelectionChange(n)}},l.prototype.renderTileOverflowMenu=function(t,o){var n=this.props,i=n.getFileActions,a=n.arePostTTIModulesLoaded,l=0===o?"left":"right";if(a){var s=e("modules/clean/react/starred/browse_exports").OverflowMenuWithStar;return r.createElement(s,{file:t,getFileActions:i,attachment:l,size:m.OverflowMenuSize.Small,showBorders:!0})}return null},l.prototype.renderLabelElement=function(e){var t=this.state.inSelectMode,n=this.props,i=n.user,a=n.fileRename,l=n.arePostTTIModulesLoaded,s=n.onStarClick,c={user:i,fileRename:a,arePostTTIModulesLoaded:l,onStarClick:s};return r.createElement(I,o.__assign({},c,{item:e,inSelectMode:t,createRenameCancelHandler:this.createRenameCancelHandler,createRenameSubmitHandler:this.createRenameSubmitHandler}))},l.prototype.createViewFileHandler=function(e){var t=this;return function(o){if(e instanceof h.File){if("click"===o.type&&!v.shouldHandleClick(o))return;o.preventDefault(),o.stopPropagation(),t.props.onNavigateToFileOrFolder(e,t.handleFileViewerUnmount)}else e instanceof h.Paper&&t.props.onOpenPaper(o,e)}},l.prototype.setSelectedTiles=function(e){var t=i.Set().withMutations(function(t){e.selectedFiles.forEach(function(e){t.add(e.sjid.toString())})});this.setState({selectedIds:t})},l.prototype.setupExternalDragHandler=function(){var e=this,t=function(){return!!e.props.isDraggingInternalFiles},o=function(){return!!e.props.isDraggingExternalFiles},n=function(){return e.props.activeDropTarget};c.setupExternalDragHandler(S.TILE_GRID_SCOPE,t,o,this.props.setFileUploaderPath,".tile",n,this.props.onSetDropTarget)},l.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.props,o=t.actionHandlers,n=t.deselectAll,i=t.getIsCurrentPathWriteable,r=t.getIsFileJumping,a=t.onCopyToClipboard,l=t.onPasteFromClipboard,s=t.onSetDragCopyMode,c=t.selectAll,d=p.generateGetIsGlobalEvent(this),u=d,h=function(){return e.props.selectedFiles};this.props.isPhotosPage||p.setupFileJumpKeyboardShortcuts({scope:S.TILE_GRID_SCOPE,getIsFileJumping:r}),p.setupGeneralBrowseKeyboardShortcuts({getIsGlobalEvent:d,getIsItemEvent:u,getSelectedFiles:h,isItemList:!1,isCurrentPathWriteable:i,selectAllAction:c,deselectAllAction:n,onCopyToClipboard:a,onDelete:o.onDelete,onPasteFromClipboard:l,onSetDragCopyMode:s,onShowRename:o.onShowRename,scope:S.TILE_GRID_SCOPE,onShowHelpMenu:function(){return e.props.onOpenKeyboardShortcutModal()}})},l.prototype.createDragEnterHandler=function(e,t,o){var n=this;return function(i){n.props.onDragEnter(i,e,t,o)}},l.prototype.createDragStartHandler=function(e,t,o){var n=this;return function(i){t?n.props.onDragStart(i):(o(i),n.props.onDragStart(i,[e]))}},l.prototype.getCreateFolderTile=function(){var e=this.props,t=e.createNewFolderState,o=e.onNewFolderCancel,n=e.onNewFolderSubmit,i=T._("New folder"),a=r.createElement("div",null);return t===d.NewFolderCreationState.PENDING_INPUT?(i=T._("Folder name"),a=r.createElement(f.TileLabelInput,{label:i,onCancel:o,onSubmit:n})):t===d.NewFolderCreationState.SAVING_INPUT&&(i=T._("Creating new folder…"),a=r.createElement(_.TileItemLabelText,{className:"tile-label__text--saving",label:i})),{altText:i,id:"New folder tile",isDraggable:!1,isSelectable:!1,labelNode:a}},l.prototype.getTileGridRef=function(){return this.tileGrid},l.prototype.render=function(){var e=this.props.enableMaxHeightGrouping,t=n({"file-tile-grid-container":!0,"file-tile-grid-container--show-checkboxes":this.state.inSelectMode});return r.createElement("div",null,r.createElement(_.InfiniteTileGrid,{key:"tileGrid",ref:this.setTileGridRef,totalNumItems:this.state.totalNumItems,containerClass:t,rowClass:"file-tile-row",enableMaxHeightGrouping:e,delayRenderFullTile:!this.props.isCreateFolderUIActive,logTileLoading:!0,numThresholdRows:d.BrowseTileGridConstants.NUM_THRESHOLD_ROWS,scrollDeltaThreshold:d.BrowseTileGridConstants.SCROLL_DELTA_THRESHOLD,sectionStartIndices:this.state.sectionStartIndices,sectionLabels:this.state.sectionLabels,showLabels:!this.props.isPhotosPage,contentOffset:136,getTileItem:this.getTileItem,selectedIds:this.state.selectedIds,handleTTI:this.props.onTTI,thumbStore:this.props.thumbStore,onRangeInView:this.props.onRangeInView,tilesPerRow:this.props.tilesPerRow,onTilesPerRowChange:this.props.onTilesPerRowChange}))},l.defaultProps={enableMaxHeightGrouping:!1},l})(r.PureComponent);t.BrowseTileGrid=L}),define("modules/clean/react/browse/keyboard_shortcuts",["require","exports","external/keymaster","external/react-dom","modules/clean/keycode","modules/clean/undo","modules/core/browser","modules/core/i18n","modules/core/notify","modules/clean/react/browse/no-jquery"],function(e,t,o,n,i,r,a,l,s,c){"use strict";function d(e){o.clearScope(e),o.setScope(b)}function u(e,t){return function(o){e(o)&&(o.preventDefault(),"function"==typeof t&&t(o))}}function p(e){return function(t){return!document.activeElement||document.activeElement===document.body||n.findDOMNode(e).contains(t.target)}}function h(e){var t=e.scope,o=e.onSetDragCopyMode,n=function(e,t){return function(o){o.keyCode!==i.KeyCode.CONTROL&&o.keyCode!==i.KeyCode.ALT||t(e)}};E.add(t,"keydown",n(!0,o)),E.add(t,"keyup",n(!1,o))}function m(e){d(e),E.remove(e,"keydown"),E.remove(e,"keyup")}function f(e){var t=e.getIsGlobalEvent,n=e.getIsItemEvent,i=e.getSelectedFiles,c=e.isItemList,d=e.isCurrentPathWriteable,p=e.selectAllAction,m=e.deselectAllAction,f=e.onCopyToClipboard,_=e.onDelete,g=e.onPasteFromClipboard,T=e.onSetDragCopyMode,E=e.onShowRename,S=e.onShowHelpMenu,w=e.scope;h({scope:w,onSetDragCopyMode:T}),b=o.getScope(),b!==w&&o.setScope(w);var v=function(){var e=i(),t=e.some(function(e){return e.read_only});if(1===e.size)if(d()&&!t){var o=e.first();o.isDeleted?s.error(l._("Deleted files can’t be renamed.")):E(o)}else s.warning(l._("You don’t have permission to rename files in this folder."))},y=function(){var e=i();e.size&&_(e.toArray())},I=function(){r.performUndo()},L=function(){return document.getElementsByClassName("search-bar__text-input")[0].focus()};o("f2",w,u(n,v)),o("/",w,u(t,L)),o("shift+/",w,u(t,function(){return S(!!c)})),o("escape",w,u(t,m)),a.mac?(o("command+a",w,u(t,p)),o("command+c",w,u(n,f)),o("backspace",w,u(n,y)),o("command+v",w,u(t,g)),o("command+z",w,u(t,I))):(o("ctrl+a",w,u(t,p)),o("ctrl+c",w,u(n,f)),o("delete",w,u(n,y)),o("ctrl+v",w,u(t,g)),o("ctrl+z",w,u(t,I)))}function _(e){var t=e.getIsGlobalEvent,n=e.getIsItemEvent,i=e.getSelectedFiles,r=e.isCurrentPathWriteable,a=e.enableContextMenu,l=e.selectAllAction,s=e.deselectAllAction,d=e.onCopyToClipboard,p=e.onDelete,h=e.onNavigateToFileOrFolder,m=e.onNavigateToParentFolder,_=e.onPasteFromClipboard,g=e.onSetDragCopyMode,T=e.onShowRename,b=e.onShowHelpMenu,E=e.openContextMenuAtPosition,S=e.scope;f({getIsGlobalEvent:t,getIsItemEvent:n,getSelectedFiles:i,isItemList:!0,isCurrentPathWriteable:r,selectAllAction:l,deselectAllAction:s,onCopyToClipboard:d,onDelete:p,onPasteFromClipboard:_,onSetDragCopyMode:g,onShowRename:T,onShowHelpMenu:b,scope:S});var w=function(){var e=i();1===e.size&&h(e.first())},v=function(){var e=i(),t=e.first();1===e.size&&t.is_dir&&h(t)},y=function(e){if("function"==typeof E&&i().size){var t=c.closestElement(e.target,".browse-file-row--is-selected");if(t){E(t.offsetLeft+200,t.offsetTop+5,t)}}else E(10,10)};o("enter",S,u(n,w)),o("right",S,u(n,v)),o("left",S,u(t,m)),a()&&o("alt+a",S,u(t,y))}function g(t){var n=t.scope,i=t.getIsFileJumping,r=function(e){var t=function(t){o.getScope()===n&&e.handleKeyPress(t,i)};E.add(n,"keypress",t)};r.perfName="file_jump",e(["modules/clean/react/browse/file_jump"],r)}function T(e){E.remove(e,"keypress")}Object.defineProperty(t,"__esModule",{value:!0}),t.GENERAL_SHORTCUTS=[{windowsKey:"Enter",macKey:"return",desc:l._("Open file or folder")},{key:"/",desc:l._("Search")},{windowsKey:"Ctrl + a",macKey:"⌘ + a",desc:l._("Select all files")},{windowsKey:"Esc",macKey:"esc",desc:l._("Deselect all files")},{windowsKey:"Ctrl + c",macKey:"⌘ + c",desc:l._("Copy selected file(s)")},{windowsKey:"Ctrl + v",macKey:"⌘ + v",desc:l._("Paste selected file(s) into the current folder")},{key:"F2",desc:l._("Rename selected file")},{windowsKey:"Delete",macKey:"delete",desc:l._("Delete selected file(s)")},{windowsKey:"Ctrl + z",macKey:"⌘ + z",desc:l._("Undo recent move/copy/rename/delete")},{key:"?",desc:l._("Show keyboard shortcuts")}],t.ITEM_LIST_SHORTCUTS=[{key:"↑",desc:l._("Select previous file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"↓",desc:l._("Select next file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"←",desc:l._("Go up a folder")},{key:"→",desc:l._("Open folder")}].concat(t.GENERAL_SHORTCUTS),t.TILE_GRID_SHORTCUTS=[{key:"↑",desc:l._("Select file in previous row (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"↓",desc:l._("Select file in next row (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"←",desc:l._("Select previous file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"→",desc:l._("Select next file (hold shift to select range)",{comment:"Shift refers to the shift key"})}].concat(t.GENERAL_SHORTCUTS);var b="",E=new c.ScopedEventHandlers(document);t.generateGetIsGlobalEvent=p,t.resetBrowseKeyboardShortcuts=m,t.setupGeneralBrowseKeyboardShortcuts=f,t.setupItemListKeyboardShortcuts=_,t.setupFileJumpKeyboardShortcuts=g,t.resetFileJumpKeyboardShortcuts=T}),define("modules/clean/react/browse/name_input",["require","exports","tslib","external/classnames","external/react","modules/clean/keycode"],function(e,t,o,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,l=function(){};(function(e){e.ESC="ESC",e.SUBMIT="SUBMIT",e.BLUR="BLUR"})(a=t.NameInputActionSource||(t.NameInputActionSource={}));var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setInputRef=function(e){t.inputRef=e},t.handleDragStart=function(e){e.stopPropagation()},t.handleSubmit=function(e){e.preventDefault(),t.submitIfChanged(a.SUBMIT)},t.handleKeyDown=function(e){e.keyCode===r.KeyCode.ESC?(e.preventDefault(),t.props.onCancel({source:a.ESC})):e.keyCode===r.KeyCode.ENTER&&t.handleSubmit(e)},t.handleBlur=function(e){t.submitIfChanged(a.BLUR)},t.handleClick=function(e){e.preventDefault(),t.props.onClick(e)},t}return o.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.inputRef.focus(),window.requestAnimationFrame(function(){var t=e.inputRef.value,o=t.lastIndexOf(".");o<0&&(o=t.length),e.inputRef.setSelectionRange(0,o)})},t.prototype.submitIfChanged=function(e){var t=this.inputRef.value.trim();t===this.props.defaultValue?this.props.onCancel({source:e}):this.props.onSubmit(t)},t.prototype.render=function(){return i.createElement("form",{className:"u-pad-right-xs",onSubmit:this.handleSubmit},i.createElement("input",{ref:this.setInputRef,defaultValue:this.props.defaultValue,className:n("c-input",this.props.className),onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onDragStart:this.handleDragStart,"aria-label":this.props.label,onClick:this.handleClick}))},t.defaultProps={className:"",onCancel:l,onClick:l,onSubmit:l},t})(i.PureComponent);t.NameInput=s}),define("modules/clean/react/browse/overflow_menu",["require","exports","tslib","external/react","external/spectrum/overflow_button","external/spectrum/popover","modules/core/i18n"],function(e,t,o,n,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;(function(e){e[e.Normal=0]="Normal",e[e.Small=1]="Small"})(l=t.OverflowMenuSize||(t.OverflowMenuSize={}));var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.preventDefaultAndStopPropagation=function(e){e.preventDefault(),e.stopPropagation()},t.handleSelection=function(e){e.performAction()},t}return o.__extends(t,e),t.prototype.renderOverflowButton=function(){return n.createElement(i.OverflowButton,{"aria-label":a._("More actions"),className:"browse-overflow-menu-trigger-button",tagName:"span",size:this.props.size===l.Small?"small":"default",variant:this.props.showBorders?"secondary":"borderless"})},t.prototype.render=function(){var e=this.props,t=e.actionItems,o=e.attachment,i=t.map(function(e){return n.createElement(r.PopoverContentItem,{className:e.className,key:e.label,value:e,disabled:e.disabled},e.label)});return n.createElement("div",{className:"browse-overflow-menu",onClick:this.preventDefaultAndStopPropagation,onDoubleClick:this.preventDefaultAndStopPropagation},n.createElement(r.Popover,{onSelection:this.handleSelection,closeOnSelection:!0},n.createElement(r.PopoverTrigger,{className:"browse-overflow-menu-trigger"},this.renderOverflowButton()),n.createElement(r.PopoverContent,{attachment:o,className:"browse-overflow-menu-content"},i)))},t.defaultProps={attachment:"right"},t})(n.PureComponent);t.BrowseOverflowMenu=s}),define("modules/clean/react/browse/tile_label_input",["require","exports","external/classnames","external/react","modules/clean/react/browse/name_input"],function(e,t,o,n,i){"use strict";function r(e){var t=o("tile-label-input",e.className),r=e.defaultValue||"",a=function(e){e.stopPropagation(),e.preventDefault()};return n.createElement(i.NameInput,{className:t,defaultValue:r,label:e.label,onCancel:e.onCancel,onClick:a,onSubmit:e.onSubmit})}Object.defineProperty(t,"__esModule",{value:!0}),t.TileLabelInput=r}),define("modules/clean/react/browse/util",["require","exports","modules/clean/react/browse/models","modules/clean/em_string","modules/clean/filepath","modules/core/i18n"],function(e,t,o,n,i,r){"use strict";function a(e){if(1===e.count()){var t=e.first(),o=i.filename(t.fq_path);return n.Emstring.em_snippet(o,13.5)}if(e.count()>1){var a=function(e){return e.isDeleted},l=e.some(a)&&!e.every(a),s=e.toArray().filter(function(e){return e.is_dir}),c=e.toArray().filter(function(e){return!e.is_dir});if(l)return r._("No available actions");var d=[];if(c.length){var u=r.ungettext("%(num_files)d file","%(num_files)d files",c.length).format({num_files:c.length});d.push(u)}if(s.length){var u=r.ungettext("%(num_folders)d folder","%(num_folders)d folders",s.length).format({num_folders:s.length});d.push(u)}return 2===d.length?r._("%(x)s and %(y)s",{comment:'\n            The whole string is a phrase like "2 files and 3 folders". \'x\' is\n            a string containing a phrase like "2 files" and \'y\' is a string\n            containing a phrase like "3 folders".\n          '}).format({x:d[0],y:d[1]}):d[0]}return""}function l(e,t){var n=e.count(),i=r._("You only have partial access");return n>0?1!==n||o.File.canViewFileMembers(e.first(),t)?r.ungettext("%(count)d item selected","%(count)d items selected",n).format({count:n}):o.File.isNoAccessSharedFolder(e.first())?r._("You don’t have access to this folder"):i:t&&!t.canViewContainingNSMembers?i:""}function s(e){return 0===e.button&&!e.altKey&&!e.ctrlKey&&!e.metaKey}Object.defineProperty(t,"__esModule",{value:!0});t.describeFiles=a,t.getSelectedFilesText=l,t.shouldHandleClick=s}),define("modules/clean/react/file_viewer/async_controller",["require","exports"],function(e,t){"use strict";function o(){Array.from(document.querySelectorAll(r)).forEach(function(e){e.style.display&&e.setAttribute("data-preview-old-display",e.style.display),e.style.display="none"})}function n(){Array.from(document.querySelectorAll(r)).forEach(function(e){e.style.display=e.hasAttribute("data-preview-old-display")?e.getAttribute("data-preview-old-display"):""})}function i(t){var o=t.containerId,n=t.files,i=t.fileViewAction,r=t.fileViewOrigin,a=t.fileViewTarget,l=t.indexOfPreviewFile,s=t.onFileViewerDidMount,c=t.onFileViewerUnmount,d=t.shouldFocusComment,u=void 0!==d&&d,p=t.updateBrowserLocation,h=void 0===p||p,m=t.user;e(["modules/clean/react/file_viewer/controller"],function(e){e.open(n,l,m,o,{fileViewTarget:a,fileViewOrigin:r,fileViewAction:i,shouldFocusCommentInput:u,disableRouting:!h,onComponentDidMount:s,onComponentWillUnmount:c})})}Object.defineProperty(t,"__esModule",{value:!0});var r=[".maestro-chrome","#maestro-nav","#page-footer","#page-header","#page-sidebar","#browse-box",".growth-onboarding-progress-bar__container",".team-progress-bar-experience","#flash-upload-container"].join();t.hideElementsBehindFileViewer=o,t.showElementsBehindFileViewer=n,t.asyncOpenPreview=i}),define("modules/clean/react/home/home_access/home_access_util",["require","exports","modules/constants/starred"],function(e,t,o){"use strict";function n(){return o.HOME_ENABLED}Object.defineProperty(t,"__esModule",{value:!0}),t.isHomeEnabled=n}),define("modules/clean/react/maestro/checkbox",["require","exports","tslib","external/react","external/classnames"],function(e,t,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;(function(e){e[e.Checked=0]="Checked",e[e.PartiallyChecked=1]="PartiallyChecked",e[e.Unchecked=2]="Unchecked"})(r||(r={})),t.CheckboxState=r;var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.render=function(){var e=this.props.checkboxState,t=i({"checkbox-button":!0,"partial-checked":e===r.PartiallyChecked,checked:e===r.Checked});return n.createElement("button",{role:"checkbox","aria-checked":e===r.Checked,"aria-label":this.props.ariaLabel,className:t,onClick:this.props.onClick,onMouseDown:this.props.onMouseDown})},t})(n.PureComponent);t.Checkbox=a}),define("modules/clean/react/maestro/file_list_empty_folder_table",["require","exports","tslib","external/react","external/spectrum/media_table","external/spectrum/table"],function(e,t,o,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTTI&&this.props.onTTI()},t.prototype._renderTitle=function(){return n.createElement("h3",{className:"u-font-strong empty-folder-table-title"},this.props.title)},t.prototype._renderSubtitle=function(){var e=this.props,t=e.subtitle,o=e.subtitleLink,i=e.subtitleOnClick;return t&&o?n.createElement("a",{className:"empty-folder-table-subtitle empty-folder-table-link",href:o,onClick:i},t):t?n.createElement("span",{className:"empty-folder-table-subtitle"},t):void 0},t.prototype.render=function(){for(var e=[],t=0;t<this.props.numRowsAbove;t++)e.push(n.createElement(i.MediaRow,{key:-t-1}));for(var o=[],a=Math.max(this.props.totalRows-this.props.numRowsAbove-1,0),t=0;t<a;t++)o.push(n.createElement(i.MediaRow,{key:t+1}));return n.createElement(r.Table,{className:"empty-folder-table"},n.createElement(r.TableHead,null),n.createElement(r.TableBody,null,e,n.createElement(i.MediaRow,{key:0},n.createElement(i.MediaCell,{className:"empty-folder-table-cell",title:this._renderTitle(),subtitle:this._renderSubtitle()})),o))},t.defaultProps={numRowsAbove:2,totalRows:14},t})(n.PureComponent);t.EmptyFolderTable=a}),define("modules/clean/react/maestro/tile_element",["require","exports","tslib","external/classnames","external/react","modules/clean/keycode","modules/clean/react/maestro/checkbox","modules/clean/react/maestro/tile_grid_logger","modules/clean/react/browse/file_folder_icon"],function(e,t,o,n,i,r,a,l,s){"use strict";function c(e){var t=e.leftOffset,o=e.tileHeight,n=e.tileWidth,r=e.thumbNode,a=e.labelNode,l={left:t,height:o,width:n,pointerEvents:"none"},s={height:n,width:n};return i.createElement("div",{className:"tile",style:l},i.createElement("div",{className:"tile__thumb-container",style:s},r||i.createElement("div",{className:"tile__preview--placeholder"})),a)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){return null};t.TilePlaceholder=c;var u=(function(e){function t(o){var n=e.call(this,o)||this;return n.animationRequestIds=[],n.handleThumbnailError=function(){var e=n.props,t=e.onThumbnailError,o=e.tileIndex;n.setState({thumbLoaded:!1}),t&&t(o)},n.focusTile=function(){if(!n.state.isFocused){var e=n.refs.tileThumbContainer;e&&e.focus()}},n.logTileInteractive=function(){var e=!!n.props.thumbnailUrl,t=n.state.thumbLoaded;if(n.props.onThumbnailLoad){var o=window.requestAnimationFrame(function(){var o=window.requestAnimationFrame(function(){n.props.onThumbnailLoad(n.props.tileIndex,e,t)});n.animationRequestIds.push(o)});n.animationRequestIds.push(o)}},n.toggleSelect=function(e){e.preventDefault(),e.stopPropagation(),n.props.handleToggleSelect(e)},n.handleThumbKeyPress=function(e){var t=e.keyCode;t!==r.KeyCode.SPACE&&t!==r.KeyCode.ENTER||(e.preventDefault(),n.props.onTileAction(e))},n.onBlur=function(e){n.setState({isFocused:!1})},n.onFocus=function(e){n.setState({isFocused:!0})},n.state={thumbLoaded:t.isThumbLoaded(o)},n}return o.__extends(t,e),
t.prototype.componentDidMount=function(){var e=this;this.props.delayRenderFullTile?this.renderCompleteTileTimeout=setTimeout(function(){e.renderCompleteTileTimeout=0,e.fetchThumbnail()},100):this.fetchThumbnail(),this.logTileInteractive()},t.prototype.componentDidUpdate=function(e,t){!e.isFocused&&this.props.isFocused&&this.focusTile()},t.prototype.componentWillReceiveProps=function(e){e.thumbnailUrl!==this.props.thumbnailUrl&&(this.unbindThumbnailIfNeeded(),this.setState({thumbLoaded:t.isThumbLoaded(e)}),this.fetchThumbnail())},t.prototype.componentWillUnmount=function(){this.unbindThumbnailIfNeeded(),this.renderCompleteTileTimeout&&clearTimeout(this.renderCompleteTileTimeout),this.animationRequestIds.forEach(function(e){window.cancelAnimationFrame(e)}),this.animationRequestIds=[]},t.prototype.fetchThumbnail=function(){var e=this,t=this.props,o=t.thumbnailUrl,n=t.thumbStore;if(o){var i=Date.now();this.thumbRequestId=n.bind_url(o,{onSuccess:function(){e.setState({thumbLoaded:!0}),l.InfiniteTileGridLogger.logThumbRTT(Date.now()-i)},onError:function(){e.handleThumbnailError()}})}},t.prototype.unbindThumbnailIfNeeded=function(){var e=this.props.thumbStore;this.state.thumbLoaded&&this.thumbRequestId&&e.unbind_url(this.thumbRequestId),this.setState({thumbLoaded:!1})},t.isThumbLoaded=function(e){var t=e.thumbStore,o=e.thumbnailUrl;return!(!o||!t.get_thumb(o))},t.prototype.renderCheckbox=function(){var e=this.props.isSelected?a.CheckboxState.Checked:a.CheckboxState.Unchecked;return i.createElement("div",{key:"tile-select-checkbox",className:"tile-select-checkbox"},i.createElement(a.Checkbox,{ariaLabel:this.props.checkboxAriaText,checkboxState:e,onClick:this.toggleSelect}))},t.prototype.renderActionNode=function(){return i.createElement("div",{key:"tile-action-node",className:"tile__action-button"},this.props.actionNode)},t.prototype.renderThumbnail=function(){var e=this.props,t=e.thumbnailUrl,o=e.thumbStore,n=e.altText,r=e.width;if(this.state.thumbLoaded){var a=o.get_thumb(t);if(a)return i.createElement("img",{alt:n,className:"tile__preview tile__preview--thumb",draggable:!1,src:a,style:{maxHeight:r,maxWidth:r},onError:this.handleThumbnailError})}return this.renderFileIcon()},t.prototype.renderFileIcon=function(){var e=this.props.file;return e?i.createElement(s.FileOrFolderIcon,{className:"tile__preview tile__preview--icon",file:e,variant:"large",showPreview:!1}):i.createElement("div",{className:"tile__preview--placeholder"})},t.prototype.render=function(){var e=null;this.props.labelNode&&(e=i.createElement("div",{className:"tile-label"},this.props.labelNode));var t=this.props.width+this.props.labelHeight;if(this.props.isViewOnly)return i.createElement(c,{leftOffset:this.props.leftOffset,tileHeight:t,tileWidth:this.props.width,thumbNode:this.renderThumbnail(),labelNode:e});var r={left:this.props.leftOffset,height:t,width:this.props.width},a={height:this.props.width,width:this.props.width},l={className:n("tile",{"tile--is-selected":this.props.isSelected,"tile--focused-in":this.state.isFocused}),style:r,draggable:this.props.isDraggable,href:this.props.href,onBlur:this.onBlur,onClick:this.props.onTileAction,onDragEnter:this.props.onDragEnter,onDragStart:this.props.onDragStart,onFocus:this.onFocus},s=i.createElement("div",{ref:"tileThumbContainer",className:"tile__thumb-container",style:a,tabIndex:0,onKeyDown:this.handleThumbKeyPress},this.renderThumbnail());return i.createElement("a",o.__assign({},l),s,this.props.isSelectable&&this.renderCheckbox(),this.renderActionNode(),e)},t.defaultProps={checkboxAriaText:"",delayRenderFullTile:!0,handleToggleSelect:d,isFocused:!1,isSelected:!1,isViewOnly:!1,onDragEnter:d,onDragStart:d,onTileAction:d},t})(i.PureComponent);t.TileElement=u}),define("modules/clean/react/maestro/tile_grid",["require","exports","tslib","external/react","external/react-dom","external/classnames","modules/clean/js_client_stopwatch","external/spectrum/culled_list","modules/clean/react/maestro/tile_element","modules/clean/react/maestro/tile_grid_logger"],function(e,t,o,n,i,r,a,l,s,c){"use strict";function d(e){var t=null;return function(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];if(!t||t.length!==o.length||!t.every(function(e,t){return e===o[t]}))return t=o,e.apply(void 0,o)}}function u(e){var t=e.className,o=e.label;return t=r("tile-label__text",t),n.createElement("div",{className:t},o)}Object.defineProperty(t,"__esModule",{value:!0});t.memoizeCallback=d,t.TileItemLabelText=u;var p=(function(e){function t(t){var o=e.call(this,t)||this;if(o.ttiReported=!1,o.itemRangeByRow=[],o.scrollTileIntoView=function(e,t){var n=o.props.contentOffset||0,i=document.documentElement.scrollTop||document.body.scrollTop,r=Math.floor(t/o.props.tilesPerRow),a=e-n,l=o.getRowHeight(),s=r*l,c=s+l;i<=s&&c<=a+i||(s<i?window.scrollTo(0,s):window.scrollTo(0,c-a))},o.updateOnResize=function(){window.requestAnimationFrame(function(){o.getAndUpdateTileLayout()})},o.handleTTI=function(){o.ttiReported=!0;var e=o.props.handleTTI;e&&e()},o.setLastViewedPage=function(e){var t=document.documentElement.scrollTop||document.body.scrollTop,n=Math.round(t/e);if(o.tileLoadLogger.pruneTrackedPages(),o.tileLoadLogger.logCompletedPages(),!o.tileLoadLogger.pagesCompletedLogging.has(n)&&!o.tileLoadLogger.pagesToLog.has(n))if(n!==o.tileLoadLogger.lastViewedPage){if(o.tileLoadLogger.lastViewedPage=n,o.tileLoadLogger.pageChangeTime=o.tileLoadLogger.getTimeNow(),!o.tileLoadLogger.startTimeByPage.get(n)){var i=o.tileLoadLogger.getTimeNow(),r=o.tileLoadLogger.startTimeByPage.set(n,i);o.tileLoadLogger.startTimeByPage=r}}else{var i=o.tileLoadLogger.getTimeNow();if(i-o.tileLoadLogger.pageChangeTime>1e3){var a=o.tileLoadLogger.pagesToLog.add(n);o.tileLoadLogger.pagesToLog=a}}},o.logTileError=function(e){o.tileLoadLogger&&o.tileLoadLogger.recordTileError(e),o.props.logTileLoading&&c.InfiniteTileGridLogger.logThumbLoadError()},o.logTileLoaded=function(e,t,n){o.tileLoadLogger&&o.tileLoadLogger.recordTileLoaded(e,t,n)},o.renderTileElement=function(e,t,i){if(e<0||e>o.props.totalNumItems)return null;var r=o.props.getTileItem(e,i);if(!r)return n.createElement(s.TilePlaceholder,{leftOffset:t,tileHeight:o.state.tileWidth,tileWidth:o.state.tileWidth});var a=o.ttiReported&&o.props.delayRenderFullTile,l=r.isSelectable&&!!o.props.selectedIds&&o.props.selectedIds.has(r.id);return n.createElement(s.TileElement,{file:r.file,key:r.id,onTileAction:r.onTileAction,width:o.state.tileWidth,leftOffset:t,tileIndex:e,labelHeight:r.labelNode?o.props.labelHeight:0,delayRenderFullTile:a,actionNode:r.actionNode,thumbnailUrl:r.thumbnailUrl,labelNode:r.labelNode,altText:r.altText,onThumbnailError:o.props.logTileLoading?o.logTileError:void 0,onThumbnailLoad:o.props.logTileLoading?o.logTileLoaded:void 0,isDraggable:r.isDraggable,onDragEnter:r.onDragEnter,onDragStart:r.onDragStart,isFocused:r.isFocused,isSelectable:r.isSelectable,isSelected:l,isViewOnly:r.isViewOnly,handleToggleSelect:r.handleToggleSelect,checkboxAriaText:r.checkboxAriaText,thumbStore:o.props.thumbStore,scrollTileIntoView:o.scrollTileIntoView,href:r.href})},o.renderRow=function(e,t,i){var r=o.rowHeights?o.rowHeights[t]:o.getRowHeight();if(!e)return n.createElement(l.CulledItem,{className:o.props.rowClass,height:r,key:t,tagName:"li",topOffset:i});if(!Array.isArray(e))return n.createElement(l.CulledItem,{className:o.props.rowClass,height:r,key:t,tagName:"li",topOffset:i},e);for(var a=e,s=a[0],c=a[1],d=o.state.tileWidth+o.props.tilePadding,u=[],p=4,h=s;h<c;h++)u.push(o.renderTileElement(h,p,u.length)),p+=d;return n.createElement(l.CulledItem,{className:o.props.rowClass,height:r,key:t,tagName:"li",topOffset:i},u)},o.handleRangeInView=d(function(e,t){var n=o.props.onRangeInView;if(n){var i=o.translateRowRangeToItemRange(e,t);n(i[0],i[1])}}),o.props.sectionLabels||o.props.sectionStartIndices){if(!o.props.sectionLabels||!o.props.sectionStartIndices)throw new Error("Included only one of `sectionLabels` or `sectionStartIndices`.");if(o.props.sectionLabels.count()!==o.props.sectionStartIndices.count())throw new Error("sectionLabels and sectionStartIndices must be of same length.")}return o.state={tileWidth:o.props.maxTileWidth},a.JSStopwatch.create_stopwatch_if_not_exist("infinite_tile_grid_logging"),o}return o.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;window.addEventListener("resize",this.updateOnResize),this.animationFrameRequestId=window.requestAnimationFrame(function(){var t=e.getAndUpdateTileLayout();e.props.logTileLoading&&e.setupTileLogging(e.getRowHeight(),t.tilesPerRow)})},t.prototype.componentWillReceiveProps=function(e){this.tileLoadLogger&&this.tileLoadLogger.updateNumTiles(e.totalNumItems)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateOnResize),this.animationFrameRequestId&&window.cancelAnimationFrame(this.animationFrameRequestId),this.tileLoadLogger&&(clearInterval(this.logTrackingInterval),delete this.tileLoadLogger)},t.prototype.getRowHeight=function(){var e=this.props.tileHeight+this.props.tilePadding;return this.props.showLabels&&(e+=this.props.labelHeight+4),e},t.prototype.getPageHeight=function(){var e=document.documentElement.clientHeight||window.outerHeight,t=this.props.contentOffset||0,o=e-t,n=this.getRowHeight(),i=n*Math.ceil(o/n);return Math.max(i,n)},t.prototype.getAndUpdateTileLayout=function(){var e=this.props.maxTileWidth+this.props.tilePadding,t=i.findDOMNode(this);if(!t||0===t.clientWidth)return{tileWidth:this.state.tileWidth,tilesPerRow:this.props.tilesPerRow};var o=t.clientWidth,n=Math.max(1,Math.floor(o/e)),r=this.props.maxTileWidth;return o%e>1&&(n++,r=o/n-this.props.tilePadding),this.state.tileWidth!==r&&this.setState({tileWidth:r}),this.props.tilesPerRow!==n&&this.props.onTilesPerRowChange(n),{tileWidth:r,tilesPerRow:n}},t.prototype.setupTileLogging=function(e,t){var o=this.getPageHeight(),n=t*Math.ceil(o/e);this.tileLoadLogger=new c.InfiniteTileGridLogger(this.props.totalNumItems,n,t,this.handleTTI);var i=this.tileLoadLogger.pagesToLog.add(0);this.tileLoadLogger.pagesToLog=i;var r=this.tileLoadLogger.getTimeNow(),a=this.tileLoadLogger.startTimeByPage.set(0,r);this.tileLoadLogger.startTimeByPage=a,this.logTrackingInterval=setInterval(this.setLastViewedPage,200,o)},t.prototype.translateRowRangeToItemRange=function(e,t){var o=this.itemRangeByRow;return[o[e][0],o[t][1]]},t.prototype.render=function(){var e=this,t=this.itemRangeByRow;t.length=0;var o=[],i=this.getRowHeight(),r=this.props,a=r.containerClass,s=r.enableMaxHeightGrouping,c=r.numThresholdRows,d=r.scrollDeltaThreshold,u=r.sectionStartIndices,p=r.sectionLabels,h=r.totalNumItems;if(u&&u.count()>0)return this.rowHeights=[],u.forEach(function(r,a){var l=h;a!==u.count()-1&&(l=u.get(a+1)),e.rowHeights.push(32);var s=l-r,c=Math.ceil(s/e.props.tilesPerRow),d=p.get(a),m=n.createElement("div",{className:"tile-section-header"},d);o.push(m),t.push([r,r]);for(var f=0;f<c;f++){var _=r+f*e.props.tilesPerRow,g=Math.min(_+e.props.tilesPerRow,l),T=[_,g];o.push(T),t.push(T),e.rowHeights.push(i)}}),n.createElement(l.CulledList,{enableMaxHeightGrouping:s,items:o,listItemHeight:this.rowHeights,itemBuffer:c,className:a,renderRow:this.renderRow,scrollThreshold:d,onRangeInView:this.handleRangeInView});for(var m=Math.ceil(h/this.props.tilesPerRow),f=0;f<m;f++){var _=f*this.props.tilesPerRow,g=Math.min(_+this.props.tilesPerRow,h),T=[_,g];o.push(T),t.push(T)}return n.createElement(l.CulledList,{enableMaxHeightGrouping:s,items:o,listItemHeight:i,itemBuffer:c,className:a,renderRow:this.renderRow,scrollThreshold:d,onRangeInView:this.handleRangeInView})},t.defaultProps={enableMaxHeightGrouping:!1,numThresholdRows:10,tilePadding:16,tileHeight:160,maxTileWidth:160,labelHeight:40,logTileLoading:!1,scrollDeltaThreshold:1,showLabels:!0,getTileItem:function(e,t){return null},handleTTI:function(){}},t})(n.PureComponent);t.InfiniteTileGrid=p}),define("modules/clean/react/maestro/tile_grid_logger",["require","exports","external/immutable","modules/clean/js_client_stopwatch","modules/core/browser"],function(e,t,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t,n,i){var r=this;this.recordTileError=function(e){var t=Math.floor(e/r.numTilesPerPage);r.pagesWithThumbErrors.has(t)||(r.pagesWithThumbErrors=r.pagesWithThumbErrors.add(t))},this.recordTileLoaded=function(e,t,o){if(o){if(r.thumbsLoaded.has(e))return;r.thumbsLoaded=r.thumbsLoaded.add(e)}else{if(r.iconsLoaded.has(e))return;r.iconsLoaded=r.iconsLoaded.add(e)}var n=!1;n=r.numTiles%r.numTilesPerPage===0?e>=r.numTiles-r.numTilesPerPage:e>=r.numTiles-r.numTiles%r.numTilesPerPage;var i=r.numTilesPerPage;if(n){var a=r.numTiles%r.numTilesPerPage;0!==a&&(i=a)}var l=Math.floor(e/r.numTilesPerPage);if(o||!t){var s=r.numTilesFinalizedByPage,c=s.get(l)||0;r.numTilesFinalizedByPage=s.set(l,c+1)}if(0===l&&r.handleTTI){!(r.iconsLoaded.has(e)&&r.thumbsLoaded.has(e))&&(r.numTilesLoadedOnFirstPage++,r.numTilesLoadedOnFirstPage===i&&r.handleTTI())}o&&(r.pagesWithThumbs.has(l)||(r.pagesWithThumbs=r.pagesWithThumbs.add(l)),r.anyThumbLoadedTimeByPage.get(l)||(r.anyThumbLoadedTimeByPage=r.anyThumbLoadedTimeByPage.set(l,r.getTimeNow())),r.numTilesFinalizedByPage.get(l)===i&&(r.allThumbsLoadedTimeByPage=r.allThumbsLoadedTimeByPage.set(l,r.getTimeNow())))},this.pruneTrackedPages=function(){r.startTimeByPage.entrySeq().forEach(function(e){var t=e[0],o=e[1];!r.pagesToLog.has(t)&&!r.pagesCompletedLogging.has(t)&&r.getTimeNow()-o>2e3&&(r.startTimeByPage=r.startTimeByPage.delete(t))})},this.logCompletedPages=function(){r.pagesToLog.forEach(function(e){var t=r.startTimeByPage.get(e),o=Math.max(r.allThumbsLoadedTimeByPage.get(e),t),n=Math.max(r.anyThumbLoadedTimeByPage.get(e),t);return o&&!r.pagesWithThumbs.has(e)?void r.handlePageCompletedLogging(e):r.pagesWithThumbErrors.has(e)?void r.handlePageCompletedLogging(e):void(t&&o&&n&&(r.logPerfStats(e,t,n,o),r.handlePageCompletedLogging(e)))})},this.numTiles=e,this.numTilesPerPage=t,this.numTilesFinalizedByPage=o.List(),this.numTilesLoadedOnFirstPage=0,this.iconsLoaded=o.Set(),this.thumbsLoaded=o.Set(),this.startTimeByPage=o.Map(),this.allThumbsLoadedTimeByPage=o.Map(),this.anyThumbLoadedTimeByPage=o.Map(),this.pagesWithThumbErrors=o.Set(),this.pagesWithThumbs=o.Set(),this.pagesCompletedLogging=o.Set(),this.pagesToLog=o.Set(),this.handleTTI=i}return e.prototype.getTimeNow=function(){var e=i.performance(),t=-1;return e&&e.now&&(t=e.now()),t},e.prototype.updateNumTiles=function(e){this.numTiles>=e||(this.numTiles=e)},e.prototype.handlePageCompletedLogging=function(e){this.pagesCompletedLogging=this.pagesCompletedLogging.add(e),this.pagesToLog=this.pagesToLog.delete(e),this.startTimeByPage=this.startTimeByPage.delete(e),this.anyThumbLoadedTimeByPage=this.anyThumbLoadedTimeByPage.delete(e),this.allThumbsLoadedTimeByPage=this.allThumbsLoadedTimeByPage.delete(e)},e.logThumbLoadError=function(){n.JSStopwatch.recordTrace("visual_browse_thumb_load_error",{stopwatchName:"infinite_tile_grid_logging",traceTime:0})},e.logThumbRTT=function(e){n.JSStopwatch.recordTrace("visual_browse_thumb_rtt",{stopwatchName:"infinite_tile_grid_logging",traceTime:e})},e.prototype.logPerfStats=function(e,t,o,i){n.JSStopwatch.recordTrace("loaded_any_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:o-t}),n.JSStopwatch.recordTrace("loaded_all_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:i-t})},e})();t.InfiniteTileGridLogger=r}),define("modules/clean/react/outside_event",["require","exports","tslib","external/react","external/lodash","modules/clean/react/util"],function(e,t,o,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n.createElement;n.DOM;var l=function(e,t,l,s){var c=null!=e.displayName?e.displayName:"UnnamedComponent";return d=(function(n){function c(){var e=null!==n&&n.apply(this,arguments)||this;return e._handleOutsideEvent=function(t){return"function"==typeof e.props[s]?e.props[s](t):void 0},e._handleInsideEvent=function(t){return t.stopPropagation(),"function"==typeof t.nativeEvent.stopImmediatePropagation&&t.nativeEvent.stopImmediatePropagation(),"function"==typeof e.props[l]?e.props[l](t):void 0},e}return o.__extends(c,n),c.prototype.componentDidMount=function(){return document.addEventListener(t,this._handleOutsideEvent,!1)},c.prototype.componentWillUnmount=function(){return document.removeEventListener(t,this._handleOutsideEvent,!1)},c.prototype.render=function(){return a(e,r.mergeProps(i.omit(this.props,l,s,"children"),(t={},t[l]=this._handleInsideEvent,t)),this.props.children);var t},c})(n.Component),d.displayName="Outside"+t+"Handled"+c,d.propTypes=(u={},u[l]=n.PropTypes.func,u[s]=n.PropTypes.func,u),d;var d,u};t.addOutsideEventHandling=l;var s=l("div","click","onClick","onOutsideClick");t.OutsideClickHandler=s;var c=l("div","mousedown","onMouseDown","onOutsideMouseDown");t.OutsideMouseDownHandler=c}),define("modules/clean/react/selection",["require","exports","tslib","external/immutable"],function(e,t,o,n){"use strict";function i(e,t){return new r({selected:e?n.OrderedSet(e):n.OrderedSet(),anchor:t||(e?e[0]:null)})}Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t})(n.Record({selected:null,anchor:null},"Selection"));t.Selection=r,t.createSelection=i}),define("modules/clean/sharing/browse_exports",["require","exports","tslib","modules/core/browser","modules/clean/sharing/gating_util","modules/clean/sharing/async_share_modal_util","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/wizard/async_wizard_modals"],function(e,t,o,n,i,r,a,l){"use strict";function s(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e(["modules/clean/sharing/shared_content_link_sync_utils"],function(e){return e.mountSharedFolder.apply(e,t)})}function c(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(o){return[2,new Promise(function(o,n){e(["modules/clean/sharing/ui_util"],function(e){o(e.genContentManagerBridgeUri.apply(void 0,t))},n)})]})})}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.__awaiter(this,void 0,void 0,function(){var t;return o.__generator(this,function(o){switch(o.label){case 0:return[4,c.apply(void 0,e)];case 1:return t=o.sent(),n.open_tab(t.toString()),[2]}})})}function u(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e(["modules/clean/sharing/cdm_new_folder_modal"],function(e){e.showCdmNewFolderModal.apply(e,t)})}function p(t){return o.__awaiter(this,void 0,void 0,function(){var n;return o.__generator(this,function(o){switch(o.label){case 0:return[4,new Promise(function(t,o){e(["modules/clean/sharing/cdm_new_folder_modal_util"],t,o)})];case 1:return n=o.sent(),n.showAppropriateNewFolderModalForCdmUser(t),[2]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.asyncMountSharedFolder=s,t.asyncGoToContentManagerForPath=d,t.asyncShowCdmNewFolderModal=u,t.asyncShowAppropriateNewFolderModalForCdmUser=p,t.GoldenGate=i.GoldenGate,t.asyncShowShareModal=r.asyncShowShareModal,t.asyncShowNewFolderShareModal=r.asyncShowNewFolderShareModal,t.asyncShowPrefilledShareModal=r.asyncShowPrefilledShareModal,t.asyncShowSharedContentLinkSyncModal=r.asyncShowSharedContentLinkSyncModal,t.makePublicFolderLink=a.makePublicFolderLink,t.shouldUsePublicFolderSharing=a.shouldUsePublicFolderSharing,t.showPublicFolderLinkModal=a.showPublicFolderLinkModal,t.asyncShowShareAFolderWizardModal=l.asyncShowShareAFolderWizardModal}),define("modules/clean/sharing/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.PUBLIC=1]="PUBLIC",e[e.TEAM_ONLY=2]="TEAM_ONLY",e[e.PASSWORD=3]="PASSWORD",e[e.ONLY_YOU=99]="ONLY_YOU"})(t.SHMODEL_LINK_TOKEN_VISIBILITY||(t.SHMODEL_LINK_TOKEN_VISIBILITY={})),t.MEMBER_ACTION={LEAVE_A_COPY:"leave_a_copy",MAKE_EDITOR:"make_editor",MAKE_OWNER:"make_owner",MAKE_VIEWER:"make_viewer",MAKE_VIEWER_NO_COMMENT:"make_viewer_no_comment",REMOVE:"remove",ALL:["leave_a_copy","make_editor","make_owner","make_viewer","make_viewer_no_comment","remove"]},t.SNIPPET_SIZES={FILENAME:22,DISPLAY_NAME:26,EMAIL:30,OUT_OF_QUOTA_FOLDER_NAME:15},t.VALIDATE_PATH_PERMISSIONS={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",edit_contents:"canEditContents",enable_viewer_info:"enableViewerInfo",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unshare:"canUnshareFolder",relinquish_membership:"canRelinquishMembership"},t.VALIDATE_PATH_PERMISSIONS_CONFIDENTIAL_AWARE={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",edit_contents:"canEditContents",enable_viewer_info:"enableViewerInfo",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unshare:"canUnshareFolder",update_confidentiality:"canUpdateConfidentiality",relinquish_membership:"canRelinquishMembership"},t.ALPHA_FOLDER_METADATA_PERMISSIONS={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",edit_contents:"canEditContents",enable_viewer_info:"enableViewerInfo",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",leave_a_copy:"leaveACopy",relinquish_membership:"canRelinquishMembership",remove_download_policy:"removeDownloadPolicy",set_download_policy:"setDownloadPolicy",unmount:"canUnmountFolder",unshare:"canUnshareFolder",update_confidentiality:"canUpdateConfidentiality"},t.ALPHA_FILE_METADATA_PERMISSIONS={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",enable_viewer_info:"enableViewerInfo",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",relinquish_membership:"canRelinquishMembership",remove_download_policy:"removeDownloadPolicy",set_download_policy:"setDownloadPolicy",unshare:"unshare"},t.FILE_METADATA_PERMISSIONS={invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",relinquish_membership:"canRelinquishMembership",unshare:"unshare"},t.SHARE_ACTION_ORIGIN_TYPE={BROWSE_FILE_ACTIONS:"BROWSE_FILE_ACTIONS",BROWSE_FILE_ROW:"BROWSE_FILE_ROW",BROWSE_GLOBAL_ACTIONS:"BROWSE_GLOBAL_ACTIONS",BROWSE_SHARED_FOLDER_BANNER:"BROWSE_SHARED_FOLDER_BANNER",CONTENT_MANAGER:"CONTENT_MANAGER",DESKTOP_CLIENT:"DESKTOP_CLIENT",EVENTS_PAGE:"EVENTS_PAGE",FILE_ROW_SHARE_MENU:"FILE_ROW_SHARE_MENU",GRANT_ACCESS:"GRANT_ACCESS",LEGACY_BROWSE:"LEGACY_BROWSE",LINKS_PAGE:"LINKS_PAGE",NOTIFICATION_WEB:"NOTIFICATION_WEB",OFFICE_INTEGRATION:"OFFICE_INTEGRATION",OUT_OF_QUOTA_MODAL:"OUT_OF_QUOTA_MODAL",PARENT_FOLDER_MODAL:"PARENT_FOLDER_MODAL",PREVIEW_PAGE:"PREVIEW_PAGE",PREVIEW_PAGE_FACEPILE:"PREVIEW_PAGE_FACEPILE",RECENTS:"RECENTS",SHARE:"SHARE",SHARE_LINK_MODAL:"SHARE_LINK_MODAL",SYNC_MODAL:"SYNC_MODAL",WIZARD:"WIZARD"};(function(e){e.Content="c",e.Shmodel="s"})(t.SharedLinkType||(t.SharedLinkType={}))}),define("modules/clean/sharing/gating_util",["require","exports","modules/constants/sharing"],function(e,t,o){"use strict";function n(e){return o.TRUELINK.NO_COMMENT_ENABLED&&!!(null!=e?o.TRUELINK.NO_COMMENT_ENABLED[e.id]:void 0)}Object.defineProperty(t,"__esModule",{value:!0}),t.GoldenGate={enableSetConfidentialForRemovingSingleUser:function(e){return Boolean(o.GOLDEN_GATE.ENABLE_SET_CONFIDENTIAL_BY_REMOVING_SINGLE_USER[e])},hasNewOwnershipModel:function(e){return Boolean(o.GOLDEN_GATE.HAS_NEW_OWNERSHIP_MODEL[e])},hasContentManagerAndSuperAdmin:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_AND_SUPER_ADMIN[e])},hasContentManagerActionsDisabled:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_ACTIONS_DISABLED[e])},hasContentManagerCdm:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_CDM[e])},hasContentManagerTSDSwitch:function(e){return Boolean(o.GOLDEN_GATE.HAS_CONTENT_MANAGER_TSD_SWITCH[e])},hasContentManagerFolderRestore:function(e){return Boolean(o.GOLDEN_GATE.CAN_RESTORE_FOLDERS_IN_CM[e])},SHARING_TOTAL_LIMIT:o.GOLDEN_GATE.SHARING_TOTAL_LIMIT},t.isUserNoCommentEnabled=n}),define("modules/clean/sharing/public_folder/public_folder",["require","exports","modules/core/uri","modules/constants/public_folder_constants"],function(e,t,o,n){"use strict";function i(e,t){if(e.publicAppToken)return t;if(!e.isPublicFolderEnabled)return null;var o=(e.publicFolderFqPath||"/public").toLowerCase(),n=t.toLowerCase();return n===o?"/":n.startsWith(o+"/")?t.substring(o.length):null}function r(e,t){return null!=i(e,t)}function a(e,t,r,a){if(a)return null;var l,s=i(t,r);if(l=n.SHOULD_REDIRECT_URL?"u"+e+".dl.dropboxusercontent.com":"dl.dropboxusercontent.com",null!=s){var c=new o({scheme:"https",authority:l});return t.publicAppToken?(c.setPath("/spa/"+t.publicAppToken+s+"/data"),c.toString()):(c.setPath("/u/"+e+s),c.toString())}return null}function l(t){return new Promise(function(o,n){e(["external/react","modules/clean/react/modal","modules/clean/sharing/public_folder/modal"],function(e,n,i){var r=n.Modal,a=i.CopyPublicLinkModal;r.showInstance(e.createElement(a,{publicLink:t})),o()})})}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUsePublicFolderSharing=r,t.makePublicFolderLink=a,t.showPublicFolderLinkModal=l});
//# sourceMappingURL=pkg-browse-and-photos.min.js-vflmxCDhn.map