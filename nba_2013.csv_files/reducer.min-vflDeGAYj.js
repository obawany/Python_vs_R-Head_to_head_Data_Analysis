define(["require","exports","tslib","modules/clean/react/file_sidebar/store/file_activity/activity_sorted_set","modules/constants/file_activity_stream"],function(e,i,t,s,r){"use strict";function a(e){return e.filter(function(e){switch(e.type){case"file_settings_change":return r.IS_FILE_SETTINGS_CHANGE_CARD_ON;case"shared_link_change":return r.IS_SHARED_LINK_CHANGE_CARD_ON;case"view":return r.IS_VIEW_CARD_ON;default:return!0}})}function _(e){return a(e).map(function(e){return e.isGroup?t.__assign({},e,{groupActivities:a(e.groupActivities)}):e})}function n(e){return e.map(function(e){return e.isGroup&&1===e.groupActivities.length?e.groupActivities[0]:e})}function c(e,r){switch(void 0===e&&(e=i.INITIAL_STATE),r.type){case"FILE_ACTIVITY|RESET":return t.__assign({},i.INITIAL_STATE,{feedback:e.feedback});case"FILE_ACTIVITY|RESET_FILE_STATE":return t.__assign({},e,{activities:i.INITIAL_STATE.activities});case"FILE_ACTIVITY|LOADING_START":return t.__assign({},e,{activities:t.__assign({},e.activities,{error:void 0,loading:!0}),userId:r.userId,file:r.file});case"FILE_ACTIVITY|LOADING_END":return t.__assign({},e,{activities:t.__assign({},e.activities,{loaded:!0,loading:!1}),feedback:t.__assign({},e.feedback,{shouldShow:e.activities.value.length>0&&!e.feedback.responded&&Math.random()<.1})});case"FILE_ACTIVITY|RECEIVE_FILE_ACTIVITY":var a=_(r.activities);a=n(a);var c=r.enabled,I=c?new s.ActivitySortedSet(e.activities.value.concat(a)).toArray():[];return t.__assign({},e,{activities:t.__assign({},e.activities,{value:I}),enabled:r.enabled});case"FILE_ACTIVITY|RECEIVE_STREAM_ERROR":return t.__assign({},e,{activities:t.__assign({},e.activities,{error:r.error})});case"FILE_ACTIVITY|FEEDBACK_SENT":return t.__assign({},e,{feedback:t.__assign({},e.feedback,{responded:!0})});case"FILE_ACTIVITY|HIDE_FEEDBACK":return t.__assign({},e,{feedback:t.__assign({},e.feedback,{shouldShow:!1})})}return e}Object.defineProperty(i,"__esModule",{value:!0}),i.INITIAL_STATE={activities:{error:void 0,loaded:!1,loading:!1,value:[]},enabled:!1,userId:-1,feedback:{shouldShow:!1,responded:r.FEEDBACK_RECEIVED}},i.filterActivitiesBasedOnStormcrows=a,i.filterGroupActivitiesBasedOnStormcrows=_,i.ungroupSingleActivityGroups=n,i.reducer=c});
//# sourceMappingURL=reducer.min.js-vflNQGlzR.map