define("modules/clean/acf/components/base_component",["require","exports","tslib","external/lodash","external/react","external/classnames","modules/clean/acf/utils/react_utils"],function(e,t,r,o,s,a,n){"use strict";function i(e,t,r,o,s){void 0===t&&(t={}),void 0===r&&(r={}),void 0===o&&(o=u),void 0===s&&(s=e.name),n.classMetadata(e,o,t,r,s)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.classnames=function(e){void 0===e&&(e={});var t=e;return this.props.className&&(t=o.assignIn({},(r={},r[this.props.className]=this.props.className,r),t)),a(t);var r},t.prototype.shouldRender=function(e){if(void 0===e&&(e=this.props),!e.permissions||!e.stateKey)return!0;var t=e.permissions.hasOwnProperty(e.stateKey)&&e.permissions[e.stateKey],r=!e.permissions.hasOwnProperty(e.stateKey);return t||r},t.prototype.propsOrStateKey=function(e){return this.props[e]?this.props[e]:this.props[this.props.stateKey]},t.prototype.propsOrStateKeyMethod=function(e,t){return void 0===t&&(t=e),this.props[e]?this.props[e]:this.props[""+this.props.stateKey+t]},t.prototype.renderComponent=function(){return s.createElement("noscript",null)},t.prototype.render=function(){return this.shouldRender()?this.renderComponent():s.createElement("noscript",null)},t})(s.Component);t.default=u,t.componentClassMetadata=i});var __extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}})();define("modules/clean/acf/components/breadcrumbs",["require","exports","external/react","modules/clean/acf/components/base_component","modules/clean/acf/components/sprite"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderComponent=function(){var e=this;return r.createElement("ul",{className:this.classnames({"c-breadcrumbs":!0})},this.props.items.map(function(t,o){return o<e.props.items.length-1?r.createElement("li",{key:"breadcrumb-"+o},r.createElement("a",{href:t.url},r.createElement("h1",{className:"f1"},t.name)),r.createElement(s.Sprite,{className:"c-breadcrumbs__arrow",group:"web",name:"chevron",alt:""})):r.createElement("li",{key:"breadcrumb-"+o},r.createElement("h1",{className:"f1"},t.name))}))},t})(o.default);t.default=a,o.componentClassMetadata(a,{items:r.PropTypes.arrayOf(r.PropTypes.shape({name:r.PropTypes.string,url:r.PropTypes.string})).isRequired})}),define("modules/clean/acf/components/sprite",["require","exports","tslib","external/react","modules/clean/react/sprite","modules/clean/acf/components/base_component"],function(e,t,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(t){var r=e.call(this,t)||this;return r.state={hover:!1},r}return r.__extends(t,e),t.prototype.spriteName=function(){return this.props.hoverName&&this.state.hover?this.props.hoverName:this.props.name},t.prototype.setHover=function(e){this.setState({hover:e})},t.prototype.render=function(){var e=this;return o.createElement("div",{className:this.classnames(),onMouseOver:function(){return e.setHover(!0)},onMouseOut:function(){return e.setHover(!1)},onClick:this.props.onClick},o.createElement(s,{group:this.props.group,name:this.spriteName(),alt:this.props.alt}))},t.defaultProps={onClick:function(){}},t})(a.default);t.Sprite=n}),define("modules/clean/acf/utils/react_utils",["require","exports","external/lodash"],function(e,t,r){"use strict";function o(e,t){return void 0===t&&(t={}),r.assignIn({},e.propTypes||{},t)}function s(e,t){return void 0===t&&(t={}),r.assignIn({},e.defaultProps||{},t)}function a(e,t,r,a,n){void 0===r&&(r={}),void 0===a&&(a={}),void 0===n&&(n=e.name),e.displayName=n,e.propTypes=o(t,r),e.defaultProps=s(t,a)}function n(e,t,o,s){return void 0===o&&(o=[]),void 0===s&&(s={}),r.assignIn(s,r.omit.apply(r,[t,"className","children","style","renderImportantOnly","renderImportant","viewName","element"].concat(o)),e.props)}Object.defineProperty(t,"__esModule",{value:!0}),t.basePropTypes=o,t.baseDefaultProps=s,t.classMetadata=a,t.childProps=n}),define("modules/clean/avatar/group_avatar",["require","exports","tslib","external/react","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar","modules/clean/avatar/size","modules/clean/static_urls","modules/core/user_i18n"],function(e,t,r,o,s,a,n,i,u){"use strict";var l=o.createElement;return(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return l(s,{dimension:this.props.dimension,photoUrl:this.props.group.is_team_group?i.static_url("/static/images/icons/team_32-vflk8mBzO.png"):void 0,shape:"SQUARE",name:this.props.group.name,optionalClass:this.props.optionalClass,defaultAvatar:l(a.InitialsAvatarWithColorDerivedFromName,{dimension:this.props.dimension,initials:u.getInitials(this.props.group.name).toUpperCase(),name:this.props.group.name,shape:"SQUARE",optionalClass:this.props.optionalClass})})},t.displayName="GroupAvatar",t.propTypes={dimension:o.PropTypes.oneOf(n.VALID_AVATAR_DIMENSIONS).isRequired,group:o.PropTypes.object.isRequired,optionalClass:o.PropTypes.string},t})(o.Component)}),define("modules/clean/groups/add_group_members_modal",["require","exports","external/create-react-class","external/react","jquery","modules/clean/ajax","modules/clean/analytics","modules/clean/groups/group_members_form","modules/clean/groups/utils","modules/clean/react/modal","modules/clean/viewer","modules/core/i18n","modules/core/notify"],function(e,t,r,o,s,a,n,i,u,l,m,p,d){"use strict";var c=o.DOM,g=o.PropTypes,_=m.Viewer.get_viewer();return r({displayName:"AddGroupMembersModal",propTypes:{group:g.object,insideAdminConsole:g.bool,onGroupChanged:g.func},getInitialState:function(){return{canProceed:!1,submitting:!1}},componentDidMount:function(){return s(".contacts-tokenizer-input").select()},_canProceed:function(){return(null!=this.refs.members?this.refs.members.areAllContactsValid():void 0)&&!(null!=this.refs.members?this.refs.members.isEmpty():void 0)},onClickAddMembers:function(e){var t=this;return e.preventDefault(),this.refs.members.getFinalData(function(e){var r=e.emails,o=t._canProceed();if(t.setState({canProceed:o}),o)return t.setState({submitting:!0}),a.WebRequest({url:"/groups_ajax/add_users_to_group",data:{members:JSON.stringify(r),group_id:t.props.group.id},subject_user:_.work_user,complete:function(){if(t.isMounted())return t.setState({submitting:!1})},success:function(e){return e=JSON.parse(e),d.success(p.ungettext("Adding member...","Adding members...",r.length)),l.Modal.close(),t.props.onGroupChanged(!0,null)},error:function(e){if(u.isGroupDeleted(e))return l.Modal.close(),u.redirectToGroupsPage(t.props.insideAdminConsole)}})})},onMembersFormChange:function(){return this.setState({canProceed:this._canProceed()})},logWebTeamsEvent:function(){var e=this.props.group.users.filter(function(e){return e.is_owner}).map(function(e){return e.user_id}),t={group_owner_ids:e,team_id:this.props.group.team_id,team_type:_.team_type,group_id:this.props.group.id};return n.TeamsWebActionsLogger.log("groups_add_members_cancelled",t)},render:function(){return o.createElement(l.Modal,{title:p._("Add members to “%(group_name)s”").format({group_name:this.props.group.name}),className:"no-scroll-modal",acceptButtonText:p._("Add members"),dismissButtonText:p._("Cancel"),onAccept:this.onClickAddMembers,onDismiss:this.logWebTeamsEvent,acceptButtonDisabled:!this.state.canProceed,submitting:this.state.submitting,ref:"modal"},o.createElement(i,{ref:"members",group:this.props.group,onChange:this.onMembersFormChange,errorMessageSpaceFixed:!1,includeCustomMessage:!1,emailPlaceholder:p._("Add names or emails"),disallowGroupMembers:!0}),c.label({},c.br({}),p._("Giving new members access to all of this group’s shared folders might take a little while.")))}})}),define("modules/clean/groups/create_group_modal",["require","exports","tslib","external/react","modules/clean/ajax","modules/clean/groups/group_members_form","modules/clean/groups/utils","modules/clean/react/input","modules/clean/react/modal","modules/clean/react/tooltip","modules/clean/viewer","modules/constants/teams","modules/core/browser","modules/core/i18n"],function(e,t,r,o,s,a,n,i,u,l,m,p,d,c){"use strict";var g=o.createElement,_=o.DOM,h=o.PropTypes,f=m.Viewer.get_viewer();return(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={createGroupFolderChecked:!1,groupName:"",groupDescription:"",submitting:!1,errors:null,isAdminManaged:!0,joinableChecked:!1},t.groupNameIsValid=function(){return t.state.groupName.length<=n.MAX_GROUP_NAME_LEN},t.groupDescriptionIsValid=function(){return t.state.groupDescription.length<=n.MAX_GROUP_DESCRIPTION_LEN},t.getLocalNameError=function(){if(!t.groupNameIsValid())return{message_text:c._("The group name should be under %(max_len)d characters").format({max_len:n.MAX_GROUP_NAME_LEN})}},t.getLocalDescriptionError=function(){if(!t.groupDescriptionIsValid())return{message_text:c._("The group description should be under %(max_len)d characters").format({max_len:n.MAX_GROUP_DESCRIPTION_LEN})}},t.getViewerMember=function(){return{name:f.display_name,email:f.work_email,is_owner:t.props.isLimitedTeam||!t.props.canHaveAdminUi||!t.state.isAdminManaged}},t.canProceed=function(){var e=!t.state.submitting&&""!==t.state.groupName.trim()&&t.groupNameIsValid();return t.props.enhancedGroupsEnabled&&(e=e&&(null!=t.refs.members?t.refs.members.areAllContactsValid():void 0)),e},t.onWillDismiss=function(e){if(!t.props.insideAdminConsole)return d.set_hash("groups")},t.onClickCreate=function(e){if(null!=e&&e.preventDefault(),t.canProceed()){t.setState({submitting:!0});var r=t.state.joinableChecked?p.GROUP_JOIN_POLICY_OPEN:p.GROUP_JOIN_POLICY_REQUEST_TO_JOIN,o=function(e){return s.WebRequest({url:"/groups_ajax/make_new_group_with_users",data:{name:t.state.groupName,description:t.state.groupDescription,members:JSON.stringify(e),create_folder:t.state.createGroupFolderChecked,is_admin_managed:t.isAdminManagedSelected(),group_join_policy:r},subject_user:f.work_user,error:function(e,r,o){return t.setState({submitting:!1,errors:(function(){try{return JSON.parse(o)}catch(e){}})()})},success:function(e){var r;return e=JSON.parse(e),r=t.props.insideAdminConsole?"/"+e.data.id:"groups/"+e.data.id,d.set_hash(r),"function"==typeof t.props.onCreateCallback&&t.props.onCreateCallback(),u.Modal.close()}})},a=[t.getViewerMember()];return t.props.enhancedGroupsEnabled?t.refs.members.getFinalData(function(e){return o(a.concat(e.emails))}):o(a)}},t.onChangeGroupType=function(e){return t.setState({isAdminManaged:"true"===e.target.value})},t.onMembersFormChange=function(){return t.setState({canProceed:t.canProceed()})},t.renderGroupTypeSelect=function(){return _.div({className:"group-type"},_.label({className:"tooltip-label group-kind-label"},c._("What kind of group is it?"),o.createElement(l.Tooltip,{position:l.TooltipPosition.RIGHT,tooltip_contents:c._("In company-managed groups, admins are responsible for adding and removing members. In user-managed groups, users approve new members, and existing members can leave whenever they like."),tooltip_classname:"group-kind-tooltip-bubble"},_.img({src:"/static/images/sprites/teams/tool_tip_icon-vflUvSKa8.png",alt:c._("More information")}))),_.div({className:"group-type-selection"},_.label({htmlFor:"admin-managed-radio",className:"label-text"},_.input({type:"radio",name:"group-type-radio",id:"admin-managed-radio",defaultChecked:t.state.isAdminManaged,onChange:t.onChangeGroupType,value:!0}),c._("Company-managed group")),_.br({}),_.label({htmlFor:"member-managed-radio",className:"label-text"},_.input({type:"radio",name:"group-type-radio",id:"member-managed-radio",defaultChecked:!t.state.isAdminManaged,onChange:t.onChangeGroupType,value:!1}),c._("User-managed group"))))},t.canBeAdminManaged=function(){return!t.props.isLimitedTeam&&t.props.canHaveAdminUi},t.isAdminManagedSelected=function(){return t.canBeAdminManaged()&&t.state.isAdminManaged},t._renderEnhancedGroupsCreateModalContent=function(){return _.form({onSubmit:t.onClickCreate},_.label({className:"label-description"},c._("Group info")),o.createElement(i.text,{className:"group-name-input",placeholder:c._("Name this group"),onChange:function(e){return t.setState({groupName:e.target.value})},autofocus:!0,"error-after":!1,error:t.getLocalNameError()}),o.createElement(i.textarea,{className:"group-description-input",placeholder:c._("Add an optional description"),onChange:function(e){return t.setState({groupDescription:e.target.value})},autofocus:!1,"error-after":!0,error:t.getLocalDescriptionError()}),_.div({className:"group-members"},_.label({className:"label-description"},c._("Members (optional)")),g(a,{ref:"members",onChange:t.onMembersFormChange,errorMessageSpaceFixed:!1,includeCustomMessage:!1,emailPlaceholder:c._("Enter names or emails"),disallowGroupMembers:!1,disallowCurrentUser:!0})),_.div({className:"group-folder-container"},_.div({className:"create-group-folder"},_.input({type:"checkbox",onChange:function(e){return t.setState({createGroupFolderChecked:e.target.checked})}}),_.label({},c._("Create a shared folder for this group"))),t.props.groupJoinPolicyEnabled?_.div({className:"join-policy"},_.input({type:"checkbox",onChange:function(e){return t.setState({joinableChecked:e.target.checked})},disabled:t.isAdminManagedSelected()}),_.label({},c._("Allow anyone at %(team_name)s to join").format({team_name:t.props.teamName})),t.isAdminManagedSelected()?_.label({className:"disable-join-policy-message"},c._(" Only permitted for user-managed groups.")):void 0):void 0),t.canBeAdminManaged()?t.renderGroupTypeSelect():void 0)},t._renderCreateModalContent=function(){return _.form({onSubmit:t.onClickCreate},_.label({className:"label-description"},c._("Group name")),o.createElement(i.text,{className:"group-name-input",placeholder:c._("Marketing, Design, etc.",{comment:"These are example group names."}),onChange:function(e){return t.setState({groupName:e.target.value})},autofocus:!0,error:t.getLocalNameError()}),t.canBeAdminManaged()?t.renderGroupTypeSelect():void 0)},t}return r.__extends(t,e),t.prototype.render=function(){return g(u.Modal,{title:c._("Create a new group"),className:this.props.enhancedGroupsEnabled?"create-group-modal-enhanced":"create-group-modal",acceptButtonText:c._("Create"),acceptButtonDisabled:!this.canProceed(),dismissButtonText:c._("Cancel"),onAccept:this.onClickCreate,onDismissCompleted:this.onWillDismiss,submitting:this.state.submitting},this.props.enhancedGroupsEnabled?this._renderEnhancedGroupsCreateModalContent():this._renderCreateModalContent())},t.displayName="CreateGroupModal",t.propTypes={teamName:h.string,isLimitedTeam:h.bool,canHaveAdminUi:h.bool,insideAdminConsole:h.bool,enhancedGroupsEnabled:h.bool,groupJoinPolicyEnabled:h.bool,onCreateCallback:h.func},t})(o.Component)}),define("modules/clean/groups/group_member_list",["require","exports","external/classnames","external/create-react-class","external/react","modules/clean/ajax","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar","modules/clean/groups/simple_modals","modules/clean/teams/modals/leave_group_modal","modules/clean/groups/utils","modules/clean/react/bubble_menu","modules/clean/react/button","modules/core/browser","modules/clean/react/dbox_app_promo","modules/clean/react/sprite","modules/clean/react/table","modules/clean/viewer","modules/core/i18n","modules/core/notify","modules/core/user_i18n"],function(e,t,r,o,s,a,n,i,u,l,m,p,d,c,g,_,h,f,b,v,M){"use strict";function y(e,t){return e=+e,t=+t,(e%t+t)%t}Object.defineProperty(t,"__esModule",{value:!0});var w=s.DOM,C=s.PropTypes,T=f.Viewer.get_viewer(),N=function(e,t){var r={};for(var o in e){var s=e[o];r[o]=s.bind(t)}return r},S=o({displayName:"MemberList",propTypes:{group:C.object,canHaveAdminUi:C.bool,onGroupChanged:C.func,isMaestroDesign:C.bool,insideAdminConsole:C.bool,search_query:C.string},viewerIsOwner:function(){return this.props.group.is_owner},canManageGroup:function(){return!this.props.group.is_team_group&&(this.props.canHaveAdminUi||this.viewerIsOwner())},onRemoveUserSuccess:function(e){return 0!==y(this.props.group.user_count+this.props.group.pending_req_count-1,m.MAX_ROWS_PER_PAGE)||this.props.isMaestroDesign?this.refs.members.forceRefresh():this.props.onGroupChanged(!0,this.props.group)},onClickRemoveUser:function(e){return e.user_id===T.work_user.id?l.showLeaveGroupModal({groupId:this.props.group.id,groupName:this.props.group.name,userId:f.Viewer.get_viewer().work_user.id,onPrimaryAction:function(){c.set_hash("groups")}}):u.showRemoveUserModal(this.props.group,this.props.insideAdminConsole,e,this.onRemoveUserSuccess.bind(this))},onClickApproveJoinReq:function(e){var t=this;return a.WebRequest({url:"/groups_ajax/approve",data:{group_id:this.props.group.id,requesting_user_id:e.user_id},subject_user:T.work_user,success:function(e){return v.success(b._("Request approved.")),t.refs.members.forceRefresh()},error:function(e){if(m.isGroupDeleted(e))return m.redirectToGroupsPage(t.props.insideAdminConsole)}})},onClickRemoveJoinReq:function(e){var t=this;return a.WebRequest({url:"/groups_ajax/remove",data:{group_id:this.props.group.id,requesting_user_id:e.user_id},subject_user:T.work_user,success:function(e){return v.success(b._("Request removed.")),t.refs.members.forceRefresh()},error:function(e){if(m.isGroupDeleted(e))return m.redirectToGroupsPage(t.props.insideAdminConsole)}})},renderSettingsForPendingMember:function(e){if(this.props.isMaestroDesign){var t=String.fromCharCode("176"),r=w.button({className:"settings-button"},t+t+t);return w.div({className:"approve-options-container u-mar-top-xxs"},s.createElement(d.button,{importance:"secondary",className:"approve-join-req-button",onClick:this.onClickApproveJoinReq.bind(this,e)},b._("Approve")),s.createElement(p.BubbleMenu,{targetButton:r,position:p.BubbleMenu.POSITIONS.BOTTOM_LEFT,shouldShowArrow:!1,verticalDisplacement:-3,items:[s.createElement(p.BubbleMenuItem,{onClick:this.onClickRemoveJoinReq.bind(this,e)},b._("Remove request"))]}))}var o=w.button({className:"remove-request-button",onClick:this.onClickRemoveJoinReq.bind(this,e)},w.img({src:"/static/images/x-vflYKfRuL.png",alt:b._("Remove join request")}));return w.span({className:"pending-request-buttons"},s.createElement(g.Actionable,{handler:this.onClickApproveJoinReq.bind(this,e)},w.button({className:"button-secondary button-small action-button approve-join-req-button"},b._("Approve"))),o)},renderSettingsForMember:function(e){if(this.props.group.is_admin_managed)return w.button({className:"remove-user-button",onClick:this.onClickRemoveUser.bind(this,e)},w.img({src:"/static/images/x-vflYKfRuL.png",alt:b._("Remove user")}));var t=void 0;if(this.props.isMaestroDesign){var r=String.fromCharCode("176");t=w.button({className:"settings-button"},r+r+r)}else t=w.button({className:"settings-button"},s.createElement(_,{group:"web",name:"gear",alt:b._("Member settings")}));var o=[s.createElement(p.BubbleMenuItem,{onClick:this.onClickRemoveUser.bind(this,e)},b._("Remove user"))];return e.is_owner?o.push(s.createElement(p.BubbleMenuItem,{onClick:u.showRemoveOwnerPermissionsModal.bind(this,this.props.group,this.props.insideAdminConsole,e,this.props.onGroupChanged)},b._("Remove manager permissions"))):e.can_be_owner&&o.push(s.createElement(p.BubbleMenuItem,{onClick:u.showMakeOwnerModal.bind(this,this.props.group,this.props.insideAdminConsole,e,this.props.onGroupChanged)},b._("Make manager"))),s.createElement(p.BubbleMenu,{targetButton:t,position:p.BubbleMenu.POSITIONS.BOTTOM_LEFT,shouldShowArrow:!1,verticalDisplacement:-5,items:o})},columnTypes:{displayName:function(e){var t=this;return{field:"display_name",header:b._("Name"),classes:{"display-name-column":!0},width:e,sortable:!this.props.search_query,render:function(e){var o=r({"u-mar-right-s":!0,"u-mar-left-xs":!t.props.isMaestroDesign,"u-mar-left-s":t.props.isMaestroDesign});return[s.createElement(n,{dimension:t.props.isMaestroDesign?32:24,photoUrl:e.photo_url,optionalClass:o,defaultAvatar:s.createElement(i.InitialsAvatarWithColorDerivedFromName,{dimension:t.props.isMaestroDesign?32:24,initials:M.getInitials(e.name||e.email),name:e.name,shape:"CIRCLE",optionalClass:o})}),w.span({className:t.props.isMaestroDesign?"user-info":"user-name"},w.span({className:r("user-name-part",{pending:e.is_pending,"user-info__text":t.props.isMaestroDesign})},e.name?e.name:"-"),t.props.isMaestroDesign?w.div({className:"user-info__subtext"},e.email):w.span({className:"user-status"},(function(){return e.is_owner?" · "+b._("Manager"):e.is_pending?" · "+b._("Pending"):void 0})()))]}}},userEmail:function(e){return{field:"email",header:b._("Email"),classes:{"email-column":!0},width:e,sortable:!this.props.search_query,render:function(e){return w.span({className:"user-email"},w.span({className:r({pending:e.is_pending})},e.email))}}},userStatus:function(e){return{field:"member_type",header:b._("Status"),classes:{"user-status-column":!0},width:e,initialSortDir:h.DESC_DIR,sortable:!this.props.search_query,render:function(e){return e.is_owner?b._("Manager"):e.is_pending?b._("Pending"):b._("Member")}}},joinedDate:function(e){var t=this;return{field:"localized_joined_ts",header:b._("Joined"),width:e,sortable:!this.props.search_query,render:function(e){return t.props.isMaestroDesign&&e.is_pending?w.span({className:"pending-request-buttons"},s.createElement(g.Actionable,{handler:t.onClickApproveJoinReq.bind(t,e)},w.button({className:"button-secondary button-small action-button approve-join-req-button"},b._("Approve")))):e.localized_joined_ts}}},settings:function(e){var t=this;return{width:e,classes:{"settings-column":!0},sortable:!1,render:function(e){return t.canManageGroup()?e.is_pending?t.renderSettingsForPendingMember(e):t.renderSettingsForMember(e):""}}}},componentWillMount:function(){return this.columnTypes=N(this.columnTypes,this)},tableRowClasses:function(e){return this.props.isMaestroDesign&&e.is_pending?{"pending-member-row":!0}:{}},getGroupMembers:function(e,t){var r=this;return a.WebRequest({url:"/groups_ajax/get_group_info",data:{group_id:this.props.group.id,offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,search_query:this.props.search_query},subject_user:T.work_user,success:function(e){return e=JSON.parse(e),t(null,{rows:e.data.pending_req_users.concat(e.data.users),total:e.data.user_count+e.data.pending_req_count}),r.props.onGroupChanged(!1,e.data)},error:function(e){return m.redirectToGroupsPage(r.props.insideAdminConsole)}})},renderMemberTable:function(){var e,t=this.props.group.pending_req_users.concat(this.props.group.users);return e=this.props.isMaestroDesign?this.canManageGroup?[this.columnTypes.displayName("50%"),this.columnTypes.userStatus("25%"),this.columnTypes.settings("25%")]:[this.columnTypes.displayName("50%"),this.columnTypes.userStatus("50%")]:this.canManageGroup?[this.columnTypes.displayName(300),this.columnTypes.userEmail(250),this.columnTypes.joinedDate(147),this.columnTypes.settings(103)]:[this.columnTypes.displayName(300),this.columnTypes.userEmail(250),this.columnTypes.joinedDate(250)],s.createElement(h,{ref:"members",columns:e,initialData:{rows:t,total:this.props.group.user_count+this.props.group.pending_req_count},initialSortColumn:0,emptyMessage:this.props.search_query?b._("No members found"):b._("This group has no members."),rowsPerPage:m.MAX_ROWS_PER_PAGE,paginatorClasses:this.props.isMaestroDesign?"u-mar-top-xs":"",infiniteScroll:this.props.isMaestroDesign,classes:{"grey-style":!0},rowClasses:this.tableRowClasses,rowsPerRequestForInfiniteScroll:m.MAX_ROWS_TO_FETCH_FROM_SERVER,onRequestData:this.getGroupMembers})},render:function(){return w.div({className:"member-list-container"},w.div({className:"group-user-info"},this.props.isMaestroDesign&&!this.props.insideAdminConsole||this.props.search_query?void 0:w.div({className:"member-count"},b.ungettext("%(n)d member","%(n)d members",this.props.group.user_count).format({n:this.props.group.user_count}))),this.renderMemberTable(),this.props.search_query&&this.props.group.has_more?w.div({className:"more-search-results"},b._("We found more members than we can display. Don’t see who you’re looking for? Try narrowing your search.")):void 0)}});t.MemberList=S}),define("modules/clean/groups/group_members_form",["require","exports","external/classnames","external/create-react-class","external/react","external/lodash","modules/clean/ajax","modules/clean/analytics","modules/clean/contacts/contact","modules/clean/contacts/contact_token_state","modules/clean/contacts/tokenizer","modules/clean/contacts/types","modules/clean/react/input","modules/clean/viewer","modules/core/i18n","modules/core/notify","modules/core/exception"],function(e,t,r,o,s,a,n,i,u,l,m,p,d,c,g,_){"use strict";var h=c.Viewer.get_viewer(),f=s.DOM,b=s.PropTypes;return o({displayName:"GroupMembersForm",propTypes:{group:b.object,populatedContacts:b.arrayOf(b.instanceOf(u.Contact)),customClass:b.string,onChange:b.func,emailPlaceholder:b.string,messagePlaceholder:b.string,errorMessageSpaceFixed:b.bool,emailCheckerStore:b.object,includeCustomMessage:b.bool,disallowGroupMembers:b.bool,disallowCurrentUser:b.bool},getDefaultProps:function(){return{customClass:"",populatedContacts:[],emailPlaceholder:g._("Name or email"),messagePlaceholder:g._("Add a message (optional)"),includeCustomMessage:!0,disallowGroupMembers:!1,disallowCurrentUser:!1}},getInitialState:function(){return{errorMessage:null,groupUsersEmails:Array.from(this.props.group.users).map(function(e){return e.email})}},fetchEmailsOfUsersInGroup:function(){var e=this;return n.WebRequest({url:"/groups_ajax/get_emails_of_users_in_group",data:{group_id:this.props.group.id},subject_user:h.work_user,success:function(t){if(e.isMounted()&&(t=JSON.parse(t),t.data.emails.length>0))return e.setState({groupUsersEmails:t.data.emails})},error:function(){return _.error(g._("There was a problem please reopen the add-member window"))}})},componentWillMount:function(){if(this.fetchEmailsOfUsersInGroup(),this.props.populatedContacts.length>0)return this._updateErrorMessage()},getContacts:function(){return this.refs.tokenizer.getContacts()},getFinalData:function(e){var t;this.refs.tokenizer.tokenizeAll();var r=this.getContacts();this.props.includeCustomMessage&&(t=this.refs.message.getValue());var o=a.filter(r,function(e){return e.type===p.EMAIL}),s=a.map(o,function(e){return{email:e.email,is_owner:!1}});return this._updateErrorMessage(),e({emails:s,custom_message:t})},areAllContactsValid:function(){var e=this,t=this.refs.tokenizer.serializeInputData().tokens;return 0===t.length||a.every(t,function(t){return e._validateContact(t).state===l.ContactTokenState.ok})},isEmpty:function(){var e=this.refs.tokenizer.serializeInputData(),t=e.tokens,r=e.value;return 0===t.length&&0===r.length},_validateContact:function(e){var t={state:l.ContactTokenState.ok};return e.invalid?t={state:l.ContactTokenState.invalid,msg:g._("One or more names or email addresses you entered are invalid.")}:this.props.disallowGroupMembers&&Array.from(this.state.groupUsersEmails).includes(e.email)?t={state:l.ContactTokenState.invalid,msg:g._("Member already exists in the group.")}:e.on_team||(t={state:l.ContactTokenState.invalid,msg:g._("This person isn’t on your team")}),t},_updateErrorMessage:function(){for(var e=0,t=Array.from(this.refs.tokenizer.serializeInputData().tokens);e<t.length;e++){var r=t[e],o=this._validateContact(r),s=o.state,a=o.msg;if(s!==l.ContactTokenState.ok)return i.TeamsWebActionsLogger.log("groups_add_members_error",{error_reason:a}),void this.setState({errorMessage:a})}return this.setState({errorMessage:null})},onContentsChange:function(){return this._updateErrorMessage(),"function"==typeof this.props.onChange?this.props.onChange():void 0},render:function(){var e=this,t={"add-group-members-form":!0,"error-message-fixed":this.props.errorMessageSpaceFixed,"has-custom-message":this.props.includeCustomMessage};this.props.customClass&&(t[this.props.customClass]=!0);var o=function(t){var r=t.type===p.EMAIL&&t.team&&(t.dbx_team_id===h.team_dbtid||t.dbx_team_id===h.work_user.team_dbtid);return e.props.disallowGroupMembers&&(r=r&&!Array.from(e.state.groupUsersEmails).includes(t.email)),e.props.disallowCurrentUser&&(r=r&&t.email!==h.work_user.email),Boolean(r)};return f.div({className:r(t)},f.div({className:"error-message"},this.state.errorMessage),s.createElement(m.ContactsTokenizer,{ref:"tokenizer",user:h.work_user,placeholder:this.props.emailPlaceholder,onContentsChange:this.onContentsChange,autofocus:!0,populatedInputData:{tokens:this.props.populatedContacts,value:""},customContactValidator:this._validateContact,customContactFilter:o}),this.props.includeCustomMessage?s.createElement(d.textarea,{ref:"message",className:"custom-message","disable-errors":!0,"aria-label":"member emails",placeholder:this.props.messagePlaceholder}):void 0)}})}),define("modules/clean/groups/group_shared_content_list",["require","exports","external/create-react-class","external/react","modules/clean/ajax","modules/clean/react/table","modules/clean/viewer","modules/core/browser","modules/core/i18n","modules/clean/react/browse/models"],function(e,t,r,o,s,a,n,i,u){"use strict";var l=o.createElement,m=o.DOM,p=o.PropTypes,d=n.Viewer.get_viewer();return r({displayName:"GroupSharedContentList",propTypes:{groupId:p.string},getGroupSharedContentData:function(e,t){return s.WebRequest({url:"/groups_ajax/get_shared_content_data_for_group_paginated",data:{group_id:this.props.groupId,offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir},subject_user:d.work_user,success:function(e){return e=JSON.parse(e),t(null,{rows:e.data.content,total:e.data.total})}})},columnTypes:{name:function(e){return{field:"name",header:u._("Name"),classes:{"display-name-column":!0},width:e,render:function(e){return m.span({className:"groups-shared-content-name"},e.filename)}}},lastChanged:function(e){return{field:"last_changed",header:u._("Last changed"),classes:{"last-changed-column":!0},width:e,render:function(e){return m.span({},e.last_changed)}}},size:function(e){return{field:"used",header:u._("Size"),classes:{"size-column":!0},width:e,render:function(e){return m.span({},e.used)}}}},render:function(){return m.div({className:"shared-content-list-container"},m.div({className:"content-header"},u._("Files")),l(a,{ref:"sharedContent",columns:[this.columnTypes.name(400),this.columnTypes.lastChanged(200),this.columnTypes.size(200)],emptyMessage:u._("This group has no shared content yet."),onRequestData:this.getGroupSharedContentData,classes:{"grey-style":!0,"clickable-rows":!0},rowClasses:{"shared-content-row":!0},onRowClicked:function(e){return i.redirect(e.href)}}))}})}),
define("modules/clean/groups/groups_page",["require","exports","tslib","external/classnames","external/create-react-class","external/react","external/spectrum/dropdown_menu","external/spectrum/input","external/spectrum/vertically_fixed","jquery","modules/clean/acf/components/breadcrumbs","modules/clean/ajax","modules/clean/avatar/group_avatar","modules/clean/components/loading_indicator","modules/clean/css","modules/clean/deferred_loader","modules/clean/groups/utils","modules/clean/pagelet_logger","modules/clean/react/sprite","modules/clean/react/table","modules/clean/react/tooltip","modules/clean/react_format","modules/clean/static_urls","modules/clean/teams/admin/maestro/admin_console_maestro_view_no_upload_button","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/teams","modules/core/browser","modules/core/i18n","modules/core/notify"],function(e,t,r,o,s,a,n,i,u,l,m,p,d,c,g,_,h,f,b,v,M,y,w,C,T,N,S,G,A,E){"use strict";var P,R=a.createElement,I=a.DOM,D=a.PropTypes,x=T.Viewer.get_viewer(),k=function(e,t){var r={};for(var o in e){var s=e[o];r[o]=s.bind(t)}return r},L=s({displayName:"GroupsList",propTypes:{title:D.string,emptyMessage:D.element,maxRows:D.number,onRequestData:D.func,infiniteScroll:D.bool,rowsPerRequestForInfiniteScroll:D.number,showJoinReqButtons:D.bool,showPendingCountForOwners:D.bool,canViewGroupDetails:D.bool,teamName:D.string,insideAdminConsole:D.bool,onTotalGroupsChange:D.func,searchQuery:D.string,canHaveAdminUi:D.bool,enhancedGroupsEnabled:D.bool,groupJoinPolicyEnabled:D.bool,nameColumn:D.string,initialData:D.object},columnTypes:{displayName:function(e){return{field:"name",header:this.props.nameColumn||A._("Name"),classes:{"group-name-column":!0},width:e,render:function(e){return I.span({className:"group-name-column__content"},R(d,{group:e,dimension:32,optionalClass:o("u-mar-right-s","u-mar-left-s")}),I.span({className:"group-name-column__name"},e.name))}}},members:function(e){var t=this;return{field:"user_count",header:A._("Members"),width:e,initialSortDir:v.DESC_DIR,render:function(e){return t.props.showPendingCountForOwners&&0!==e.join_req_pending_count&&Array.from(e.owner_user_ids).includes(x.work_user.id)?e.user_count+" • "+e.join_req_pending_count+" "+A._("pending"):e.user_count}}},owners:function(e){var t=this;return{field:"owners",header:A._("Managers"),classes:{"managed-by-column":!0},width:e,render:function(e){return e.is_team_group?I.label({className:"tooltip-label no-manager-label"},A._("No manager"),a.createElement(M.Tooltip,{position:M.TooltipPosition.RIGHT,tooltip_contents:A._("This group was created automatically."),tooltip_classname:"no-manager-tooltip-bubble"},I.button({className:"sprite-button"},R(b,{group:"web",name:"info",alt:A._("This group was created automatically.")})))):I.span({className:"managed-by-column__content"},(function(){if(e.is_admin_managed)return t.props.teamName;switch(e.owner_user_names.length){case 0:return"-";case 1:return e.owner_user_names[0];case 2:return A._("%(display_name)s and 1 other").format({display_name:e.owner_user_names[0]});default:return A._("%(display_name)s and %(number)s others").format({display_name:e.owner_user_names[0],number:e.owner_user_names.length-1})}})())}}},joinRequests:function(e){var t=this;return{width:e,classes:{"join-request-column":!0},sortable:!1,render:function(e){if(e.owner_user_ids.length>0&&!e.is_group_member){var r=e.waiting_for_join_req_approval,s=t.props.enhancedGroupsEnabled&&e.group_join_policy===S.GROUP_JOIN_POLICY_OPEN&&t.props.groupJoinPolicyEnabled;if(r){var a=void 0;return a=s?A._("Joined"):A._("Pending"),I.div({className:"join-req-pending"},a)}var n=void 0;return n=s?A._("Join"):A._("Ask to join"),I.button({className:o("button-secondary","button-small action-button join-req-button"),onClick:t.onClickJoinReq.bind(t,e),disabled:r},n)}return""}}}},onClickJoinReq:function(e,t){return t.stopPropagation(),e.waiting_for_join_req_approval=!0,this.forceUpdate(),p.WebRequest({url:"/groups_ajax/make_group_join_request",data:{group_id:e.id},subject_user:x.work_user,success:function(t){return e.group_join_policy===S.GROUP_JOIN_POLICY_OPEN?(G.set_hash("groups/"+e.id),E.success(A._("Group joined."))):E.success(A._("Request sent."))}})},onRowClicked:function(e){if(this.props.canViewGroupDetails)return this.props.insideAdminConsole?window.location.hash="/"+e.id:e.is_group_member||this.props.canHaveAdminUi?window.location.hash="groups/"+e.id:E.warning(A._("Groups can only be viewed by group members"))},componentWillMount:function(){return this.columnTypes=k(this.columnTypes,this)},componentDidMount:function(){if(this.props.insideAdminConsole)return N.mark_time_to_view(),N.mark_time_to_interactive()},render:function(){var e;return e=this.props.showJoinReqButtons?[this.columnTypes.displayName("35%"),this.columnTypes.members("20%"),this.columnTypes.owners("25%"),this.columnTypes.joinRequests("20%")]:[this.columnTypes.displayName("35%"),this.columnTypes.members("20%"),this.columnTypes.owners("45%")],I.div({className:"groups-list"},this.props.title?I.h1({className:"table-name"},this.props.title):void 0,a.createElement(v,{columns:e,initialData:this.props.initialData,initialSortColumn:1,initialSortDir:v.DESC_DIR,emptyMessage:this.props.emptyMessage,rowsPerPage:this.props.maxRows,infiniteScroll:this.props.infiniteScroll,rowsPerRequestForInfiniteScroll:this.props.rowsPerRequestForInfiniteScroll,classes:{"grey-style":!0,"clickable-rows":this.props.canViewGroupDetails},rowClasses:{"group-row":!0},onRequestData:this.props.onRequestData,onRowClicked:this.onRowClicked,hideHeaderOnEmptyTable:this.props.insideAdminConsole&&!this.props.searchQuery,onTotalUpdated:this.props.onTotalGroupsChange,loadingIndicator:w.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),ref:"GroupsTable"}))},componentDidUpdate:function(e,t){if(e.onRequestData!==this.props.onRequestData||e.searchQuery!==this.props.searchQuery)return this.refs.GroupsTable.forceRefresh()}}),O=function(e,t,r){return I.div({className:"team-admin-maestro-search__shadow group-search"},R(u.VerticallyFixed,{className:"team-admin-maestro-search-fixed"},I.div({className:"maestro-search-outer-label"},A._("Search groups")),I.span({className:"team-admin-maestro-search"},I.span,R(i.Input,{ref:"memberSearchInput",name:"search-input",onChange:function(t){var r=t.target.value;window.clearTimeout(P),r.trim().length>0||0===r.length?P=window.setTimeout(function(){return e(r)},500):t.target.value=""},onCloseClick:r,placeholder:A._("Group name"),className:"input-search","disable-errors":!0}))))},U=function(e,t,r){return p.WebRequest({url:e,data:t,subject_user:x.work_user,success:function(e){return e=JSON.parse(e),r(null,{rows:e.groups,total:e.total_groups})}})},q=s({displayName:"GroupsListPage",pageletLogger:new f.PageletLogger("team",["GroupsListPage"]),propTypes:{canHaveAdminUi:D.bool,groupControlledByAdmin:D.bool,teamName:D.string,isLimitedTeam:D.bool,enhancedGroupsEnabled:D.bool,groupJoinPolicyEnabled:D.bool,mergedMembersAndGroups:D.bool,infiniteScroll:D.bool,initialMyGroupsDataDict:D.object,initialTeamGroupsDataDict:D.object},getInitialState:function(){return{searchQuery:null,tablesVisible:!0}},componentDidMount:function(){return this.checkAndMarkTTI()},componentDidUpdate:function(){return this.checkAndMarkTTI()},checkAndMarkTTI:function(){if(!this.props.mergedMembersAndGroups)return this.pageletLogger.componentReady(this.constructor.displayName)},getGroupsDataAndMarkTTI:function(e,t,r){var o=this;return U(e,t,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.checkAndMarkTTI(),r.apply(void 0,Array.from(e||[]))})},getMyGroupsData:function(e,t){var r={offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir};return this.getGroupsDataAndMarkTTI("/groups_ajax/get_groups_for_user_paginated",r,t)},getOtherGroupsData:function(e,t){var r={offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,exclude_actors_groups:""};return this.getGroupsDataAndMarkTTI("/groups_ajax/get_groups_for_team_paginated",r,t)},getSearchGroupsResults:function(e,t){return U("/groups_ajax/get_groups_for_team_paginated",{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,only_company_managed:!1,search_query:this.state.searchQuery},t)},onCreateClicked:function(){var e=this;return _.deferredLoader.getResolvedItems(["CreateGroupModal","Modal"]).then(function(t){var r=t.CreateGroupModal;return t.Modal.showInstance(a.createElement(r,{teamName:e.props.teamName,isLimitedTeam:e.props.isLimitedTeam,canHaveAdminUi:e.props.canHaveAdminUi,insideAdminConsole:!1,enhancedGroupsEnabled:e.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:e.props.groupJoinPolicyEnabled}))})},onTriggerSearch:function(e){return e?this.setState({searchQuery:e,tablesVisible:!0}):this.setState({searchQuery:null,tablesVisible:!0})},onExitSearch:function(){return this.setState({searchQuery:null,tablesVisible:!0})},onFreshSearch:function(){return this.setState({searchQuery:null})},render:function(){return I.div({className:"groups-page"},I.div({className:"clearfix"},I.div({className:"tab-page-description u-mar-top-s u-mar-bottom-m"},A._("Create groups to share with many people at once.")),O(this.onTriggerSearch,this.onFreshSearch,this.onExitSearch)),this.renderMyGroupsList(),this.renderMoreGroupsList(),this.renderSearchGroupsList())},renderMyGroupsList:function(){if(this.state.tablesVisible&&null===this.state.searchQuery&&!this.props.mergedMembersAndGroups)return I.div({className:o("my-groups-list","u-mar-top-m")},a.createElement(L,{emptyMessage:I.span({},y.reactFormat(A._("You’re not a member of any groups yet. You can join groups from the <b>%(group_section)s</b> section below.<br />You can also start a new group by clicking <b>Create group</b>.",{comment:"'More groups' and 'Create group' should be same translation as those strings elsewhere on this page"}),{b:I.b(),br:I.br(),group_section:A._("All groups")})),initialData:this.props.initialMyGroupsDataDict,maxRows:this.props.infiniteScroll?1e4:5,onRequestData:this.getMyGroupsData,showJoinReqButtons:!1,showPendingCountForOwners:!0,canViewGroupDetails:!0,teamName:this.props.teamName,insideAdminConsole:!1,canHaveAdminUi:this.props.canHaveAdminUi,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled,nameColumn:A._("My groups")}))},renderMoreGroupsList:function(){if(this.state.tablesVisible&&null===this.state.searchQuery&&!this.props.mergedMembersAndGroups)return I.div({className:o("more-groups-list","u-mar-top-m")},a.createElement(L,{emptyMessage:I.span({},A._("There are no groups for you to join. You can start a new group by clicking "),I.b({},A._("Create group")),A._(".")),initialData:this.props.initialTeamGroupsDataDict,maxRows:10,infiniteScroll:this.props.infiniteScroll,rowsPerRequestForInfiniteScroll:h.MAX_ROWS_PER_PAGE,onRequestData:this.getOtherGroupsData,showJoinReqButtons:!this.props.canHaveAdminUi,showPendingCountForOwners:!1,canViewGroupDetails:this.props.canHaveAdminUi,teamName:this.props.teamName,insideAdminConsole:!1,canHaveAdminUi:this.props.canHaveAdminUi,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled,nameColumn:A._("All groups")}))},renderSearchGroupsList:function(){if(this.state.tablesVisible&&null!==this.state.searchQuery)return I.div({className:o("more-groups-list","u-mar-top-s")},a.createElement(L,{title:"",emptyMessage:I.div({className:"empty-groups-search-results"},A._("No groups found")),maxRows:h.MAX_ROWS_PER_PAGE,infiniteScroll:this.props.infiniteScroll,rowsPerRequestForInfiniteScroll:h.MAX_ROWS_TO_FETCH_FROM_SERVER,onRequestData:this.getSearchGroupsResults,showJoinReqButtons:!this.props.canHaveAdminUi,showPendingCountForOwners:!0,canViewGroupDetails:!0,teamName:this.props.teamName,insideAdminConsole:!1,searchQuery:this.state.searchQuery,canHaveAdminUi:this.props.canHaveAdminUi,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled}))}}),j=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasGroups:!1,searchQuery:null,tableVisible:!0},t.getGroupsData=function(e,r){return p.WebRequest({url:"/groups_ajax/get_groups_for_team_paginated",data:{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,only_company_managed:!1,search_query:t.state.searchQuery},subject_user:x.work_user,success:function(e){return e=JSON.parse(e),r(null,{rows:e.groups,total:e.total_groups})}})},t.getCompanyManagedGroupsData=function(e,r){return p.WebRequest({url:"/groups_ajax/get_groups_for_team_paginated",data:{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,only_company_managed:!0,search_query:t.state.searchQuery},subject_user:x.work_user,success:function(e){return e=JSON.parse(e),r(null,{rows:e.groups,total:e.total_groups})}})},t.onCreateClicked=function(){return _.deferredLoader.getResolvedItems(["CreateGroupModal","Modal"]).then(function(e){var r=e.CreateGroupModal;return e.Modal.showInstance(a.createElement(r,{teamName:t.props.teamName,isLimitedTeam:!1,canHaveAdminUi:!0,insideAdminConsole:!0,enhancedGroupsEnabled:t.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:t.props.groupJoinPolicyEnabled}))})},t.renderFindPanel=function(){if(t.state.hasGroups>0||"company_managed_groups"===t.props.filterValue||null!==t.state.searchQuery)return I.span({className:"group-find-panel"},O(t.onTriggerSearch,t.hideTable,t.onExitSearch))},t.renderGroupsList=function(){var e;if(t.state.tableVisible){e="all_groups"===t.props.filterValue?t.getGroupsData:t.getCompanyManagedGroupsData;var r=t.getEmptyMessage();return I.div({className:"more-groups-list"},a.createElement(L,{title:null,emptyMessage:r,maxRows:h.MAX_ROWS_PER_PAGE,infiniteScroll:!0,rowsPerRequestForInfiniteScroll:h.MAX_ROWS_TO_FETCH_FROM_SERVER,onRequestData:e,showJoinReqButtons:!1,showPendingCountForOwners:!0,canViewGroupDetails:!0,teamName:t.props.teamName,insideAdminConsole:!0,onTotalGroupsChange:t.onTotalGroupsChange,searchQuery:t.state.searchQuery,canHaveAdminUi:!0,enhancedGroupsEnabled:t.props.enhancedGroupsEnabled}))}},t.getEmptyMessage=function(){return"all_groups"===t.props.filterValue?null===t.state.searchQuery?I.span({className:"admin-console-empty-message"},I.div({className:"empty-groups-illustration"},I.img({className:"empty-groups-image",src:"/static/images/groups/groups_empty_illustration-vflibL0ss.svg",alt:""})),I.div({className:"empty-groups-view-header"},A._("You don’t have any groups yet.")),I.div({className:"empty-groups-desc"},A._("Groups make it easier to share with common lists of people in your team."))):I.div({className:"empty-groups-search-results"},A._("No groups found")):null===t.state.searchQuery?I.span({},A._("You don’t have any company-managed groups currently. "),I.a({href:"/help/7232",target:"_blank"},A._("Learn more")),A._(" about company-managed groups.")):I.div({className:"empty-groups-search-results"},A._("No company-managed groups found"))},t.onTotalGroupsChange=function(e){return t.setState({hasGroups:e>0})},t.onTriggerSearch=function(e){return t.setState({searchQuery:e,tableVisible:!0})},t.onExitSearch=function(){return t.setState({searchQuery:null,tableVisible:!0})},t.hideTable=function(){return t.setState({tableVisible:!1})},t}return r.__extends(t,e),t.prototype.render=function(){return I.div({className:"groups-page"},this.renderFindPanel(),this.renderGroupsList())},t.displayName="GroupsListForAdminsPage",t.propTypes={teamName:D.string,enhancedGroupsEnabled:D.bool,groupJoinPolicyEnabled:D.bool,filterValue:D.string,onUserFilterChange:D.func},t})(a.Component);return(function(t){function s(){var r=null!==t&&t.apply(this,arguments)||this;return r.requireSingleGroupPage=function(){if(!r.state.singleGroupPageElement)return e(["modules/clean/groups/single_group_page"],function(e){return r.setState({singleGroupPageElement:e})})},r.requireModals=function(){if(!r.state.modalsLoaded)return r.setState({modalsLoaded:!0}),e(["modules/clean/groups/simple_modals","modules/clean/groups/create_group_modal","modules/clean/react/modal","modules/clean/teams/modals/delete_group_modal","modules/clean/teams/modals/leave_group_modal"],function(e,t,o,s,a){var n=e.showSwitchToAdminManagedGroupModal,i=o.Modal,u=s.showDeleteGroupModal,l=a.showLeaveGroupModal;return r.setState({CreateGroupModalElement:t}),_.deferredLoader.setItems({showLeaveGroupModal:l,showDeleteGroupModal:u,showSwitchToAdminManagedGroupModal:n,CreateGroupModal:t,Modal:i})})},r.groupIdFromHash=function(){var e=null!=window.location.hash?window.location.hash.split("#").pop():void 0,t=null!=e?e.split("/"):void 0,r=null!=t?t[1]:void 0;return null!=r&&""!==r?r:void 0},r.refreshGroup=function(){return null!=r.refs.single_group_page?r.refs.single_group_page.onGroupChanged(!0):void 0},r.showRenameGroupModal=function(){return null!=r.refs.single_group_page?r.refs.single_group_page.showRenameGroupModal():void 0},r.showAddMembersModal=function(){return null!=r.refs.single_group_page?r.refs.single_group_page.showAddMembersModal():void 0},r.onUserFilterChange=function(e,t){return r.setState({filterValue:t})},r.shouldRenderCreateGroupButton=function(){return r.props.insideAdminConsole},r.onNewSingleGroup=function(e){return r.setState({singleGroup:e}),"function"==typeof r.props.onNewSingleGroup?r.props.onNewSingleGroup(e):void 0},r.onCreateClicked=function(){var e=!1,t=!0,o=!0;return r.props.insideAdminConsole||(e=r.props.isLimitedTeam,t=r.props.canHaveAdminUi,o=!1),_.deferredLoader.getResolvedItems(["CreateGroupModal","Modal"]).then(function(s){var n=s.CreateGroupModal;return s.Modal.showInstance(a.createElement(n,{teamName:r.props.teamName,isLimitedTeam:e,canHaveAdminUi:t,insideAdminConsole:o,enhancedGroupsEnabled:r.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:r.props.groupJoinPolicyEnabled}))})},r.getFilterOptions=function(){var e=[];return e.push({value:"all_groups",text:A._("All groups"),selected_text:A._("All groups")}),e.push({value:"company_managed_groups",text:A._("Company-managed groups"),selected_text:A._("Company-managed")}),e},r.getSidebarFilters=function(){var e=r.getFilterOptions(),t=e.find(function(e){return e.value===r.state.filterValue}).selected_text;return I.div({className:"groups-maestro-filter"},I.div({className:"filter-label"},A._("Group type",{comment:"Label for a dropdown that filters groups according to group type"})),R(n.DropdownMenu,{onSelection:r.onUserFilterChange.bind(r,r.state.filterValue)},R(n.DropdownMenuButton,{},t),R(n.Menu,{},e.map(function(e){return R(n.MenuItem,{value:e.value},I.div({className:"filter-option"},I.div({className:"filter-option-value"},e.text)))}))))},r.getSidebarButtonsGroups=function(){var e=void 0;return r.shouldRenderCreateGroupButton()&&(e={displayName:A._("Create group"),handleClick:r.onCreateClicked,disabled:!1}),{primaryMenuItem:e,primarySubnode:r.getSidebarFilters()}},r.showDeleteGroupModalDeferred=function(){return _.deferredLoader.getResolvedItems(["showDeleteGroupModal"]).then(function(e){return(0,e.showDeleteGroupModal)({groupId:r.state.singleGroup.id,groupName:r.state.singleGroup.name,onPrimaryAction:function(){G.set_hash("groups")}})})},r.showLeaveGroupModalDeferred=function(){return _.deferredLoader.getResolvedItems(["showLeaveGroupModal"]).then(function(e){return(0,e.showLeaveGroupModal)({groupId:r.state.singleGroup.id,groupName:r.state.singleGroup.name,userId:T.Viewer.get_viewer().work_user.id,onPrimaryAction:function(){G.set_hash("groups")}})})},r.showSwitchToAdminManagedGroupModalDeferred=function(){return _.deferredLoader.getResolvedItems(["showSwitchToAdminManagedGroupModal"]).then(function(e){return(0,e.showSwitchToAdminManagedGroupModal)(r.state.singleGroup,r.props.insideAdminConsole,r.refs.single_group_page.onAdminManaged)})},r.getSidebarOwnerGroup=function(){var e=r.refs.single_group_page,t={displayName:A._("Add members"),handleClick:e.showAddMembersModal,disabled:!1},o=[];return r.viewerIsMember()&&o.push({displayName:A._("Leave group"),handleClick:r.showLeaveGroupModalDeferred,disabled:!1,iconName:"leave-group"}),o.push({displayName:A._("Delete group"),handleClick:r.showDeleteGroupModalDeferred,disabled:!1,iconName:"delete-group"}),r.props.canHaveAdminUi&&!r.props.isLimitedTeam&&(r.state.singleGroup.is_admin_managed?o.push({displayName:A._("Make user-managed"),handleClick:e.showSwitchToMemberManagedGroupModal,disabled:!1,iconName:"make-user-managed-group"}):o.push({displayName:A._("Make company-managed"),handleClick:r.showSwitchToAdminManagedGroupModalDeferred,disabled:!1,iconName:"make-company-managed-group"})),o.push({displayName:A._("Edit group"),handleClick:e.showUpdateGroupModal,disabled:!1,iconName:"edit-group"}),{primaryMenuItem:t,secondaryMenuItems:o}},r.getSidebarNonOwnerGroup=function(){return{primaryMenuItem:{displayName:A._("Leave group"),handleClick:r.showLeaveGroupModalDeferred,disabled:!1}}},r.viewerIsOwner=function(){return null!=r.state.singleGroup?r.state.singleGroup.is_owner:void 0},r.viewerIsMember=function(){return null!=r.state.singleGroup?r.state.singleGroup.is_member:void 0},r.getSidebarButtonsSingleGroup=function(){if(null!=r.state.singleGroup&&!r.state.singleGroup.is_team_group){if(r.props.canHaveAdminUi)return r.getSidebarOwnerGroup();if(!r.state.singleGroup.is_admin_managed){if(r.viewerIsOwner())return r.getSidebarOwnerGroup();if(r.viewerIsMember()&&!r.props.groupControlledByAdmin)return r.renderNonOwnerMemberButtons()}}},r.getSidebarButtons=function(){return null!=r.state.viewingGroupId?r.getSidebarButtonsSingleGroup():r.getSidebarButtonsGroups()},r.renderBreadcrumbs=function(){var e;e=r.props.insideAdminConsole?"#/":"#groups";var t=[{name:A._("Groups"),url:e}];return r.state.singleGroup&&t.push({name:r.state.singleGroup.name}),R(m.default,{items:t})},r.renderPagelet=function(){var e=null!=r.state.viewingGroupId?r.renderBreadcrumbs():A._("Groups"),t=r.getSidebarButtons();return R(C.AdminConsoleMaestroViewNoUploadButton,{header:e,sidebar:t},r.renderPage())},r.renderPage=function(){return I.div({className:"team_admin_panel"},I.div({className:o("groups",{"sidebar-actions":!0})},r.renderContent()))},r.renderContent=function(){return null!=r.state.viewingGroupId?"newgroup"===r.state.viewingGroupId?r.state.CreateGroupModalElement?a.createElement(r.state.CreateGroupModalElement,{teamName:r.props.teamName,isLimitedTeam:r.props.isLimitedTeam,canHaveAdminUi:r.props.canHaveAdminUi,insideAdminConsole:r.props.insideAdminConsole,enhancedGroupsEnabled:r.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:r.props.groupJoinPolicyEnabled}):null:r.state.singleGroupPageElement?a.createElement(r.state.singleGroupPageElement,{ref:"single_group_page",groupId:r.state.viewingGroupId,canHaveAdminUi:r.props.canHaveAdminUi,teamName:r.props.teamName,groupControlledByAdmin:r.props.groupControlledByAdmin,isLimitedTeam:r.props.isLimitedTeam,insideAdminConsole:r.props.insideAdminConsole,enhancedGroupsEnabled:r.props.enhancedGroupsEnabled,sharedContentListEnabled:r.props.sharedContentListEnabled,groupJoinPolicyEnabled:r.props.groupJoinPolicyEnabled,onNewGroupFetched:r.onNewSingleGroup,isMaestroDesign:!0}):R(c.LoadingIndicator,{style:c.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER}):r.props.insideAdminConsole?a.createElement(j,{teamName:r.props.teamName,enhancedGroupsEnabled:r.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:r.props.groupJoinPolicyEnabled,filterValue:r.state.filterValue,onUserFilterChange:r.onUserFilterChange}):a.createElement(q,{canHaveAdminUi:r.props.canHaveAdminUi,groupControlledByAdmin:r.props.groupControlledByAdmin,teamName:r.props.teamName,isLimitedTeam:r.props.isLimitedTeam,enhancedGroupsEnabled:r.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:r.props.groupJoinPolicyEnabled,mergedMembersAndGroups:r.props.mergedMembersAndGroups,infiniteScroll:r.props.infiniteScroll,initialMyGroupsDataDict:r.props.initialMyGroupsDataDict,initialTeamGroupsDataDict:r.props.initialTeamGroupsDataDict})},r.state={viewingGroupId:r.groupIdFromHash(),filterValue:"all_groups",singleGroupPageElement:null},r}return r.__extends(s,t),s.prototype.componentWillMount=function(){var e=this;return N.waitForTTI().then(function(){return e.requireSingleGroupPage(),e.requireModals()}),l(window).on("hashchange",function(){return e.onNewSingleGroup(null),e.setState({viewingGroupId:e.groupIdFromHash()})})},s.prototype.componentDidMount=function(){if(this.state.viewingGroupId)return this.requireSingleGroupPage(),this.requireModals()},s.prototype.render=function(){return g.require_css("/static/css/groups/react_groups-vflI9Np-R.css"),g.require_css("/static/css/react/table-vflkFXmsd.css"),this.props.isFullPage?this.renderPagelet():this.renderContent()},s.displayName="GroupsPageContainer",s.propTypes={canHaveAdminUi:D.bool,groupControlledByAdmin:D.bool,teamName:D.string,isLimitedTeam:D.bool,insideAdminConsole:D.bool,enhancedGroupsEnabled:D.bool,sharedContentListEnabled:D.bool,groupJoinPolicyEnabled:D.bool,mergedMembersAndGroups:D.bool,infiniteScroll:D.bool,onNewSingleGroup:D.func,isFullPage:D.bool,initialMyGroupsDataDict:D.object,initialTeamGroupsDataDict:D.object},s})(a.Component)}),define("modules/clean/groups/simple_modals",["require","exports","external/purify","modules/clean/ajax","modules/clean/groups/utils","modules/clean/react/modal","modules/clean/viewer","modules/core/i18n","modules/core/notify","external/react"],function(e,t,r,o,s,a,n,i,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n.Viewer.get_viewer(),m=function(e,t,n,m){var p=n.name?n.name:n.email,d=i._("Removing %(name)s will cause them to lose access to folders that have been shared with the group.<br/><br/> It might take a little while to remove members from all of this group’s shared folders.<br/><br/> Are you sure you want to do this?").format({name:p});return a.SimpleModal.show({title_text:i._("Remove %(name)s?").format({name:p}),body_html:r.sanitize(d),confirm_text:i._("Remove"),cancel_text:i._("Cancel"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/remove_user_from_group",data:{group_id:e.id,user_id:n.user_id},subject_user:l.work_user,success:function(e){return u.success(i._("Removing member...")),"function"==typeof m?m(n):void 0},error:function(e){if(s.isGroupDeleted(e))return s.redirectToGroupsPage(t)}})}})};t.showRemoveUserModal=m;var p=function(e,t,n,u){var m=this,p=i._("%(name)s will no longer be able to add and remove managers, change group information, or delete the group.").format({name:n.name});return a.SimpleModal.show({title_text:i._("Remove manager permissions from %(name)s?").format({name:n.name}),body_html:r.sanitize(p),confirm_text:i._("Remove manager permissions"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/change_group_member_type",data:{group_id:e.id,user_id:n.user_id,is_owner:!1},subject_user:l.work_user,success:function(t){return n.is_owner=!1,e.owners=e.owners.filter(function(e){return e.email!==n.email}),n.user_id===l.work_user.id&&(e.is_owner=!1),u(!1,e)},error:function(e,r,o){if(m.setState({submitting:!1,errors:(function(){try{return JSON.parse(o)}catch(e){}})()}),s.isGroupDeleted(e))return s.redirectToGroupsPage(t)}})}})};t.showRemoveOwnerPermissionsModal=p;var d=function(e,t,n,u){var m=this,p=i._("%(name)s will be able to add and remove managers, and change group information. <br/>%(name)s will also be able to delete the group.").format({name:n.name});return a.SimpleModal.show({title_text:i._("Make %(name)s a manager?").format({name:n.name}),body_html:r.sanitize(p),confirm_text:i._("Make manager"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/change_group_member_type",data:{group_id:e.id,user_id:n.user_id,is_owner:!0},subject_user:l.work_user,success:function(t){n.is_owner=!0;var r={name:n.name,email:n.email};return e.owners.push(r),u(!1,e)},error:function(e,r,o){if(m.setState({submitting:!1,errors:(function(){try{return JSON.parse(o)}catch(e){}})()}),s.isGroupDeleted(e))return s.redirectToGroupsPage(t)}})}})};t.showMakeOwnerModal=d;var c=function(e,t,n){return a.SimpleModal.show({title_text:i._("Make company-managed?"),body_html:r.sanitize(i._("This will become a company-managed group, and admins will be responsible for adding and removing members.")),confirm_text:i._("Make company-managed"),cancel_text:i._("Cancel"),confirm_callback:function(){return o.WebRequest({url:"/groups_ajax/change_to_admin_managed_type",data:{group_id:e.id},subject_user:l.work_user,success:function(t){return u.success(i._("%(group_name)s is now company-managed").format({group_name:e.name})),n()},error:function(e){if(s.isGroupDeleted(e))return s.redirectToGroupsPage(t)}})}})};t.showSwitchToAdminManagedGroupModal=c}),define("modules/clean/groups/single_group_page",["require","exports","tslib","external/create-react-class","external/react","modules/clean/ajax","modules/clean/analytics","modules/clean/avatar/group_avatar","modules/clean/css","modules/clean/groups/add_group_members_modal","modules/clean/groups/group_member_list","modules/clean/groups/group_shared_content_list","modules/clean/teams/modals/leave_group_modal","modules/clean/groups/switch_to_member_managed_group_modal","modules/clean/groups/update_group_modal","modules/clean/groups/utils","modules/clean/react/button","modules/clean/react/image","modules/clean/react/input","modules/core/browser","modules/clean/react/modal","modules/clean/static_urls","modules/clean/viewer","modules/core/i18n","modules/core/notify","modules/core/user_i18n"],function(e,t,r,o,s,a,n,i,u,l,m,p,d,c,g,_,h,f,b,v,M,y,w,C){"use strict";var T=s.DOM,N=s.PropTypes,S=s.createElement,G=b.text,A=w.Viewer.get_viewer(),E=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showUpdateGroupModal=function(){return M.Modal.showInstance(s.createElement(g,{enhancedGroupsEnabled:t.props.enhancedGroupsEnabled,origGroupName:t.props.group.name,origGroupDescription:t.props.group.description,origGroupJoinPolicy:t.props.group.group_join_policy,groupId:t.props.group.id,isAdminManaged:t.props.group.is_admin_managed,insideAdminConsole:t.props.insideAdminConsole,onGroupChanged:t.props.onGroupChanged,groupJoinPolicyEnabled:t.props.groupJoinPolicyEnabled,teamName:t.props.teamName}))},t.showAddMembersModal=function(){return M.Modal.showInstance(s.createElement(l,{group:t.props.group,insideAdminConsole:t.props.insideAdminConsole,onGroupChanged:t.props.onGroupChanged}))},t.renderGroupInfo=function(){var e;if(t.props.group.is_team_group)e=C._("This group was created automatically and includes invited members. To change who’s in the group, admins can add or remove members of %(team_name)s").format({team_name:t.props.teamName});else{var r=void 0;if(t.props.group.is_admin_managed)r=t.props.teamName;else if(t.props.group.owners.length>0){for(var o=[],s=0,a=Array.from(t.props.group.owners);s<a.length;s++){var n=a[s];o.push(n.name)}r=o.join(", ")}else r="-";e=C._("Managed by ")+r}return t.props.insideAdminConsole?T.div({className:"current-location"},T.span({className:"group-info-container"},S(i,{group:t.props.group,dimension:48,optionalClass:"u-mar-right-s"})),T.span({className:"group-info"},T.span({className:"group-name-container"},T.span({className:"group-name"},t.props.group.name)),T.span({className:"group-managers"},e)),t.props.enhancedGroupsEnabled?t.renderDescription():void 0):[T.h2({className:"group-name"},C._("Information")),T.h3({className:"group-managers u-mar-bottom-xs"},e)]},t.renderDescription=function(){var e=t.props.group.description;return T.div({className:"group-description"},T.div({className:"group-description-text"},e))},t.onAdminManaged=function(){return t.props.onGroupChanged(!0,null)},t.onMemberManaged=function(e){var r=0;t.props.group.is_admin_managed=!1,t.props.group.owners=[];for(var o=0,s=Array.from(t.props.group.users);o<s.length;o++){var a=s[o];Array.from(e).includes(a.email)&&(a.is_owner=!0,t.props.group.owners.push(a),r+=1)}var n=e.length,i=r<n;return t.props.onGroupChanged(i,t.props.group)
},t.showSwitchToMemberManagedGroupModal=function(){return M.Modal.showInstance(s.createElement(c,{group:t.props.group,onMemberManaged:t.onMemberManaged,insideAdminConsole:t.props.insideAdminConsole}))},t.renderNonOwnerMemberButtons=function(){return s.createElement(h.button,{className:"leave-group-button",importance:"tertiary",onClick:function(){return d.showLeaveGroupModal({groupId:t.props.group.id,groupName:t.props.group.name,userId:A.work_user.id,onPrimaryAction:function(){v.set_hash("groups")}})}},C._("Leave group"))},t}return r.__extends(t,e),t.prototype.render=function(){return T.div({className:"single-group-header"},T.div({className:"group-header"},this.renderGroupInfo()))},t.displayName="SingleGroupHeader",t.propTypes={group:N.object,canHaveAdminUi:N.bool,teamName:N.string,onGroupChanged:N.func,groupControlledByAdmin:N.bool,isLimitedTeam:N.bool,insideAdminConsole:N.bool,enhancedGroupsEnabled:N.bool,groupJoinPolicyEnabled:N.bool,isMaestroDesign:N.bool},t})(s.Component);return o({displayName:"SingleGroupPage",propTypes:{groupId:N.string,canHaveAdminUi:N.bool,teamName:N.string,groupControlledByAdmin:N.bool,isLimitedTeam:N.bool,insideAdminConsole:N.bool,enhancedGroupsEnabled:N.bool,sharedContentListEnabled:N.bool,groupJoinPolicyEnabled:N.bool,isMaestroDesign:N.bool,onNewGroupFetched:N.func},getInitialState:function(){return{group:void 0}},componentWillMount:function(){return this.fetchGroup(this.props.groupId)},componentWillReceiveProps:function(e){if(this.props.groupId!==e.groupId)return this.setState({group:void 0}),this.fetchGroup(e.groupId)},fetchGroup:function(e,t,r,o,s){var n=this;return void 0===t&&(t=0),void 0===r&&(r="display_name_lower"),void 0===o&&(o=1),void 0===s&&(s=null),this.setState({loading:!0,search_query:s}),a.WebRequest({url:"/groups_ajax/get_group_info",data:{group_id:e,offset:t,limit:_.MAX_ROWS_TO_FETCH_FROM_SERVER,sort_column:r,sort_direction:o,search_query:s},subject_user:A.work_user,success:function(e){if(n.isMounted()){if(e=JSON.parse(e),n.state.search_query!==s)return;return n.setState({group:e.data,loading:!1}),"function"==typeof n.props.onNewGroupFetched?n.props.onNewGroupFetched(e.data):void 0}},error:function(e){return _.redirectToGroupsPage(n.props.insideAdminConsole)}})},onUserTextChange:function(e){var t=this,r=e.target.value;return window.clearTimeout(this.searchTimeout),r.trim().length>0||0===r.length?this.searchTimeout=window.setTimeout(function(){return r.length>0?t.fetchGroup(t.props.groupId,0,null,null,r):t.fetchGroup(t.props.groupId)},500):this.refs.memberSearchInput.setValue("")},renderSpinner:function(){return T.div({className:"groups-spinner"},s.createElement(f.Image,{src:y.static_url("/static/images/icons/ajax-loading-small-blue-vflVk_QNP.gif"),srcHiRes:y.static_url("/static/images/icons/ajax-loading-small-blue@2x-vfl14X6Ll.gif"),alt:C._("Loading")}))},onGroupChanged:function(e,t,r,o){return void 0===r&&(r=null),void 0===o&&(o=null),e?this.fetchGroup(this.props.groupId,0,r,o,this.state.search_query):(this.setState({group:t}),"function"==typeof this.props.onNewGroupFetched?this.props.onNewGroupFetched(t):void 0)},showRenameGroupModal:function(){return null!=this.refs.single_group_header?this.refs.single_group_header.showUpdateGroupModal():void 0},showAddMembersModal:function(){var e=this.state.group.users.filter(function(e){return e.is_owner}).map(function(e){return e.user_id}),t={group_owner_ids:e,team_id:this.state.group.team_id,team_type:A.team_type,group_id:this.props.groupId};return n.TeamsWebActionsLogger.log("groups_add_members_clicked",t),null!=this.refs.single_group_header?this.refs.single_group_header.showAddMembersModal():void 0},showSwitchToMemberManagedGroupModal:function(){return null!=this.refs.single_group_header?this.refs.single_group_header.showSwitchToMemberManagedGroupModal():void 0},showUpdateGroupModal:function(){return null!=this.refs.single_group_header?this.refs.single_group_header.showUpdateGroupModal():void 0},onAdminManaged:function(){return null!=this.refs.single_group_header?this.refs.single_group_header.onAdminManaged():void 0},render:function(){return this.state.loading&&!this.state.group?this.renderSpinner():(u.require_css("/static/css/react/contacts_tokenizer-vflQsfYaG.css"),T.div({className:"single-group-view"},s.createElement(E,{ref:"single_group_header",group:this.state.group,canHaveAdminUi:this.props.canHaveAdminUi,teamName:this.props.teamName,onGroupChanged:this.onGroupChanged,groupControlledByAdmin:this.props.groupControlledByAdmin,isLimitedTeam:this.props.isLimitedTeam,insideAdminConsole:this.props.insideAdminConsole,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,groupJoinPolicyEnabled:this.props.groupJoinPolicyEnabled,isMaestroDesign:this.props.isMaestroDesign}),T.span({className:"team-admin-maestro-search"},T.div({className:"maestro-search-outer-label"},C._("Search group members")),T.span({className:"member-maestro-find-panel"},S(G,{name:"search-input",ref:"memberSearchInput",onChange:this.onUserTextChange,placeholder:C._("Name or email",{comment:"a placeholder in a search box, hints the user to search members by Name or email"}),"disable-errors":!0,compatiblePlaceholder:!0,className:"team-admin-text-input"}))),this.state.loading?this.renderSpinner():s.createElement(m.MemberList,{group:this.state.group,canHaveAdminUi:this.props.canHaveAdminUi,onGroupChanged:this.onGroupChanged,isMaestroDesign:!0,insideAdminConsole:this.props.insideAdminConsole,search_query:this.state.search_query}),this.props.sharedContentListEnabled?s.createElement(p,{groupId:this.props.groupId}):void 0))}})}),define("modules/clean/groups/switch_to_member_managed_group_modal",["require","exports","external/create-react-class","external/react","jquery","modules/clean/ajax","modules/clean/groups/group_members_form","modules/clean/groups/utils","modules/clean/react/modal","modules/clean/viewer","modules/core/i18n","modules/core/notify"],function(e,t,r,o,s,a,n,i,u,l,m,p){"use strict";var d=o.DOM,c=o.PropTypes,g=l.Viewer.get_viewer();return r({displayName:"SwitchToMemberManagedGroupModal",propTypes:{group:c.object,onMemberManaged:c.func,insideAdminConsole:c.bool},getInitialState:function(){return{canProceed:!0,submitting:!1}},componentDidMount:function(){return s(".contacts-tokenizer-input").select()},_canProceed:function(){return null!=this.refs.members?this.refs.members.areAllContactsValid():void 0},onSubmit:function(e){var t=this;return e.preventDefault(),this.refs.members.getFinalData(function(e){var r=e.emails,o=t._canProceed();if(t.setState({canProceed:o}),o){t.setState({submitting:!0});var s=t.props.group.name,n=t.props.onMemberManaged;return a.WebRequest({url:"/groups_ajax/change_to_member_managed_type",data:{new_owners:JSON.stringify(r),group_id:t.props.group.id},subject_user:g.work_user,complete:function(){if(t.isMounted())return t.setState({submitting:!1})},success:function(e){return p.success(m._("%(group_name)s is now user-managed").format({group_name:s})),u.Modal.close(),n(Array.from(r).map(function(e){return e.email}))},error:function(e){if(i.isGroupDeleted(e))return u.Modal.close(),i.redirectToGroupsPage(t.props.insideAdminConsole)}})}})},onMembersFormChange:function(){return this.setState({canProceed:this._canProceed()})},render:function(){return o.createElement(u.Modal,{title:m._("Make user-managed?"),acceptButtonText:m._("Make user-managed"),dismissButtonText:m._("Cancel"),acceptButtonDisabled:!this.state.canProceed,submitting:this.state.submitting,onAccept:this.onSubmit,ref:"modal"},d.label({className:"label-description"},m._("This will become a user-managed group, and the person you choose below will be responsible for approving new members. Group members can leave whenever they like.")),d.br({}),d.br({}),d.label({className:"label-description-secondary"},m._("Who should manage this group?")),o.createElement(n,{ref:"members",group:this.props.group,onChange:this.onMembersFormChange,errorMessageSpaceFixed:!1,includeCustomMessage:!1,emailPlaceholder:m._("Name or email address"),disallowGroupMembers:!1}))}})}),define("modules/clean/groups/update_group_modal",["require","exports","external/create-react-class","external/react","modules/clean/ajax","modules/clean/groups/utils","modules/clean/react/input","modules/clean/react/modal","modules/clean/viewer","modules/constants/teams","modules/core/i18n"],function(e,t,r,o,s,a,n,i,u,l,m){"use strict";var p=o.DOM,d=o.PropTypes,c=u.Viewer.get_viewer();return r({displayName:"UpdateGroupModal",propType:{enhancedGroupsEnabled:d.bool,groupId:d.string,origGroupName:d.string,origGroupDescription:d.string,onGroupChanged:d.func,isAdminManaged:d.bool,insideAdminConsole:d.bool,origGroupJoinPolicy:d.int,groupJoinPolicyEnabled:d.bool,teamName:d.string},getInitialState:function(){return{newGroupName:this.props.origGroupName,newGroupDescription:this.props.origGroupDescription,newGroupJoinPolicy:this.props.origGroupJoinPolicy,submitting:!1,errors:null}},groupNameIsValid:function(){return this.state.newGroupName.length<=a.MAX_GROUP_NAME_LEN},groupDescriptionIsValid:function(){return null===this.state.newGroupDescription||this.state.newGroupDescription.length<=a.MAX_GROUP_DESCRIPTION_LEN},canProceed:function(){return!this.state.submitting&&this.groupNameIsValid()&&this.groupDescriptionIsValid()},getLocalNameError:function(){if(!this.groupNameIsValid())return{message_text:m._("The group name should be under %(max_len)d characters").format({max_len:a.MAX_GROUP_NAME_LEN})}},getLocalDescriptionError:function(){if(!this.groupDescriptionIsValid())return{message_text:m._("The group description should be under %(max_len)d characters").format({max_len:a.MAX_GROUP_DESCRIPTION_LEN})}},onChangeGroupName:function(e){return this.setState({newGroupName:e.target.value})},onChangeGroupDescription:function(e){return this.setState({newGroupDescription:e.target.value})},onChangeJoinPolicy:function(e){var t;return t=e.target.checked?l.GROUP_JOIN_POLICY_OPEN:l.GROUP_JOIN_POLICY_REQUEST_TO_JOIN,this.setState({newGroupJoinPolicy:t})},onSubmit:function(e){var t=this;if(null!=e&&e.preventDefault(),this.canProceed()&&!this.state.submitting)return this.setState({submitting:!0}),s.WebRequest({url:"/groups_ajax/update_group",data:{group_id:this.props.groupId,new_name:this.state.newGroupName,new_description:this.state.newGroupDescription,new_join_policy:this.state.newGroupJoinPolicy},subject_user:c.work_user,success:function(e){return e=JSON.parse(e),i.Modal.close(),t.props.onGroupChanged(!0,null)},error:function(e,r,o){if(t.setState({submitting:!1,errors:(function(){try{return JSON.parse(o)}catch(e){}})()}),a.isGroupDeleted(e))return i.Modal.close(),a.redirectToGroupsPage(t.props.insideAdminConsole)}})},render:function(){var e=this.props.enhancedGroupsEnabled?m._("Group name and description"):m._("Group name");return o.createElement(i.Modal,{className:"update-group-modal",title:m._("Edit ‘%(group_name)s’").format({group_name:this.props.origGroupName}),acceptButtonText:m._("Save changes"),dismissButtonText:m._("Cancel"),acceptButtonDisabled:!this.canProceed(),submitting:this.state.submitting,onAccept:this.onSubmit,autoClose:!1},p.form({onSubmit:this.onSubmit},p.label({className:"label-description"},e),o.createElement(n.text,{className:this.props.enhancedGroupsEnabled?"group-name-input-enhanced":"group-name-input",defaultValue:this.props.origGroupName,placeholder:"Group name",onChange:this.onChangeGroupName,autofocus:!0,"error-after":!1,error:this.getLocalNameError()||(null!=this.state.errors?this.state.errors.new_name:void 0)||(null!=this.state.errors?this.state.errors.full_name:void 0)}),this.props.enhancedGroupsEnabled?p.label({className:"label-description"},o.createElement(n.textarea,{className:"group-description-input",defaultValue:this.props.origGroupDescription,placeholder:m._("Purpose or mission"),onChange:this.onChangeGroupDescription,autofocus:!0,"error-after":!0,error:this.getLocalDescriptionError()||(null!=this.state.errors?this.state.errors.new_description:void 0)||(null!=this.state.errors?this.state.errors.full_description:void 0)})):void 0,this.props.enhancedGroupsEnabled&&this.props.groupJoinPolicyEnabled?p.div({className:"join-policy u-mar-top-s"},p.input({type:"checkbox",defaultChecked:this.props.origGroupJoinPolicy,onChange:this.onChangeJoinPolicy,disabled:this.props.isAdminManaged}),p.label({},m._("Allow anyone at %(team_name)s to join").format({team_name:this.props.teamName})),this.props.isAdminManaged?p.label({className:"disable-join-policy-message"},m._(" Only permitted for user-managed groups.")):void 0):void 0))}})}),define("modules/clean/groups/utils",["require","exports","modules/core/browser"],function(e,t,r){"use strict";var o=(function(){function e(){}return e.initClass=function(){this.MAX_GROUP_NAME_LEN=140,this.MAX_GROUP_DESCRIPTION_LEN=400,this.MAX_ROWS_PER_PAGE=15,this.MAX_ROWS_TO_FETCH_FROM_SERVER=50},e.isGroupDeleted=function(e){return e.responseText.indexOf("group has been deleted")!==-1},e.redirectToGroupsPage=function(e){var t;return t=e?"/":"groups",r.set_hash(t)},e})();return o.initClass(),o}),define("modules/clean/react/maestro/tabs",["require","exports","tslib","external/classnames","external/lodash","external/react","modules/core/browser","modules/clean/event_handler","modules/clean/react/css","modules/clean/react/maestro/tab_nav","modules/clean/react/tabs/tab_util","modules/clean/react/tabs/tabs"],function(e,t,r,o,s,a,n,i,u,l,m,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedIndex:0,idPrefix:t.props.idPrefix||"tabset"+s.uniqueId(),tabs:[]},t._onChange=function(e,r){t.setState({selectedIndex:r});var o=t.state.tabs[r];o.hashURL&&n.set_hash(o.hashURL),t.props.onChange&&t.props.onChange(e,r)},t}return r.__extends(t,e),t.prototype.componentWillMount=function(){var e=this.props.children,t=this.state,r=t.selectedIndex,o=t.idPrefix,n=[];e&&a.Children.forEach(e,function(e,t){var a=m.getTabContentId(o,t),i=e.props,u=i.title,l=i.hashPrefix,p=i.hashURL,d=i.rightAlign,c=i.isSelected;n.push({label:u,contentId:a,hashPrefix:l,hashURL:p,rightAlign:d,value:s.uniqueId()}),c&&(r=t)}),this.setState({tabs:n,selectedIndex:r})},t.prototype.componentDidMount=function(){this.events.on(window,"hashchange",this._selectTabFromHash,this),this._selectTabFromHash()},t.prototype.componentWillReceiveProps=function(e){null!=e.selectedIndex&&e.selectedIndex!==this.state.selectedIndex&&this.setState({selectedIndex:e.selectedIndex})},t.prototype._selectTabFromHash=function(){var e=n.get_hash();if(e)for(var t=this.state.tabs,r=0;r<t.length;r++){var o=t[r],s=o.hashPrefix,a=o.hashURL;if(s&&e&&e.startsWith(s)||e===a){this.setState({selectedIndex:r});break}}else this.setState({selectedIndex:0})},t.prototype.render=function(){var e,t=this.props,r=t.variant,s=t.className,n=t.children,i=this.state,u=i.tabs,p=i.idPrefix,d=i.selectedIndex;return n&&(e=a.Children.map(n,function(e,t){return a.cloneElement(e,{isSelected:t===d,id:m.getTabContentId(p,t),tabId:m.getTabId(p,t)})})),a.createElement("div",{className:o("maestro-tab-nav",s,r)},a.createElement(l.FixedTabBar,{tabs:u,onChange:this._onChange,idPrefix:p,selectedIndex:d}),e)},t.defaultProps={variant:m.TabVariant.DEFAULT},t=r.__decorate([i.eventHandler],t)})(a.Component),c=u(d,["/static/css/legacy_packages/components-vflC9ETTX.css"]);t.Tabs=c,t.TabContent=p.TabContent}),define("modules/clean/teams/admin/widgets/remove_user_for_limited_team_modal/remove_user_for_limited_team_modal",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/teams/admin/modals/action_utility_modal","modules/clean/teams/admin/modals/modal_ajax","modules/clean/components/modals/show_modal"],function(e,t,r,o,s,a,n,i){"use strict";function u(e,t){return t&&e?s._("%(id_string)s will lose access to all %(team_name)s groups. %(first_name)s’s account will be converted to a personal Dropbox."):t&&!e?s._("%(id_string)s will lose access to the %(team_name)s team folder and be removed from all %(team_name)s groups. %(first_name)s’s account will be converted to a personal Dropbox."):s._("%(id_string)s will be removed from the members list. Any invitation or activation links you’ve sent will no longer work.")}Object.defineProperty(t,"__esModule",{value:!0}),t.RemoveUserForLimitedTeamModal=function(e){var t=(e.userId,e.displayName),r=e.fName,n=e.teamName,i=e.email,l=e.isAdmin,m=e.isActive,p=(e.joinRequestStatus,e.onRequestClose),d=void 0===p?function(){}:p,c=e.onPrimaryAction,g=void 0===c?function(){}:c,_=e.onSecondaryAction,h=void 0===_?function(){}:_,f=m?s._("Remove member?"):s._("Remove pending member?"),b=(t?s._("%(display_name)s (%(email)s)"):s._("%(email)s")).format({display_name:t,email:i}),v=s._("Remove"),M=u(l,m).format({id_string:b,team_name:n,first_name:r});return o.createElement(a.ActionUtilityModal,{title:f,primaryAction:v,onPrimaryAction:g,onSecondaryAction:h,onRequestClose:d},M)},t.REMOVE_USER_URL=function(e){return e?"/team/join_request/reject":"/team/manage/kick"},t.SUCCESS_NOTIFY=function(e){return e?s._("Member removed."):s._("Pending member removed.")},t.RemoveUserForLimitedTeamModalAction=function(e){var o=e.userId,s=e.displayName,a=e.fName,i=e.teamName,u=e.email,l=e.isAdmin,m=e.isActive,p=e.joinRequestStatus,d=r.__rest(e,["userId","displayName","fName","teamName","email","isAdmin","isActive","joinRequestStatus"]);return n.modalAjax({modal:t.RemoveUserForLimitedTeamModal,ajax:{url:t.REMOVE_USER_URL(p),data:{user_id:o}},notify:{successNotify:t.SUCCESS_NOTIFY(m)}})(r.__assign({userId:o,displayName:s,fName:a,teamName:i,email:u,isAdmin:l,isActive:m,joinRequestStatus:p},d))},t.showRemoveUserForLimitedTeamModal=function(e){return i.showModal(o.createElement(t.RemoveUserForLimitedTeamModalAction,r.__assign({},e)))}}),define("modules/clean/teams/limited_team_tooltip_runner",["require","exports","tslib","external/immutable","external/react","external/react-dom","external/underscore","jquery","modules/clean/ajax","modules/clean/react/bubble","modules/clean/react/css","modules/clean/static_urls","modules/core/exception"],function(e,t,r,o,s,a,n,i,u,l,m,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=s.DOM,g=s.createElement,_=s.PropTypes,h=o.Record({heading:"",body:"",buttonText:"",arrowDirection:null,cssSelector:"",imageHref:"",imageHrefHires:"",imageHeight:"",imageWidth:null,onButtonClick:null,onButtonClickImmediate:null});t.TooltipSpec=h;var f=function(e,t,r){var o,s=n(e.tooltipSpecs).keys();if(n(e[t]).difference(s).length&&(o="Invalid prop "+t+" supplied to "+r+". All "+t+" values must exist in tooltipSpecs"),e[t]||(o="Prop "+t+" must be supplied to "+r+"."),o)return new Error(o)},b=(function(e){function t(t){var r=e.call(this,t)||this;return r.state={currentStepNumber:r.props.initialServerStep-r.props.serverStepOffset,waitingForServerResponse:!1},r.BUBBLE_WIDTH=250,r._initBubbleTracking=function(){return r._setBubbleLocation(),i(window).resize(r._setBubbleLocation)},r._specForStepNumber=function(e){return r.props.tooltipSpecs[r.props.tooltipSpecOrder[e]]},r._recordStepSeen=function(e){return u.WebRequest({url:"/team/onboarding_event",data:{stage:r.state.currentStepNumber+r.props.serverStepOffset},success:e})},r._recordAndAdvance=function(){if(!r.state.waitingForServerResponse){r.setState({waitingForServerResponse:!0});var e=r._specForStepNumber(r.state.currentStepNumber);return"function"==typeof e.onButtonClickImmediate&&e.onButtonClickImmediate(),r._recordStepSeen(function(t){var o=parseInt(JSON.parse(t).next_state);if(r.state.currentStepNumber===r.props.tooltipSpecOrder.length-1)return r.props.lastTooltipDismissedCb(o);var s=function(){return r.setState({currentStepNumber:o-r.props.serverStepOffset,waitingForServerResponse:!1}),"function"==typeof r.props.onStepAdvancedCb?r.props.onStepAdvancedCb(o):void 0};return e.onButtonClick?e.onButtonClick(s):s()})}},r._setBubbleLocation=r._setBubbleLocation.bind(r),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){return"complete"===document.readyState?this._initBubbleTracking():i(window).load(this._initBubbleTracking)},t.prototype.componentDidUpdate=function(){return this._setBubbleLocation()},t.prototype.componentWillUnmount=function(){return i(window).off("resize",this._setBubbleLocation)},t.prototype._setBubbleLocation=function(){var e,t,r=this._specForStepNumber(this.state.currentStepNumber);d.assert([l.ARROW.TOP,l.ARROW.LEFT,l.ARROW.LEFT_TOP].includes(r.arrowDirection),"trying to setBubbleLocation with unsupported arrow direction. Please add code for computing bubble location");var o=i(".react-bubble-box__arrow-border"),s=i(r.cssSelector);if(s.length){var n=i(a.findDOMNode(this.refs.tooltipBubble)),u=s.offset(),m=n.offsetParent().offset(),p=u.left-m.left,c=u.top-m.top,g=function(e){return Math.floor(e.outerWidth()/2)},_=function(e){return Math.floor(e.outerHeight()/2)};switch(r.arrowDirection){case l.ARROW.TOP:var h=o.outerHeight();h>40&&(h=18),e=p-g(n)+g(s),t=c+s.outerHeight()+h;break;case l.ARROW.LEFT:var f=o.outerWidth();f>40&&(f=18),e=p+s.outerWidth()+f,t=c-_(n)+_(s);break;case l.ARROW.LEFT_TOP:f=o.outerWidth(),f>40&&(f=18),e=p+s.outerWidth()+f,t=c-_(s)}return n.css({top:t,left:e,visibility:"visible"})}},t.prototype.render=function(){var e=this._specForStepNumber(this.state.currentStepNumber);return c.div({className:"limited-team-tooltips"},g(l,{ref:"tooltipBubble",arrow:e.arrowDirection,className:"limited-team-tooltips__bubble",style:{position:"absolute",width:this.BUBBLE_WIDTH,visibility:"hidden"}},c.div({className:"limited-team-tooltips__bubble-contents"},c.img({src:p.static_url(e.imageHref),srcHiRes:p.static_url(e.imageHrefHires||e.imageHref),className:"limited-team-tooltips__bubble-image",width:e.imageWidth||.84*this.BUBBLE_WIDTH,height:e.imageHeight,alt:""}),c.h2({},e.heading),c.p({},e.body),c.button({className:"button-primary limited-team-tooltips__bubble-button",onClick:this._recordAndAdvance},e.buttonText))))},t.displayName="LimitedTeamTooltipRunner",t.propTypes={initialServerStep:_.number.isRequired,serverStepOffset:_.number.isRequired,tooltipSpecs:_.objectOf(_.instanceOf(h)).isRequired,tooltipSpecOrder:f,lastTooltipDismissedCb:_.func,onStepAdvancedCb:_.func},t})(s.Component),v=m(b,["/static/css/react/bubble_box-vflpfsqHZ.css"]);t.LimitedTeamTooltipRunner=v}),define("modules/clean/teams/limited_team_tooltips",["require","exports","external/create-react-class","external/react","modules/clean/react/bubble","modules/clean/teams/limited_team_tooltip_runner","modules/core/browser","modules/core/i18n"],function(e,t,r,o,s,a,n,i){"use strict";var u=o.createElement,l=o.PropTypes;return r({displayName:"LimitedTeamTooltips",propTypes:{onboardingState:l.number.isRequired,lastTooltipDismissedCb:l.func},_getTooltipSpecs:function(){return{TEAM_TAB:new a.TooltipSpec({heading:i._("Manage membership"),body:i._("Invite people, remove members, and customize your work Dropbox here."),arrowDirection:s.ARROW.LEFT,buttonText:i._("Next"),cssSelector:".team-nav-item",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_manage-vflXw6tGQ.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_manage@2x-vflS2wbhg.png",imageHeight:130,onButtonClick:function(){return n.redirect("/team")}}),INVITE_MEMBERS:new a.TooltipSpec({heading:i._("Invite more people"),body:i._("Invite coworkers to join your work Dropbox here."),arrowDirection:s.ARROW.TOP,buttonText:i._("Next"),cssSelector:".invite-button",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_invite-vflwGI3rs.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_invite@2x-vflujxc7r.png",imageHeight:130}),GROUPS:new a.TooltipSpec({heading:i._("Create and view groups"),body:i._("Keep things organized by adding people to groups."),arrowDirection:s.ARROW.TOP,buttonText:i._("Next"),cssSelector:"#tab_team-tab-groups",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_groups-vflUdtiBT.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_groups@2x-vflYWShtX.png",imageHeight:130}),SETTINGS:new a.TooltipSpec({heading:i._("Customize settings"),body:i._("Update Paper sharing settings, change the name of your Dropbox, and more."),arrowDirection:s.ARROW.TOP,buttonText:i._("Next"),cssSelector:".settings-button",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_settings-vflTnLAOr.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_settings@2x-vflClprJl.png",imageHeight:130}),PAPER:new a.TooltipSpec({heading:i._("Dropbox Paper"),body:i._("Check out the best way to create and build on ideas with your team."),arrowDirection:s.ARROW.LEFT,buttonText:i._("Next"),cssSelector:".composer-nav-item",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_paper-vflQyNMh5.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_paper@2x-vfl7TJoJA.png",imageHeight:130,onButtonClickImmediate:function(){return n.open_tab("/paper")}})}},BUBBLE_INFO_ARRAY:["TEAM_TAB","INVITE_MEMBERS","GROUPS","SETTINGS","PAPER"],render:function(){return u(a.LimitedTeamTooltipRunner,{initialServerStep:this.props.onboardingState,lastTooltipDismissedCb:this.props.lastTooltipDismissedCb,serverStepOffset:2,tooltipSpecs:this._getTooltipSpecs(),tooltipSpecOrder:this.BUBBLE_INFO_ARRAY})}})}),define("modules/clean/teams/modals/delete_group_modal",["require","exports","tslib","external/react","modules/clean/teams/admin/modals/action_utility_modal","modules/clean/components/modals/show_modal","modules/core/i18n","modules/clean/viewer","modules/clean/teams/admin/modals/modal_ajax","modules/clean/react_format"],function(e,t,r,o,s,a,n,i,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteGroupModal=function(e){var t=(e.groupId,e.groupName),r=e.onRequestClose,a=void 0===r?function(){}:r,i=e.onPrimaryAction,u=void 0===i?function(){}:i,m=e.onSecondaryAction,p=void 0===m?function(){}:m,d=n._("Delete “%(group_name)s”?").format({group_name:t}),c=n._("Delete"),g=l.reactFormat(n._("<paragraph>Deleting “%(group_name)s” will cause all of its members to lose access to folders that have been shared with the group. You will not be able to undo this.</paragraph> <paragraph>It might take a little while for deleted groups to be removed from all their shared folders.</paragraph> <paragraph>Are you sure you want to delete the group?</paragraph>"),{paragraph:o.createElement("p",null),group_name:t});return o.createElement(s.ActionUtilityModal,{title:d,primaryAction:c,onPrimaryAction:u,onSecondaryAction:p,onRequestClose:a},g)},t.DELETE_GROUP_URL="/groups_ajax/remove_group",t.DeleteGroupModalAction=function(e){var o=e.groupId,s=e.groupName,a=r.__rest(e,["groupId","groupName"]);return u.modalAjax({modal:t.DeleteGroupModal,ajax:{url:t.DELETE_GROUP_URL,data:{group_id:o},subject_user:i.Viewer.get_viewer().work_user},notify:{successNotify:n._("Deleting group...")}})(r.__assign({groupId:o,groupName:s},a))},t.showDeleteGroupModal=function(e){return a.showModal(o.createElement(t.DeleteGroupModalAction,r.__assign({},e)))}}),define("modules/clean/teams/modals/delete_team_modal",["require","exports","tslib","external/react","modules/clean/ajax","modules/clean/react/modal","modules/clean/viewer","modules/core/browser","modules/core/i18n","modules/core/notify"],function(e,t,r,o,s,a,n,i,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=o.PropTypes,p=n.Viewer.get_viewer(),d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={submitting:!1},t._teamDeleted=function(){return l.success(u._("You successfully deleted the team.")),i.redirect("/home")},t._onAccept=function(){return t.setState({submitting:!0}),s.WebRequest({url:"/team/manage/delete",data:{team_id:t.props.teamId,_subject_uid:p.work_user.id},complete:function(){return t._teamDeleted()},success:function(){return t._teamDeleted()}})},t}return r.__extends(t,e),t.prototype.render=function(){var e=u._("The %(team_name)s team will be permanently deleted and all members will be removed. Your team’s folders will be converted to shared folders, nested shared folders will be flattened and your %(team_name)s groups will be deleted. Every member’s account will be converted to a personal Dropbox.").format({team_name:this.props.teamName});return o.createElement(a.Modal,{title:u._("Delete team?"),acceptButtonText:u._("Delete"),dismissButtonText:u._("Cancel"),submitting:this.state.submitting,acceptButtonDisabled:this.state.submitting,dismissButtonDisabled:this.state.submitting,autoClose:!1,onAccept:this._onAccept},e)},t.displayName="DeleteTeamModal",t.propTypes={teamName:m.string.isRequired,teamId:m.number.isRequired},t})(o.Component);t.DeleteTeamModal=d}),define("modules/clean/teams/modals/leave_group_modal",["require","exports","tslib","external/react","modules/clean/teams/admin/modals/action_utility_modal","modules/clean/components/modals/show_modal","modules/core/i18n","modules/clean/viewer","modules/clean/teams/admin/modals/modal_ajax","modules/clean/react_format"],function(e,t,r,o,s,a,n,i,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LeaveGroupModal=function(e){var t=(e.groupId,e.groupName),r=(e.userId,e.onRequestClose),a=void 0===r?function(){}:r,i=e.onPrimaryAction,u=void 0===i?function(){}:i,m=e.onSecondaryAction,p=void 0===m?function(){}:m,d=n._("Leave “%(group_name)s”?").format({group_name:t}),c=n._("Leave"),g=l.reactFormat(n._("<paragraph>Leaving “%(group_name)s” will cause you to lose access to folders that have been shared with the group.</paragraph > <paragraph>It might take a little while to remove you from all of the group’s shared folders.</paragraph> <paragraph>Are you sure you want to leave the group?</paragraph>"),{paragraph:o.createElement("p",null),group_name:t});return o.createElement(s.ActionUtilityModal,{title:d,primaryAction:c,onPrimaryAction:u,onSecondaryAction:p,onRequestClose:a},g)},t.LEAVE_GROUP_URL="/groups_ajax/remove_user_from_group",t.LeaveGroupModalActionWithoutCSS=function(e){var o=e.groupId,s=e.groupName,a=e.userId,l=r.__rest(e,["groupId","groupName","userId"]);return u.modalAjax({modal:t.LeaveGroupModal,ajax:{url:t.LEAVE_GROUP_URL,data:{group_id:o,user_id:a},subject_user:i.Viewer.get_viewer().work_user},notify:{successNotify:n._("Leaving group...")}})(r.__assign({groupId:o,groupName:s,userId:a},l))},t.LeaveGroupModalAction=t.LeaveGroupModalActionWithoutCSS,t.showLeaveGroupModal=function(e){return a.showModal(o.createElement(t.LeaveGroupModalAction,r.__assign({},e)))}}),define("modules/clean/teams/modals/leave_team_modal",["require","exports","tslib","external/react","modules/clean/ajax","modules/clean/react/modal","modules/clean/viewer","modules/core/browser","modules/core/i18n","modules/core/notify","modules/clean/teams/modals/sole_admin_warning_modal"],function(e,t,r,o,s,a,n,i,u,l,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=o.DOM,d=o.PropTypes,c=n.Viewer.get_viewer(),g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={submitting:!1},t.onAccept=function(){return t.setState({submitting:!0}),s.WebRequest({url:"/team/manage/leave",data:{user_id:c.work_user.id},complete:function(){return t.setState({submitting:!1})},success:function(){return l.success(u._("You left the team.")),i.redirect("/team")}})},t}return r.__extends(t,e),t.prototype.render=function(){var e;return e=this.props.canHaveAdminUi?u._("You’ll lose access to all %(team_name)s groups. Your account will be converted to a personal Dropbox.").format({team_name:this.props.teamName}):u._("You’ll lose access to the %(team_name)s team folder and all %(team_name)s groups. Your account will be converted to a personal Dropbox.").format({team_name:this.props.teamName}),o.createElement(a.Modal,{title:u._("Leave team?"),acceptButtonText:u._("Leave team"),dismissButtonText:u._("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},e)},t.displayName="LeaveTeamModal",t.propTypes={teamName:d.string,canHaveAdminUi:d.bool},t})(o.Component);t.LeaveTeamModal=g;var _=(function(e){function t(){
var t=null!==e&&e.apply(this,arguments)||this;return t.showLeaveTeamModal=function(){return t.props.showWarningOnLeaveTeam?m.showSoleAdminWarningModal({teamName:t.props.teamName,action:"leave"}):a.Modal.showInstance(o.createElement(g,{teamName:t.props.teamName,canHaveAdminUi:t.props.canHaveAdminUi}))},t}return r.__extends(t,e),t.prototype.render=function(){return p.button({className:"leave-team-button",onClick:this.showLeaveTeamModal},u._("Leave team"))},t.displayName="LeaveTeamButton",t.propTypes={teamName:d.string,showWarningOnLeaveTeam:d.bool,canHaveAdminUi:d.bool},t})(o.Component);t.LeaveTeamButton=_}),define("modules/clean/teams/modals/sole_admin_warning_modal",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/teams/admin/modals/alert_utility_modal","modules/clean/components/modals/show_modal"],function(e,t,r,o,s,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SoleAdminWarningModal=function(e){var t=e.teamName,r=e.action,n=e.onPrimaryAction,i=void 0===n?function(){}:n,u=e.onRequestClose,l=void 0===u?function(){}:u,m=s._("You must give admin permissions to someone else"),p=s._("I understand"),d="leave"===r?s._("Since you’re the only admin of %(team_name)s, you need to give someone else on your team admin permissions before you leave the team. You can do this by clicking the gear icon to the right of a team member’s name and selecting “Give admin permissions”.").format({team_name:t}):s._("In order to remove your admin permissions, you must first give admin permissions to someone else on your team. You can do this by clicking the gear icon to the right of a team member’s name and selecting “Give admin permissions”.");return o.createElement(a.AlertUtilityModal,{title:m,primaryAction:p,width:"698px",onPrimaryAction:i,onRequestClose:l},d)},t.showSoleAdminWarningModal=function(e){return n.showModal(t.SoleAdminWarningModal(r.__assign({},e)))}}),define("modules/clean/teams/team_maestro_page_base",["require","exports","tslib","external/react","modules/clean/react/tabs/tab_util","modules/core/i18n","modules/clean/viewer","modules/clean/react/maestro/header","modules/clean/react/maestro/tabs","modules/clean/teams/admin/maestro/admin_console_actions_view","modules/clean/components/loading_indicator","modules/core/browser","modules/clean/react/maestro/layout","modules/clean/react/sprite","external/classnames","modules/clean/web_timing_logger","modules/clean/deferred_loader","modules/core/notify"],function(e,t,r,o,s,a,n,i,u,l,m,p,d,c,g,_,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=(function(t){function b(r){var o=t.call(this,r)||this;return o.myGroups=[],o.teamGroups=[],o.requireTeamPage=function(){e(["modules/clean/teams/team_page"],function(e){return o.setState({teamPageElement:e.TeamPage})})},o.requireGroupsPage=function(){e(["modules/clean/groups/groups_page"],function(e){return o.setState({groupsPageElement:e})})},o._setSingleGroupInfo=function(e){o.setState({activeGroup:e})},o.state={activeGroup:null,teamPageElement:r.initTeamPageElement,groupsPageElement:r.initGroupsPageElement,initialDataLoading:!0},o._setupDataPrefetchCallbacks(),o}return r.__extends(b,t),b.prototype._setupDataPrefetchCallbacks=function(){this._setupMembersPrefetchCallbacks(),this._setupGroupsPrefetchCallbacks()},b.prototype._setupMembersPrefetchCallbacks=function(){var e=this;if(window.__REGISTER_TEAM_MEMBERS_PRELOAD_HANDLER){var t=function(t){try{var r=JSON.parse(t);_.log_js_modules_fetched_data_required_for_tti(),e.initTeamMembersDataDict={rows:r.members,total:r.total_members,numJoinRequests:r.num_join_requests},e.setState({initialDataLoading:!1})}catch(e){f.error(a._("An error occured. Please reload the page."))}},r=function(){return f.error(a._("An error occured. Please reload the page."))};window.__REGISTER_TEAM_MEMBERS_PRELOAD_HANDLER(t,r)}},b.prototype._setupGroupsPrefetchCallbacks=function(){var e,t,r=this;window.__REGISTER_MY_GROUPS_PRELOAD_HANDLER&&(t=function(e){try{var t=JSON.parse(e);r.myGroups=t.groups,r.myGroupsTotal=t.total_groups,r._checkAndMarkGroupsDataFetchComplete()}catch(e){f.error(a._("An error occured. Please reload the page."))}},e=function(){return f.error(a._("An error occured. Please reload the page."))},window.__REGISTER_MY_GROUPS_PRELOAD_HANDLER(t,e)),window.__REGISTER_TEAM_GROUPS_PRELOAD_HANDLER&&(t=function(e){try{var t=JSON.parse(e);r.teamGroups=t.groups,r.teamGroupsTotal=t.total_groups,r._checkAndMarkGroupsDataFetchComplete()}catch(e){f.error(a._("An error occured. Please reload the page."))}},e=function(){return f.error(a._("An error occured. Please reload the page."))},window.__REGISTER_TEAM_GROUPS_PRELOAD_HANDLER(t,e))},b.prototype._checkAndMarkGroupsDataFetchComplete=function(){void 0!==this.myGroupsTotal&&void 0!==this.teamGroupsTotal&&(_.log_js_modules_fetched_data_required_for_tti(),this.initMyGroupsDataDict={rows:this.myGroups,total:this.myGroupsTotal},this.initTeamGroupsDataDict={rows:this.teamGroups,total:this.teamGroupsTotal},this.setState({initialDataLoading:!1}))},b.prototype.componentWillMount=function(){_.log_js_modules_application_code_start()},b.prototype.componentDidMount=function(){var t=this;_.waitForTTI().then(function(){t.props.mergedMembersAndGroups?t.requireGroupsPage():t.requireTeamPage(),e(["modules/clean/groups/switch_to_member_managed_group_modal","modules/clean/groups/create_group_modal","modules/clean/groups/simple_modals","modules/clean/teams/modals/leave_team_modal","modules/clean/react/modal","modules/clean/teams/modals/delete_group_modal","modules/clean/teams/modals/leave_group_modal","modules/clean/teams/modals/sole_admin_warning_modal"],function(e,t,r,o,s,a,n,i){var u=s.Modal,l=a.showDeleteGroupModal,m=n.showLeaveGroupModal,p=i.showSoleAdminWarningModal;h.deferredLoader.setItems({SwitchToMemberManagedGroupModal:e,CreateGroupModal:t,GroupModals:r,showDeleteGroupModal:l,showLeaveGroupModal:m,LeaveTeamModal:o.LeaveTeamModal,LeaveTeamAsSoleLimitedAdminWarningModal:o.LeaveTeamAsSoleLimitedAdminWarningModal,Modal:u,showSoleAdminWarningModal:p})})})},b.prototype._renderGroupsTab=function(){var e=this.initMyGroupsDataDict,t=this.initTeamGroupsDataDict;return this.initMyGroupsDataDict=void 0,this.initTeamGroupsDataDict=void 0,this.state.groupsPageElement?o.createElement(this.state.groupsPageElement,{ref:"groupsTab",isMaestroDesign:!0,canHaveAdminUi:this.props.canHaveAdminUi,groupControlledByAdmin:this.props.groupControlledByAdmin,teamName:this.props.viewer.team_name,isLimitedTeam:this.props.isLimitedTeam,insideAdminConsole:!1,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,sharedContentListEnabled:this.props.sharedContentListEnabled,onNewSingleGroup:this._setSingleGroupInfo,infiniteScroll:this.props.infiniteScroll,mergedMembersAndGroups:this.props.mergedMembersAndGroups,initialMyGroupsDataDict:e,initialTeamGroupsDataDict:t}):null},b.prototype._renderMembersTab=function(){var e=this.initTeamMembersDataDict;return this.initTeamMembersDataDict=void 0,this.state.teamPageElement?o.createElement(this.state.teamPageElement,{ref:"membersTab",isMaestroDesign:!0,teamName:this.props.viewer.team_name,teamFolderPathName:this.props.teamFolderPathName,members:this.props.members,teamIsAssumed:this.props.teamIsAssumed,totalMembers:this.props.totalMembers,totalRows:this.props.totalRows,numJoinRequests:this.props.numJoinRequests,isLimitedTeam:this.props.isLimitedTeam,canInviteMembers:this.props.canInviteMembers,canManageTeamMembership:this.props.canManageTeamMembership,canSuggestMembers:this.props.canSuggestMembers,canAccessAdminConsole:this.props.canAccessAdminConsole,canHaveAdminUi:this.props.canHaveAdminUi,canHaveLimitedAdminSettings:this.props.canHaveLimitedAdminSettings,canManageLimitedAdmins:this.props.canManageLimitedAdmins,viewerIsSoleAdmin:this.props.viewerIsSoleAdmin,infiniteScroll:this.props.infiniteScroll,inviteMemberEmails:this.props.inviteMemberEmails,mergedMembersAndGroups:this.props.mergedMembersAndGroups,openInviteModal:this.props.openInviteModal,openSuggestMembersModal:this.props.openSuggestMembersModal,openUploadModal:this.props.openUploadModal,onboardingModalVariant:this.props.onboardingModalVariant,adminOnboardingState:this.props.adminOnboardingState,teamMembersLimit:this.props.teamMembersLimit,enableMaxSizeExperiment:this.props.enableMaxSizeExperiment,showQuota:this.props.showQuota,enhancedGroupsEnabled:this.props.enhancedGroupsEnabled,teamIsCdm:this.props.teamIsCdm,initialDataDict:e}):null},b.prototype._refreshMembersAndGroupsPage=function(){this.props.mergedMembersAndGroups&&this.refs.membersTab.forceRefresh()},b.prototype._manageMembersClicked=function(){p.redirect("/team/admin/members")},b.prototype._manageGroupsClicked=function(){p.redirect("/team/admin/groups")},b.prototype._inviteMembersClicked=function(){this.refs.membersTab.onInviteClicked()},b.prototype._suggestMembersClicked=function(){this.refs.membersTab.onSuggestMembersClicked()},b.prototype._createGroupClicked=function(){var e=this;h.deferredLoader.getResolvedItems(["CreateGroupModal","Modal"]).then(function(t){var r=t.CreateGroupModal;t.Modal.showInstance(o.createElement(r,{teamName:e.props.viewer.team_name,isLimitedTeam:e.props.isLimitedTeam,canHaveAdminUi:e.props.canHaveAdminUi,insideAdminConsole:!1,enhancedGroupsEnabled:e.props.enhancedGroupsEnabled,onCreateCallback:function(){return e._refreshMembersAndGroupsPage()}}))})},b.prototype._renameGroupClicked=function(){this.refs.groupsTab.showRenameGroupModal()},b.prototype._deleteGroupClicked=function(){var e=this;h.deferredLoader.getResolvedItems(["showDeleteGroupModal"]).then(function(t){return(0,t.showDeleteGroupModal)({groupId:e.state.activeGroup.id,groupName:e.state.activeGroup.name,onPrimaryAction:function(){p.set_hash(e.props.mergedMembersAndGroups?"members":"groups"),e._refreshMembersAndGroupsPage()}})})},b.prototype._leaveGroupClicked=function(){var e=this;h.deferredLoader.getResolvedItems(["showLeaveGroupModal"]).then(function(t){return(0,t.showLeaveGroupModal)({groupId:e.state.activeGroup.id,groupName:e.state.activeGroup.name,userId:n.Viewer.get_viewer().work_user.id,onPrimaryAction:function(){p.set_hash(e.props.mergedMembersAndGroups?"members":"groups"),e._refreshMembersAndGroupsPage()}})})},b.prototype._makeGroupCompanyManagedClicked=function(){var e=this;h.deferredLoader.getResolvedItems(["GroupModals"]).then(function(t){t.GroupModals.showSwitchToAdminManagedGroupModal(e.state.activeGroup,!1,e.refs.groupsTab.refreshGroup)})},b.prototype._makeGroupUserManagedClicked=function(){var e=this;h.deferredLoader.getResolvedItems(["SwitchToMemberManagedGroupModal","Modal"]).then(function(t){var r=t.SwitchToMemberManagedGroupModal;t.Modal.showInstance(o.createElement(r,{group:e.state.activeGroup,onMemberManaged:e.refs.groupsTab.refreshGroup,insideAdminConsole:!1}))})},b.prototype._leaveTeamClicked=function(){var e=this;h.deferredLoader.getResolvedItems(["LeaveTeamModal","Modal","showSoleAdminWarningModal"]).then(function(t){var r=t.LeaveTeamModal,s=t.Modal,a=t.showSoleAdminWarningModal;e.props.showWarningOnLeaveTeam?a({teamName:e.props.viewer.team_name,action:"leave"}):s.showInstance(o.createElement(r,{teamName:e.props.viewer.team_name,canHaveAdminUi:e.props.canHaveAdminUi}))})},b.prototype._addGroupMembersClicked=function(){this.refs.groupsTab.showAddMembersModal()},b.prototype._renderSidebar=function(){return this.state.activeGroup?this._renderSidebarGroupView():this._renderSidebarMainView()},b.prototype._renderSidebarMainView=function(){var e,t=this,r=[],s=this.props.mergedMembersAndGroups;return this.props.isLimitedTeam?(s?(e={displayName:a._("Invite members"),handleClick:function(){return t._inviteMembersClicked()}},r.push({displayName:a._("Create group"),spriteName:"icon_new_group",handleClick:function(){return t._createGroupClicked()}})):(e={displayName:a._("Create group"),handleClick:function(){return t._createGroupClicked()}},r.push({displayName:a._("Invite members"),spriteName:"icon_invite_members",handleClick:function(){return t._inviteMembersClicked()}})),r.push({displayName:a._("Leave team"),spriteName:"icon_leave",handleClick:function(){return t._leaveTeamClicked()}})):s?(e=this.props.canAccessAdminConsole?{displayName:a._("Manage members"),handleClick:function(){return t._manageMembersClicked()}}:this.props.canSuggestMembers?{displayName:a._("Suggest members"),handleClick:function(){return t._suggestMembersClicked()}}:{displayName:a._("Invite members"),disabled:!0},r.push({displayName:a._("Create group"),spriteName:"icon_new_group",handleClick:function(){return t._createGroupClicked()},disabled:!this.props.canHaveAdminUi&&this.props.groupControlledByAdmin})):this.props.canAccessAdminConsole?(e={displayName:a._("Manage groups"),handleClick:function(){return t._manageGroupsClicked()}},r.push({displayName:a._("Manage members"),spriteName:"icon_invite_members",handleClick:function(){return t._manageMembersClicked()}})):(e={displayName:a._("Create group"),handleClick:function(){return t._createGroupClicked()},disabled:this.props.groupControlledByAdmin},r.push({displayName:a._("Suggest members"),spriteName:"icon_invite_members",handleClick:function(){return t._suggestMembersClicked()},disabled:!this.props.canSuggestMembers})),o.createElement(l.AdminConsoleActionsView,{primaryMenuItem:e,secondaryMenuItems:r})},b.prototype._renderSidebarGroupView=function(){var e=this,t=this.state.activeGroup;if(t.is_team_group)return null;var r=!t.is_admin_managed&&t.is_owner,s=this.props.canHaveAdminUi||r,n={displayName:a._("Add members"),handleClick:function(){return e._addGroupMembersClicked()},disabled:!s},i=[];s&&(i=[{displayName:a._("Rename group"),spriteName:"icon_rename",handleClick:function(){return e._renameGroupClicked()}},{displayName:a._("Delete group"),spriteName:"icon_delete",handleClick:function(){return e._deleteGroupClicked()}}]),this.props.canHaveAdminUi&&!this.props.isLimitedTeam&&(t.is_admin_managed?i.push({displayName:a._("Make user-managed"),spriteName:"gear",handleClick:function(){return e._makeGroupUserManagedClicked()}}):i.push({displayName:a._("Make company-managed"),spriteName:"gear",handleClick:function(){return e._makeGroupCompanyManagedClicked()}}));var u=this.props.canHaveAdminUi||!t.is_admin_managed&&!this.props.groupControlledByAdmin;return t.is_member&&u&&i.push({displayName:a._("Leave group"),spriteName:"icon_leave",handleClick:function(){return e._leaveGroupClicked()}}),o.createElement(l.AdminConsoleActionsView,{primaryMenuItem:n,secondaryMenuItems:i})},b.prototype._getTitleElement=function(){var e=this.props.viewer.team_name;if(this.state.activeGroup){var t=this.props.mergedMembersAndGroups?"#members":"#groups";return o.createElement(i.MaestroHeaderTitle,null,o.createElement("span",{className:"team-title-with-group-view"},o.createElement("a",{className:"team-name",href:t},e),o.createElement(c,{className:"team-name-separator",group:"web",name:"chevron",alt:a._("right-arrow")}),o.createElement("span",{className:"group-name"},this.state.activeGroup.name)))}return o.createElement(i.MaestroHeaderTitle,null,e)},b.prototype._getTabsClass=function(){return g({"hidden-tab-bar":null!==this.state.activeGroup||this.props.mergedMembersAndGroups})},b.prototype._renderAppBody=function(){var e,t=o.createElement(u.TabContent,{id:"team-tab-members",title:a._("Members"),hashURL:"members"},this._renderMembersTab());return e=this.props.mergedMembersAndGroups?o.createElement(u.TabContent,{id:"team-tab-groups",title:a._("Groups"),hashPrefix:"groups/g"},this._renderGroupsTab()):o.createElement(u.TabContent,{id:"team-tab-groups",title:a._("Groups"),hashURL:"groups",hashPrefix:"groups"},this._renderGroupsTab()),this.props.mergedMembersAndGroups?o.createElement("div",{className:"maestro-team-page-content"},o.createElement(u.Tabs,{className:this._getTabsClass(),variant:s.TabVariant.UNDERLINE},t,e)):o.createElement("div",{className:"maestro-team-page-content"},o.createElement(u.Tabs,{className:this._getTabsClass(),variant:s.TabVariant.UNDERLINE},e,t))},b.prototype.render=function(){if(this.state.initialDataLoading){var e=o.createElement(m.LoadingIndicator,{style:m.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER,className:"maestro-loading-spinner"});return o.createElement("div",{className:"maestro-loading-spinner-wrapper"},e)}var t=this.props.viewer,r=t.work_user;return o.createElement(d.MaestroChrome,{user:r,titleRegion:this._getTitleElement(),embeddedAppRegion:this._renderAppBody(),actionSidebarRegion:this._renderSidebar()})},b.displayName="TeamMaestroPage",b.defaultProps={viewer:n.Viewer.get_viewer()},b})(o.Component);t.TeamMaestroPageBase=b,t.TeamMaestroPageCss=["/static/css/scooter/scooter-scoped-vflhQ6850.css","/static/css/sharing/maestro-layout-vflvEmc2B.css","/static/css/teams/team_maestro_page-vflAbBKFw.css","/static/css/legacy_packages/components-vflC9ETTX.css","/static/css/react/table-vflkFXmsd.css"]}),define("modules/clean/teams/team_maestro_page_merged",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/teams/team_maestro_page_base","modules/clean/teams/team_page"],function(e,t,r,o,s,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return o.createElement(a.TeamMaestroPageBase,r.__assign({},e,{initTeamPageElement:n.TeamPage}))};t.TeamMaestroPageMerged=s(i,a.TeamMaestroPageCss)}),define("modules/clean/teams/team_maestro_page_tabbed",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/teams/team_maestro_page_base","modules/clean/groups/groups_page"],function(e,t,r,o,s,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return o.createElement(a.TeamMaestroPageBase,r.__assign({},e,{initGroupsPageElement:n}))};t.TeamMaestroPageTabbed=s(i,a.TeamMaestroPageCss)}),define("modules/clean/teams/team_page",["require","exports","external/classnames","external/create-react-class","external/react","jquery","modules/clean/ajax","modules/clean/analytics","modules/clean/avatar/avatar_with_default","modules/clean/avatar/group_avatar","modules/clean/avatar/initials_avatar","modules/clean/deferred_loader","modules/clean/pagelet_logger","modules/clean/react/bubble_menu","modules/clean/react/button","modules/clean/react/table","modules/clean/react/title_bubble","modules/clean/static_urls","modules/clean/teams/constants_team","modules/clean/viewer","modules/clean/web_timing_logger","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/core/user_i18n"],function(e,t,r,o,s,a,n,i,u,l,m,p,d,c,g,_,h,f,b,v,M,y,w,C,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=s.DOM,G=s.createElement,A=a.extend({},s.PropTypes),E={};E[b.USER_TYPES.PENDING_TEAM_ADMIN]=w._("Team Admin"),E[b.USER_TYPES.PENDING_ACCOUNTS_ADMIN]=w._("User Management Admin"),E[b.USER_TYPES.PENDING_SUPPORT_ADMIN]=w._("Support Admin"),E[b.USER_TYPES.PENDING_MEMBER]=w._("Member"),E[b.USER_TYPES.TEAM_ADMIN]=w._("Team Admin"),E[b.USER_TYPES.ACCOUNTS_ADMIN]=w._("User Management Admin"),E[b.USER_TYPES.SUPPORT_ADMIN]=w._("Support Admin"),E[b.USER_TYPES.MEMBER]=w._("Member"),E[b.USER_TYPES.SUSPENDED]=w._("Suspended"),E[b.USER_TYPES.REMOVED]=w._("Removed");var P=function(e,t){var r={};for(var o in e){var s=e[o];r[o]=s.bind(t)}return r},R=function(e){return e.team_join_state===b.JOIN_STATES.ACTIVE};t.TeamPage=o({displayName:"TeamPage",pageletLogger:new d.PageletLogger("team",["TeamPage"]),propTypes:{members:A.array,totalMembers:A.number,totalRows:A.number,numJoinRequests:A.number,teamName:A.string,teamFolderPathName:A.string,isLimitedTeam:A.bool,canManageTeamMembership:A.bool,canHaveAdminUi:A.bool,canHaveLimitedAdminSettings:A.bool,canManageLimitedAdmins:A.bool,viewerIsSoleAdmin:A.bool,inviteMemberEmails:A.arrayOf(A.string),openInviteModal:A.bool,openSuggestMembersModal:A.bool,adminOnboardingState:A.number,teamMembersLimit:A.number,mergedMembersAndGroups:A.bool,viewer:A.instanceOf(v.Viewer),infiniteScroll:A.bool,teamIsCdm:A.bool,initialDataDict:A.object},getDefaultProps:function(){return{viewer:v.Viewer.get_viewer()}},getInitialState:function(){return{totalMembersListLength:this.props.totalMembers,numJoinRequests:this.props.numJoinRequests,visibleMembers:this.props.members,managedUser:null,onboardingState:this.props.adminOnboardingState+1}},_renderStorageUsed:function(e){if(null!=e.used_raw_bytes&&null!=e.quota_raw_bytes){var t=Math.round(100*e.used_raw_bytes/e.quota_raw_bytes),o=w.format_percent(t),s=w._("%(storage_used)s of %(quota)s used");return S.div({className:r("member-storage-used",{"over-quota-member":t>=100,"near-quota-member":t>=90&&t<100})},t>=90?S.span({className:"quota-alert"},String.fromCharCode("8226")):void 0,G(h.TitleBubble,{content:s.format({storage_used:e.storage_used,quota:e.quota}),position:h.TitleBubble.POSITIONS.BOTTOM,distanceFromTarget:8},S.div({},o)))}return e.storage_used||"-"},columnTypes:{displayName:function(e,t,r){var o=this;return{field:"display_name_lower",header:w._("Name"),classes:{"display-name-column":!0},width:e,render:function(e){if(e.is_group){var s=e;return[S.div({className:"avatar-wrapper"},G(l,{group:s,dimension:t,optionalClass:r})),S.div({className:"user-info"},S.p({className:"user-info__text"},s.display_name),S.p({className:"user-info__subtext"},(function(){if(s.is_team_group||s.is_admin_managed)return o.props.teamName;if(s.owner_display_names.length<1)return"";var e=s.owner_display_names[0];return 1===s.user_count?e:w._("%(name)s and %(other_member_count)s more").format({name:e,other_member_count:s.user_count-1})})()))]}var a=e,n=G(u,{dimension:t,photoUrl:a.account_photo_url,optionalClass:r,defaultAvatar:G(m.InitialsAvatarWithColorDerivedFromName,{dimension:t,name:a.display_name||a.email,initials:N.getInitials(a.display_name||a.email),shape:"CIRCLE",optionalClass:r})});return[S.div({className:"avatar-wrapper"},n),S.div({className:"user-info"},S.p({className:"user-info__text"},a.display_name||w._("Invited")),S.p({className:"user-info__subtext"},a.email))]}}},userType:function(e){var t=this;return{field:"user_type",header:w._("Status"),width:e,render:function(e){return S.span({className:"member-user-type"},(function(){if(e.is_group)return w._("Group");if(!t.props.isLimitedTeam&&!t.props.mergedMembersAndGroups)return E[e.user_type];if(e.is_admin)return w._("Admin");if(e.join_request_status)switch(e.join_request_status){case b.JOIN_REQUEST_STATUS.PENDING:return w._("Pending member");case b.JOIN_REQUEST_STATUS.APPROVED:return w._("Approved")}else switch(e.team_join_state){case b.JOIN_STATES.ACTIVE:return w._("Member");case b.JOIN_STATES.PENDING:return w._("Invited");case b.JOIN_STATES.SUSPENDED:return w._("Suspended");case b.JOIN_STATES.REMOVED:return w._("Removed");default:return w._("Invalid")}})())}}},storageUsed:function(e){var t;return t=this.props.teamIsCdm?w._("Member folder usage"):w._("Space used"),{field:"storage_used",header:t,width:e,classes:{"storage-used-column":!0},initialSortDir:_.DESC_DIR,render:this._renderStorageUsed}},approveUser:function(e){var t=this;return{width:e,classes:{"approve-request-column":!0},sortable:!1,render:function(e){return e.join_request_status===b.JOIN_REQUEST_STATUS.PENDING&&t.props.canManageTeamMembership?G(g.button,{importance:"primary",className:"action-button approve-button",onClick:t.onApproveRequest.bind(t,e)},w._("Approve")):""}}},adminManagement:function(e){var t=this;return{width:e,classes:{"limited-admin-management-col":!0},sortable:!1,render:function(e){return e.is_group?"":t.props.canHaveLimitedAdminSettings?t.adminGear(e):t.removeUserButton(e)}}},joinedDate:function(e){return{field:"team_joined_utc_ts",header:w._("Joined"),width:e,render:function(e){return e.joined||"—"}}},joinGroup:function(e){var t=this;return{width:e,classes:{"join-group-col":!0},sortable:!1,render:function(e){if(!e.is_group||e.is_group_member||t.props.canHaveAdminUi||0===e.owner_display_names.length)return"";var r=e.pending_group_req;return r?S.button({className:"button-secondary button-small pending-group-button",disabled:!0},w._("Membership pending")):S.button({className:"button-secondary button-small join-group-button",onClick:t.onClickJoinGroup.bind(t,e),disabled:r},w._("Ask to join"))}}}},adminGear:function(e){var t=this,o=String.fromCharCode("176"),s=S.button({className:r("limited-admin-settings-button",{"menu-open-for-button":this.state.managedUser===e})},o+o+o),a=[];return e.user_id===this.props.viewer.work_user.id?this.props.canManageLimitedAdmins&&a.push(G(c.BubbleMenuItem,{onClick:this.onChangeAdminPermission.bind(this,e)},w._("Remove my admin permissions"))):(this.props.canManageTeamMembership&&a.push(G(c.BubbleMenuItem,{onClick:this.onRemoveMember.bind(this,e)},w._("Remove member"))),this.props.canManageLimitedAdmins&&R(e)&&(e.is_admin?a.push(G(c.BubbleMenuItem,{onClick:this.onChangeAdminPermission.bind(this,e)},w._("Remove admin permissions"))):a.push(G(c.BubbleMenuItem,{onClick:this.onChangeAdminPermission.bind(this,e)},w._("Make admin"))))),G(c.BubbleMenu,{position:c.BubbleMenu.POSITIONS.BOTTOM_LEFT,targetButton:s,items:a,shouldShowArrow:!1,verticalDisplacement:-4,onShowDropdown:function(){return t.setState({managedUser:e})},onHideDropdown:function(){return t.setState({managedUser:null})}})},removeUserButton:function(e){return e.user_id!==this.props.viewer.work_user.id&&this.props.canManageTeamMembership?S.a({className:"remove-user-button",onClick:this.onRemoveMember.bind(this,e)},S.img({src:"/static/images/x-vflYKfRuL.png"})):""},checkTTI:function(){if(this.props.mergedMembersAndGroups)return this.pageletLogger.componentReady(this.constructor.displayName)},componentWillMount:function(){this.columnTypes=P(this.columnTypes,this)},componentDidMount:function(){var t=this;return this.checkTTI(),this.props.openInviteModal?this.showInviteModal(this.props.inviteMemberEmails):this.props.openSuggestMembersModal&&this.showSuggestMembersModal(),M.waitForTTI().then(function(){if(!t.state.modalsLoaded)return t.setState({modalsLoaded:!0}),e(["modules/clean/react/modal","modules/clean/teams/limited_team_invite_modal","modules/clean/contacts/contact","modules/clean/contacts/types","modules/clean/teams/modals/leave_team_modal","modules/clean/teams/suggest_invites_modal","modules/clean/teams/limited_team_tooltips","modules/clean/teams/admin/widgets/admin_permissions_modal/admin_permissions_modal","modules/clean/teams/admin/widgets/remove_user_for_limited_team_modal/remove_user_for_limited_team_modal","modules/clean/teams/modals/sole_admin_warning_modal"],function(e,r,o,s,a,n,i,u,l,m){var d=e.Modal,c=o.Contact,g=a.LeaveTeamModal,_=u.showAdminPermissionsModal,h=l.showRemoveUserForLimitedTeamModal,f=m.showSoleAdminWarningModal;return p.deferredLoader.setItems({Modal:d,LimitedTeamInviteModal:r,Contact:c,ContactTypes:s,LeaveTeamModal:g,SuggestInvitesModal:n,showAdminPermissionsModal:_,showRemoveUserForLimitedTeamModal:h,showSoleAdminWarningModal:f}),t.setState({LimitedTeamTooltipsElement:i})})})},componentDidUpdate:function(){return this.checkTTI()},tableRowClasses:function(e){return e.is_group?this.props.canHaveAdminUi||e.is_group_member?{"clickable-group-row":!0}:{}:e.join_request_status===b.JOIN_REQUEST_STATUS.PENDING?{"pending-member-row":!0}:{}},renderMemberTable:function(){var e,t=this,r="u-mar-left-s u-mar-right-s";return e=this.props.isLimitedTeam?this.props.canManageTeamMembership?[this.columnTypes.displayName("40%",32,r),this.columnTypes.userType("19%"),this.columnTypes.storageUsed("16%"),this.columnTypes.approveUser("15%"),this.columnTypes.adminManagement("10%")]:[this.columnTypes.displayName("50%",32,r),this.columnTypes.userType("22%"),this.columnTypes.joinGroup("28%")]:[this.columnTypes.displayName("50%",32,r),this.columnTypes.userType("20%"),this.columnTypes.joinGroup("30%")],G(_,{ref:"members",columns:e,initialData:this.props.initialDataDict,initialSortColumn:1,rowsPerPage:20,emptyMessage:w._("No members here"),infiniteScroll:this.props.infiniteScroll,rowsPerRequestForInfiniteScroll:50,classes:{"grey-style":!0},rowClasses:this.tableRowClasses,paginatorClasses:"u-mar-top-xs",loadingIndicator:f.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),onRowClicked:this.onRowClicked,onRequestData:function(e,r){return n.WebRequest({url:"/team/manage/list",data:{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,include_groups:t.props.mergedMembersAndGroups?1:void 0},success:function(e){return e=JSON.parse(e),r(null,{rows:e.members,total:e.total_rows}),t.onTeamMembersUpdated(e.members,e.total_members,e.num_join_requests)}})}})},onRemoveMember:function(e){var t,r=this;return e.user_id===this.props.viewer.work_user.id?(t=p.deferredLoader.getResolvedItems(["Modal","LeaveTeamModal"]),t.then(function(e){var t=e.Modal,o=e.LeaveTeamModal;return t.showInstance(G(o,{teamName:r.props.teamName}))})):e.join_request_status===b.JOIN_REQUEST_STATUS.PENDING?n.WebRequest({url:"/team/join_request/reject",data:{user_id:e.user_id},success:function(){return C.success(w._("Membership request removed.")),r.refs.members.forceRefresh()}}):p.deferredLoader.getItem("showRemoveUserForLimitedTeamModal").then(function(t){return t({teamName:r.props.teamName,userId:e.user_id,displayName:e.display_name,email:e.email,fName:e.fname,isAdmin:e.is_admin,isActive:e.team_join_state===b.JOIN_STATES.ACTIVE,joinRequestStatus:e.join_request_status,onPrimaryAction:function(){return y.reload()}})})},onChangeAdminPermission:function(e){var t=this;if(e.is_admin&&this.props.viewerIsSoleAdmin){return p.deferredLoader.getItem("showSoleAdminWarningModal").then(function(e){return e({teamName:t.props.teamName,action:"revoke"})})}return p.deferredLoader.getItem("showAdminPermissionsModal").then(function(r){return r({userId:e.user_id,displayName:e.display_name||e.email,enablePermissions:!e.is_admin,limited:!0,team_id:t.props.viewer.team_id,removeOwnPermission:e.user_id===v.Viewer.get_viewer().work_user.id,onPrimaryAction:function(){return y.reload()}})})},onApproveRequest:function(e){var t=this;return n.WebRequest({url:"/team/join_request/approve",data:{user_id:e.user_id},success:function(){return C.success(w._("Membership request approved.")),t.refs.members.forceRefresh()}})},onInviteClicked:function(){i.TeamsWebActionsLogger.log("clicked_invite_members_cta",{},null,null,!1,i.TeamsWebActionsLogger.LOG_CATEGORY.TEAM_INFO),this.showInviteModal()},onSuggestMembersClicked:function(){i.TeamsWebActionsLogger.log("clicked_suggest_members_cta"),this.showSuggestMembersModal()},onRowClicked:function(e){if(e.is_group&&(this.props.canHaveAdminUi||e.is_group_member))return window.location.hash="groups/"+e.group_id},onClickJoinGroup:function(e,t){var r=this;return t.stopPropagation(),n.WebRequest({url:"/groups_ajax/make_group_join_request",data:{group_id:e.group_id},subject_user:this.props.viewer.work_user,success:function(){return e.pending_group_req=!0,r.forceUpdate(),C.success(w._("Request sent."))}})},showInviteModal:function(e){var t=this;if(void 0===e&&(e=[]),this.props.isLimitedTeam){return p.deferredLoader.getResolvedItems(["Modal","LimitedTeamInviteModal","Contact","ContactTypes"]).then(function(r){var o=r.Modal,s=r.LimitedTeamInviteModal,a=r.Contact,n=r.ContactTypes;return o.showInstance(G(s,{onInvited:function(){return t.refs.members.forceRefresh()},populatedContacts:e.map(function(e){return new a({type:n.EMAIL,email:e})}),maxTeamSize:t.props.teamMembersLimit}))})}var r={};return e.length>0&&btoa?r.invite_emails=btoa(e.join(",")):r.show_invite_members=1,y.redirect(new T({path:"/team/admin/members",query:r}))},showSuggestMembersModal:function(){return p.deferredLoader.getResolvedItems(["Modal","SuggestInvitesModal"]).then(function(e){var t=e.Modal,r=e.SuggestInvitesModal;return t.showInstance(G(r))})},onTeamMembersUpdated:function(e,t,r){return this.setState({totalMembersListLength:t,numJoinRequests:r,visibleMembers:e})},numRemainingInvites:function(){return this.props.teamMembersLimit-(this.state.totalMembersListLength-this.state.numJoinRequests)},forceRefresh:function(){this.refs.members.forceRefresh()},
onLastTooltipDismissed:function(e){this.setState({onboardingState:e})},renderTooltips:function(){if(b.ADMIN_ONBOARDING_STATES.TEAM_TAB_TOOLTIP<this.state.onboardingState&&this.state.onboardingState<b.ADMIN_ONBOARDING_STATES.DONE&&this.state.LimitedTeamTooltipsElement)return G(this.state.LimitedTeamTooltipsElement,{onboardingState:this.state.onboardingState,lastTooltipDismissedCb:this.onLastTooltipDismissed})},render:function(){return S.div({className:r("members-page","u-mar-top-l")},this.renderMemberTable(),this.renderTooltips())}})});
//# sourceMappingURL=pkg-team.min.js-vflOJxVHa.map