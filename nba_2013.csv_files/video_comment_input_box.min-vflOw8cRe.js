define(["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/video_annotations_prototype/video_annotation_prototype_helper","modules/clean/video_annotations_prototype/video_preview_event_emitter","modules/clean/video_annotations_prototype/constants","modules/clean/video_annotations_prototype/components/time_button","external/react-dom","modules/clean/video_annotations_prototype/components/avatar"],function(e,t,n,o,i,a,s,r,l,d,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=a.VideoAnnotationPrototypeHelper.unitConvertSecondsToDomainObjectTime,p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={text:"",frameTime:0,shouldShowPostButton:!1},t.handleVideoToggled=function(e,n){t.setState({frameTime:e,videoLength:n})},t.handleVideoTimeUpdated=function(e,n){t.setState({frameTime:e,videoLength:n})},t.handlePostClick=function(){var e=t.state,n=e.text,o=e.frameTime,i=t.props,a=i.user,s=i.addComment;a&&null!=o&&s&&(s({comment_text:n,comment_metadata:{frame_time:c(o)}}),t.clearTextInput(),t.setState({text:"",shouldShowPostButton:!1}))},t.handleCancel=function(){var e=t.props.isReply;t.clearTextInput(),e?(t.setState({text:""}),t.props.cancelReply()):t.setState({text:"",shouldShowPostButton:!1})},t.handleChange=function(e){var n;n=t.shouldShowFrameTime?e.target.lastChild.data:e.target.innerText,s.videoPreviewEventEmitter.emit(r.EventTypes.PAUSE),t.setState({text:n,shouldShowPostButton:""!==n})},t.onInputBoxClicked=function(){t.props.isReply||s.videoPreviewEventEmitter.emit(r.EventTypes.PAUSE)},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){s.videoPreviewEventEmitter.addListener(r.EventTypes.VIDEO_TOGGLED,this.handleVideoToggled),s.videoPreviewEventEmitter.addListener(r.EventTypes.VIDEO_TIME_UPDATED,this.handleVideoTimeUpdated)},t.prototype.componentWillUnmount=function(){s.videoPreviewEventEmitter.removeListener(r.EventTypes.VIDEO_TOGGLED,this.handleVideoToggled),s.videoPreviewEventEmitter.removeListener(r.EventTypes.VIDEO_TIME_UPDATED,this.handleVideoTimeUpdated)},t.prototype.componentDidUpdate=function(){this.shouldShowFrameTime&&(d.findDOMNode(this.refs.content).focus(),window.getSelection().modify("move","forward","word"))},Object.defineProperty(t.prototype,"shouldShowFrameTime",{get:function(){var e=this,t=e.props.isReply,n=e.state.videoLength;return!t&&void 0!==n},enumerable:!0,configurable:!0}),t.prototype.clearTextInput=function(){var e=d.findDOMNode(this.refs.content),t=e.childNodes.length,n=this.shouldShowFrameTime?t-1:0;e.removeChild(e.childNodes[n])},t.prototype.render=function(){var e=this.state,t=e.text,n=e.frameTime,i=e.videoLength,a=e.shouldShowPostButton,s=this.props,r=s.isReply,d=s.user,c=r?"Reply":"Write a comment",p=d&&o.createElement(m.CommenterAvatar,{user:d}),u=(r||a)&&o.createElement("div",{className:"post-area post-area--post-text-shown"},o.createElement("div",{className:"post-text-container"},o.createElement("button",{className:"post-button button-as-link",onClick:this.handlePostClick},r?"Reply":"Post"),o.createElement("span",null," â€¢ "),o.createElement("button",{className:"button-as-link",onClick:this.handleCancel},"Cancel")));return o.createElement("div",{className:"comment-box"},o.createElement("div",{className:"commenter-photo"},p),o.createElement("div",{className:"mentions-container",ref:"container"},o.createElement("div",{className:"mentions-input",ref:"input"},o.createElement("div",{className:"text-input",contentEditable:!0,id:"text-input",ref:"content",onInput:this.handleChange,onClick:this.onInputBoxClicked,"data-placeholder":c,value:t},this.shouldShowFrameTime&&o.createElement("div",{className:"time-button-wrapper",contentEditable:!1},o.createElement(l.TimeButton,{time:n,videoLength:i})),"")),u),o.createElement("div",{className:"comment-input-buttons"}))},t})(o.Component),u=i(p,["/static/css/video_annotation_prototype-vflN3I_1v.css"]);t.VideoCommentInputBox=u});
//# sourceMappingURL=video_comment_input_box.min.js-vflxoYcz0.map