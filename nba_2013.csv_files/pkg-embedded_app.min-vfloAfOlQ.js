define("external/deep-freeze",["require","exports","module"],function(e,r,t){t.exports=function e(r){return Object.freeze(r),Object.getOwnPropertyNames(r).forEach(function(t){!r.hasOwnProperty(t)||null===r[t]||"object"!=typeof r[t]&&"function"!=typeof r[t]||Object.isFrozen(r[t])||e(r[t])}),r}}.bind(Object.create(null))),define("modules/clean/browse_uri_interface",["require","exports","modules/clean/viewer","modules/core/uri"],function(e,r,t,s){"use strict";function n(e){return t.Viewer.get_viewer().is_paired?"personal"===e.role?c+r.PERSONAL_ROOT:c+r.WORK_ROOT:c+r.HOME_ROOT}function a(e){c=e}function o(e,r){return"/"!==r.charAt(0)&&(r="/"+r),new s({scheme:"https",authority:"www.dropbox.com",path:c+"/preview"+r,query:{role:e.role}})}function i(e,r){return new s({scheme:"https",authority:"www.dropbox.com",path:""+n(e)+r})}Object.defineProperty(r,"__esModule",{value:!0}),r.HOME_ROOT="/home",r.WORK_ROOT="/work",r.PERSONAL_ROOT="/personal";var c="";r.get_browse_root=n,r.set_base_prefix=a,r.preview_uri_for_fq_path=o,r.browse_uri_for_fq_path=i}),define("modules/clean/filetypes",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e[e.FILE=1]="FILE",e[e.FOLDER=2]="FOLDER",e[e.PACKAGE=3]="PACKAGE",e[e.SHARED_FOLDER=4]="SHARED_FOLDER",e[e.SANDBOX=5]="SANDBOX",e[e.TEAM_SHARED_FOLDER=6]="TEAM_SHARED_FOLDER",e[e.TEAM_MEMBER_FOLDER=7]="TEAM_MEMBER_FOLDER"})(r.FileTypes||(r.FileTypes={}))}),define("modules/clean/immutability_helper",["require","exports","external/deep-freeze"],function(e,r,t){"use strict";function s(e){if(null==e)throw new TypeError("Cannot thaw null/undefined object");if(Array.isArray(e))return E.call(e);for(var r=Object.create(Object.getPrototypeOf(e)),t=Object.getOwnPropertyNames(e),s=0,n=t;s<n.length;s++){var a=n[s],o=Object.getOwnPropertyDescriptor(e,a);o&&(o.get||o.set)?(o.configurable=!0,Object.defineProperty(r,a,o)):r[a]=e[a]}return r}function n(e,r){var n=s(e);return r(n),t(n)}function a(e,r){if(!r||0===r.length)throw new TypeError("Invalid key path: "+JSON.stringify(r));return r.reduce(function(e,r){return null==e?null:e[r]},e)}function o(e,r,n){if(null==e)throw new TypeError("Object to `set` cannot be null");if(e[r]===n)return e;var a=s(e);return a[r]=n,t(a)}function i(e,r,t){return o(e,r,t(e[r]))}function c(e,r,t){if(!r||0===r.length)throw new TypeError("Invalid key path: "+JSON.stringify(r));if(null==e)throw new TypeError("Target object cannot be null");var s=r[0];return 1===r.length?i(e,s,t):o(e,s,c(e[s],r.slice(1),t))}function _(e,r,t){if(!r||0===r.length)throw new TypeError("Invalid key path: "+JSON.stringify(r));if(null==e)throw new TypeError("Target object cannot be null");var s=r[0];switch(r.length){case 1:return o(e,s,t);default:return o(e,s,_(e[s]||{},r.slice(1),t))}}function u(e,r){if(null==e||null==r)throw new TypeError("Both target and source cannot be null");var n=Object.keys(r).reduce(function(t,s){return r[s]!==e[s]&&t.push(s),t},[]);if(n.length){for(var a=s(e),o=0,i=n;o<i.length;o++){var c=i[o],_=Object.getOwnPropertyDescriptor(r,c);void 0!==_&&Object.defineProperty(a,c,_)}return t(a)}return e}function h(e,r,t){if(null==e||null==t)throw new TypeError("Both target and source cannot be null");return c(e,r,function(e){return u(e,t)})}function l(e,r,s){for(var n=[],a=3;a<arguments.length;a++)n[a-3]=arguments[a];var o=E.call(e);return o.splice.apply(o,[r,s].concat(n)),t(o)}function d(e){for(var r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];var n=E.call(e);return n.unshift.apply(n,r),t(n)}function p(e){for(var r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];var n=E.call(e);return n.push.apply(n,r),t(n)}Object.defineProperty(r,"__esModule",{value:!0});var E=Array.prototype.slice;r.thaw=s,r.withMutations=n,r.getIn=a,r.set=o,r.update=i,r.updateIn=c,r.setIn=_,r.merge=u,r.mergeIn=h,r.splice=l,r.unshift=d,r.push=p}),define("modules/clean/previews/constants",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e.Browse="BROWSE",e.SharedLinkFile="SHARED_LINK_FILE",e.SharedLinkFolder="SHARED_LINK_FOLDER",e.SharedLinkCollection="SHARED_LINK_COLLECTION",e.VersionHistory="VERSION_HISTORY"})(r.PathContext||(r.PathContext={}));(function(e){e.AdobeCS="adobecs",e.Archive="archive",e.Audio="audio",e.CloudDoc="cloud_doc",e.Doc="doc",e.Download="download",e.Excel="excel",e.HTML="html",e.iWork="iwork",e.Linkfile="linkfile",e.Photo="photo",e.Text="text",e.Video="video"})(r.PreviewType||(r.PreviewType={})),r.MAX_ARCHIVE_FILE_SIZE_B=536870912}),define("modules/clean/react/browse/constants",["require","exports","modules/core/i18n"],function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e[e.NotReady=0]="NotReady",e[e.NotLive=1]="NotLive",e[e.Live=2]="Live"})(r.BrowseBoltClientStatus||(r.BrowseBoltClientStatus={}));(function(e){e.INITIALIZE_EVERYTHING="INITIALIZE_EVERYTHING",e.LOAD_PATH="LOAD_PATH",e.CLEAR_FILES="CLEAR_FILES",e.ADD_FILES="ADD_FILES",e.ADD_FILES_AND_SET_LOADING_STATE="ADD_FILES_AND_SET_LOADING_STATE",e.SET_PATH="SET_PATH",e.SET_USER="SET_USER",e.SET_URL_PREFIX="SET_URL_PREFIX",e.SET_LOADING_STATE="SET_LOADING_STATE",e.SET_MOUNT_POINTS="SET_MOUNT_POINTS",e.SET_TEAM_FOLDERS="SET_TEAM_FOLDERS",e.CHANGE_FILES="CHANGE_FILES",e.SET_SELECTION="SET_SELECTION",e.SELECT_FILES_AFTER_UPLOAD="SELECT_FILES_AFTER_UPLOAD",e.SELECT_FILES_BY_FQ_PATH="SELECT_FILES_BY_FQ_PATH",e.SET_SHOULD_SHOW_DELETED_FILES="SET_SHOULD_SHOW_DELETED_FILES",e.SET_DROP_TARGET="SET_DROP_TARGET",e.SORT_FILES="SORT_FILES",e.SET_VIEW_TYPE="SET_VIEW_TYPE",e.SET_COPY_MODE="SET_COPY_MODE",e.COPY_FILES_TO_CLIPBOARD="COPY_FILES_TO_CLIPBOARD",e.REQUEST_NEW_FILE_NAME="REQUEST_NEW_FILE_NAME",e.CANCEL_FILE_RENAME="CANCEL_FILE_RENAME",e.SET_FILE_RENAME_PENDING="SET_FILE_RENAME_PENDING",e.SET_FILE_RENAME_COMPLETE="SET_FILE_RENAME_COMPLETE",e.REQUEST_FOLDER_NAME="REQUEST_FOLDER_NAME",e.CREATE_FOLDER_PENDING="CREATE_FOLDER_PENDING",e.CREATE_FOLDER_COMPLETE="CREATE_FOLDER_COMPLETE",e.CANCEL_CREATE_FOLDER="CANCEL_CREATE_FOLDER",e.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE="SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE",e.TEAM_FOLDER_DOWNGRADE="TEAM_FOLDER_DOWNGRADE",e.ADD_COMMENT_STATUS_BATCH="ADD_COMMENT_STATUS_BATCH",e.ADD_FILE_JUMP_KEY_CODE="ADD_FILE_JUMP_KEY_CODE",e.RESET_FILE_JUMP="RESET_FILE_JUMP",e.SET_ACTIVE_TAB="SET_ACTIVE_TAB",e.REQUEST_FETCH_FOLDER_SIZES="REQUEST_FETCH_FOLDER_SIZES",e.FETCHED_FOLDER_SIZES="FETCHED_FOLDER_SIZES",e.COMPLETE_FETCH_FOLDER_SIZES="COMPLETE_FETCH_FOLDER_SIZES",e.SET_COLUMN_DEPENDENT_CAPABILITIES="SET_COLUMN_DEPENDENT_CAPABILITIES",e.SET_TILES_PER_ROW="SET_TILES_PER_ROW",e.SET_COLUMN_CONFIGURATION="SET_COLUMN_CONFIGURATION"})(r.BrowseActionType||(r.BrowseActionType={}));(function(e){e.CREATE_FOLDER_INACTIVE="CREATE_FOLDER_INACTIVE",e.PENDING_INPUT="PENDING_INPUT",e.SAVING_INPUT="SAVING_INPUT"})(r.NewFolderCreationState||(r.NewFolderCreationState={}));(function(e){e.LOADED="LOADED",e.LOADING_FIRST_PAGE="LOADING_FIRST_PAGE",e.LOADING_REMAINING_PAGES="LOADING_REMAINING_PAGES"})(r.LoadingState||(r.LoadingState={}));(function(e){e.UP="UP",e.DOWN="DOWN"})(r.Direction||(r.Direction={})),r.BROWSE_FILE_VIEWER_ELEMENT_ID="browse-react-file-viewer-container";(function(e){e.FILENAME="FILENAME",e.MODIFIED="MODIFIED",e.CATEGORY="CATEGORY",e.EXTENSION="EXTENSION",e.SIZE="SIZE",e.SHARED_WITH="SHARED_WITH"})(r.BrowseSortField||(r.BrowseSortField={}));(function(e){e.FILENAME="FILES_BY_NAME",e.MODIFIED="FILES_BY_MODIFIED",e.CATEGORY="FILES_BY_CATEGORY",e.EXTENSION="FILES_BY_NAME",e.SIZE="FILES_BY_SIZE",e.SHARED_WITH="FILES_BY_NAME"})(r.BrowseSortLabel||(r.BrowseSortLabel={}));(function(e){e[e.FILENAME=0]="FILENAME",e[e.CATEGORY=1]="CATEGORY",e[e.EXTENSION=2]="EXTENSION",e[e.SHARED_WITH=3]="SHARED_WITH"})(r.BrowseSortIsFilename||(r.BrowseSortIsFilename={}));(function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"})(r.SortDirection||(r.SortDirection={}));(function(e){e.NONE="NONE",e.ALL_FOLDERS="ALL_FOLDERS",e.NONSELECTED_FOLDERS="NONSELECTED_FOLDERS",e.NONSELECTED_NONSHARED_FOLDERS="NONSELECTED_NONSHARED_FOLDERS",e.NONSELECTED_NONSHARED_NONTEAM_FOLDERS="NONSELECTED_NONSHARED_NONTEAM_FOLDERS"})(r.DropTargetHighlightMode||(r.DropTargetHighlightMode={}));var s={IMAGE:["bmp","cr2","gif","ico","jpeg","jpg","nef","png","psd","tif","tiff","svg","svgz"],VIDEO:["3gp","3gpp","3gpp2","avi","dv","flv","m2t","m4v","mkv","mov","mp4","mpeg","mpg","mts","ts","vob","wmv"],AUDIO:["aif","flac","m4a","m4p","mp3","ogg","wav","wma"],DOCUMENT:["ai","cdr","csv","doc","docx","docm","eps","fla","indd","keynote","numbers","otf","pages","pdf","ppt","pptx","pptm","pps","ppsx","ppsm","ps","rtf","swf","txt","wpd","xls","xlsx","xlsm"],COMPRESSED_FILE:["7z","bz2","gz","gzip","rar","tar","zip"],CODE:["as","as3","asm","aspx","bat","c","cc","cmake","coffee","cpp","cs","css","cxx","diff","erb","erl","groovy","gry","h","haml","hh","hpp","html","htm","hxx","java","js","json","jsx","less","lst","m","make","mk","ml","mm","msg","out","patch","php","pl","pm","plist","properties","py","rb","sass","scala","scm","script","scss","sh","sml","sql","vb","vi","vim","xhtml","xml","xsd","xsl","y","yaml","yml","yxx"],DISK_IMAGE:["dmg","iso"],EXECUTABLE:["exe"],SHORTCUT:["lnk"],LINK:["url","webloc"],FONT:["ttf"]};r.BrowseTileGridConstants={NUM_THRESHOLD_ROWS:10,SCROLL_DELTA_THRESHOLD:1},r.CulledListConstants={ITEM_ROW_HEIGHT_PX:46,MAESTRO_ITEM_ROW_HEIGHT_PX:57,SEARCH_ROW_HEIGHT_PX:53,MAESTRO_SEARCH_ROW_HEIGHT_PX:66,DEFAULT_HEADER_HEIGHT_PX:142,ITEM_BUFFER_SIZE:5};(function(e){e.CREATE_FOLDER_UI="CreateFolderUI",e.LOADING_INDICATOR="LoadingIndicator"})(r.ItemType||(r.ItemType={})),r.FileTypeCategoryTranslations={FILE:t._("File"),FOLDER:t._("Folder"),SHARED_FOLDER:t._("Shared folder"),TEAM_SHARED_FOLDER:t._("Team folder"),TEAM_MEMBER_FOLDER:t._("Member folder"),PUBLIC_FOLDER:t._("Folder"),IMAGE:t._("Image"),VIDEO:t._("Video"),AUDIO:t._("Audio"),DOCUMENT:t._("Document"),COMPRESSED_FILE:t._("Archive"),CODE:t._("Code"),DISK_IMAGE:t._("Disk image"),EXECUTABLE:t._("Executable"),SHORTCUT:t._("Shortcut"),LINK:t._("Link"),FONT:t._("Font"),SANDBOX:t._("App folder")},r.FileTypeCapitalizedCategoryTranslations={FILE:t._("FILE"),FOLDER:t._("FOLDER"),SHARED_FOLDER:t._("SHARED FOLDER"),TEAM_SHARED_FOLDER:t._("TEAM FOLDER"),TEAM_MEMBER_FOLDER:t._("MEMBER FOLDER"),PUBLIC_FOLDER:t._("FOLDER"),IMAGE:t._("IMAGE"),VIDEO:t._("VIDEO"),AUDIO:t._("AUDIO"),DOCUMENT:t._("DOCUMENT"),COMPRESSED_FILE:t._("ARCHIVE"),CODE:t._("CODE"),DISK_IMAGE:t._("DISK IMAGE"),EXECUTABLE:t._("EXECUTABLE"),SHORTCUT:t._("SHORTCUT"),LINK:t._("LINK"),FONT:t._("FONT"),SANDBOX:t._("APP FOLDER")},r.DeletedFileTypeCategoryTranslations={FILE:t._("Deleted file"),FOLDER:t._("Deleted folder"),SHARED_FOLDER:t._("Deleted shared folder"),TEAM_SHARED_FOLDER:t._("Deleted team folder"),TEAM_MEMBER_FOLDER:t._("Deleted member folder"),PUBLIC_FOLDER:t._("Deleted folder"),IMAGE:t._("Deleted image"),VIDEO:t._("Deleted video"),AUDIO:t._("Deleted audio"),DOCUMENT:t._("Deleted document"),COMPRESSED_FILE:t._("Deleted archive"),CODE:t._("Deleted code"),DISK_IMAGE:t._("Deleted disk image"),EXECUTABLE:t._("Deleted executable"),SHORTCUT:t._("Deleted shortcut"),LINK:t._("Deleted link"),FONT:t._("Deleted font"),SANDBOX:t._("Deleted app folder")},r.DeletedFileTypeCapitalizedCategoryTranslations={FILE:t._("DELETED FILE"),FOLDER:t._("DELETED FOLDER"),SHARED_FOLDER:t._("DELETED SHARED FOLDER"),TEAM_SHARED_FOLDER:t._("DELETED TEAM FOLDER"),TEAM_MEMBER_FOLDER:t._("DELETED MEMBER FOLDER"),PUBLIC_FOLDER:t._("DELETED FOLDER"),IMAGE:t._("DELETED IMAGE"),VIDEO:t._("DELETED VIDEO"),AUDIO:t._("DELETED AUDIO"),DOCUMENT:t._("DELETED DOCUMENT"),COMPRESSED_FILE:t._("DELETED ARCHIVE"),CODE:t._("DELETED CODE"),DISK_IMAGE:t._("DELETED DISK IMAGE"),EXECUTABLE:t._("DELETED EXECUTABLE"),SHORTCUT:t._("DELETED SHORTCUT"),LINK:t._("DELETED LINK"),FONT:t._("DELETED FONT"),SANDBOX:t._("DELETED APP FOLDER")},r.ExtensionCategories={};for(var n=0,a=Object.keys(s);n<a.length;n++)for(var o=a[n],i=s[o],c=0,_=i;c<_.length;c++){var u=_[c];r.ExtensionCategories[u]=o}(function(e){e.PENDING_INPUT="pending-input",e.SAVING_INPUT="saving-input"})(r.RenameState||(r.RenameState={}));(function(e){e[e.NONE=-1]="NONE",e[e.LEFT=0]="LEFT",e[e.MIDDLE=1]="MIDDLE",e[e.RIGHT=2]="RIGHT"})(r.MouseEventButton||(r.MouseEventButton={}));(function(e){e[e.ShareExisting=1]="ShareExisting",e[e.EditShared=2]="EditShared",e[e.EditSharedSubFolder=3]="EditSharedSubFolder"})(r.ShareFolderModalType||(r.ShareFolderModalType={}));(function(e){e.SET_SHARED_FOLDER_DATA="SET_SHARED_FOLDER_DATA",e.SET_MEMBER_COUNTS_FOR_NS="SET_MEMBER_COUNTS_FOR_NS",e.SET_SHARED_LINK_DATA="SET_SHARED_LINK_DATA",e.SET_SHARED_FILE_DATA="SET_SHARED_FILE_DATA",e.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE="SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE",e.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE="SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE",e.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE="SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE",e.CLEAR_SHARED_FOLDER_DATA_FOR_NS="CLEAR_SHARED_FOLDER_DATA_FOR_NS",e.REMOVE_SHARED_LINK_DATA="REMOVE_SHARED_LINK_DATA"})(r.SharedWithActionType||(r.SharedWithActionType={})),r.SEARCH_PREFIX="/search";var h;(function(e){e.Grid="GRID_VIEW",e.List="LIST_VIEW"})(h=r.ViewType||(r.ViewType={})),r.AllViewTypes=[h.Grid,h.List];(function(e){e.LOADING="LOADING",e.COMPLETE="COMPLETE",e.NO_ACCESS="NO_ACCESS",e.ERROR="ERROR"})(r.FetchFolderSizeState||(r.FetchFolderSizeState={})),r.MAX_FOLDERS_PER_CALL=100,r.MAX_FOLDER_SIZE_QUEUE_SIZE=50,r.MAX_FOLDER_SIZE_ITERATIONS=1e3;(function(e){e.GOOGLE_DOC="gdoc",e.GOOGLE_SHEET="gsheet",e.GOOGLE_SLIDE="gslide",e.PAPER="paper"})(r.CloudDoc||(r.CloudDoc={})),r.VIEW_TYPE_COOKIE_NAME="browse_view_type",r.COLUMNS_STORAGE_KEY="browse_columns",r.BROWSE_SORT_COOKIE_NAME="browse_current_sort"}),define("modules/clean/react/browse/models",["require","exports","tslib","modules/clean/immutability_helper","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/constants","modules/clean/sharing/access_level","modules/clean/display_format"],function(e,r,t,s,n,a,o,i,c){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var _=(function(){function e(e){this.ago=e.ago,this.beacon_context=e.beacon_context,this.bytes=e.bytes,this.comment_count=e.comment_count,this.direct_blockserver_link=e.direct_blockserver_link,this.event_type=e.event_type,this.ext=e.ext,this.feedback_off=e.feedback_off,this.file_id=e.file_id,this.filename_highlights=e.filename_highlights,this.fq_path=e.fq_path,this.href=e.href,this.htmlified_link=e.htmlified_link,this.icon=e.icon,this.is_camera_uploads=e.is_camera_uploads,this.is_cloud_doc=e.is_cloud_doc,this.is_dir=e.is_dir,this.is_in_team_folder_tree=e.is_in_team_folder_tree,this.is_unmounted=e.is_unmounted,this.last_modified_name=e.last_modified_name,this.latest_rev=e.latest_rev,this.linkfile_data=e.linkfile_data,this.match_type=e.match_type,this._mount_access_perms=e._mount_access_perms,this.ns_id=e.ns_id,this.ns_path=e.ns_path,this.preview_type=e.preview_type,this.preview_url=e.preview_url,this.preview_thumbnail_url=e.preview_thumbnail_url,this.read_only=!!e.read_only,this.request_id=e.request_id,this.revision_id=e.revision_id,this.size=e.size,this.sjid=e.sjid,this.sort_key=e.sort_key,this.sort_rank=e.sort_rank,this.sync_setting=e.sync_setting,this.target_ns=e.target_ns,this.team_folder_status=e.team_folder_status,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.ts=e.ts,this.type=e.type,this.unresolved_comment_count=e.unresolved_comment_count,this.video_metadata_url=e.video_metadata_url,this.video_container=e.video_container,this.video_transcode_url=e.video_transcode_url,this.preview_ssr_text_url_tmpl=e.preview_ssr_text_url_tmpl,this.preview_ssr_image_url_tmpl=e.preview_ssr_image_url_tmpl,this.preview_ssr_refresh_url=e.preview_ssr_refresh_url,this.isDeleted=!!e.isDeleted,this.fetchFolderSizesStatus=e.fetchFolderSizesStatus}return e.fromServerObject=function(r){return new e(t.__assign({},r,{_mount_access_perms:r.mount_access_perms,isDeleted:r.bytes===-1}))},e.prototype.set=function(e,r){return s.set(this,e,r)},e.prototype.merge=function(e){return s.merge(this,e)},e.prototype.toJS=function(){return Object.assign({},this)},e.getExtension=function(e){return e.is_dir?"":n.file_extension(n.filename(e.fq_path))},e.getCategoryDescription=function(r,t){void 0===t&&(t=!1);var s;if(r.is_dir)switch(s="FOLDER",r.type){case a.FileTypes.TEAM_SHARED_FOLDER:s="TEAM_SHARED_FOLDER";break;case a.FileTypes.SHARED_FOLDER:s="SHARED_FOLDER";break;case a.FileTypes.SANDBOX:s="SANDBOX";break;case a.FileTypes.TEAM_MEMBER_FOLDER:s="TEAM_MEMBER_FOLDER";break;default:r.target_ns&&(s="SHARED_FOLDER")}else s=o.ExtensionCategories[e.getExtension(r)]||"FILE";return r.isDeleted?t?o.DeletedFileTypeCapitalizedCategoryTranslations[s]:o.DeletedFileTypeCategoryTranslations[s]:t?o.FileTypeCapitalizedCategoryTranslations[s]:o.FileTypeCategoryTranslations[s]},e.isTeamSharedFolder=function(e){return e.type===a.FileTypes.TEAM_SHARED_FOLDER},e.isTeamMemberFolder=function(e){return e.type===a.FileTypes.TEAM_MEMBER_FOLDER},e.isReadOnlySharedFolder=function(e){var r=e._mount_access_perms;return null!=r&&!r.includes("can_edit")},e.isNoAccessSharedFolder=function(e){var r=e._mount_access_perms;return null!=r&&!r.includes("can_view")},e.canViewFileMembers=function(e,r){var t=e._mount_access_perms;return!(t&&t.indexOf("can_view_members")<0)&&(!(r&&!r.canViewContainingNSMembers)||!!(t&&t.indexOf("can_view_members")>=0))},e.areEqual=function(e,r){return e.ns_id===r.ns_id&&e.sjid===r.sjid},e.revisionKey=function(e){return e.ns_id+":"+e.sjid},e.prototype.updateSize=function(e,r){return this.merge({bytes:e,size:c.format_bytes(e),fetchFolderSizesStatus:r})},e})();r.File=_;var u=(function(){function e(e){void 0===e&&(e={}),this.isPublicFolderEnabled=!!e.isPublicFolderEnabled,this.publicFolderFqPath=e.publicFolderFqPath,this.publicAppToken=e.publicAppToken,Object.freeze(this)}return e.fromServerObject=function(r){return new e({isPublicFolderEnabled:r.public_folder_enabled,publicFolderFqPath:r.public_folder_fq_path,publicAppToken:r.public_app_token})},e.prototype.set=function(e,r){return s.set(this,e,r)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e})();r.Config=u;var h=(function(){function e(e){var r=void 0===e?{}:e,t=r.canViewContainingNSMembers,s=r.currentNSID,n=r.currentFQPath,a=r.currentMountPoint,o=r.currentNSPath,c=r.currentSharedFolderPermissionRole,_=r.currentNSAllowsNesting,h=r.inactiveNSIDByFQPath,l=r.permanentDeletionDisabledStateByNSID,d=r.isInFolderMode,p=r.isCurrentlyInRoot,E=r.isInsideSharedFolder,S=r.isInsideTeamFolderRoot,R=r.isInsideArchivedTeamFolder,f=r.isInsideTeamFolderTree,T=r.isInsideDeletedFolder,A=r.isInsideDeletedSharedFolder,m=r.isInsideDeletedNestedSharedFolder,O=r.isNonUserRelativeContext,C=r.pathRoot,I=r.rootNSID,g=r.showSharedFolderCreateTeamPromo,y=r.showPinnedTeamFolder,D=r.teamFolderOwnerTeamApiId,L=r.blockHash,v=r.config,N=r.syncSetting;this.canViewContainingNSMembers=null==t||t,this.currentNSID=s,this.currentFQPath=n||"",this.currentMountPoint=a,this.currentNSPath=o,this.currentSharedFolderPermissionRole=null!=c?c:i.NameSpaceAccess.ACCESS_NO_ACCESS,this.currentNSAllowsNesting=!!_,this.inactiveNSIDByFQPath=h||{},this.permanentDeletionDisabledStateByNSID=l||{},this.isInFolderMode=null==d||d,this.isCurrentlyInRoot=!!p,this.isInsideSharedFolder=!!E,this.isInsideTeamFolderRoot=!!S,this.isInsideArchivedTeamFolder=!!R,this.isInsideTeamFolderTree=!!f,this.isInsideDeletedFolder=!!T,this.isInsideDeletedSharedFolder=!!A,this.isInsideDeletedNestedSharedFolder=!!m,this.isNonUserRelativeContext=!!O,this.pathRoot=C,this.rootNSID=I,this.showSharedFolderCreateTeamPromo=!!g,this.showPinnedTeamFolder=!!y,this.teamFolderOwnerTeamApiId=D,this.blockHash=L,this.config=v||new u,this.syncSetting=N}return e.fromServerObject=function(r){var t=r.containing_fq_path||"";t.startsWith("/")||(t="/"+t);var s;r.inside_shared_folder&&(s=i.NameSpaceAccess.ACCESS_READER);var n,a=r.containing_ns_permissions||[],o=a.includes("mount_shared_folders");return r.inside_shared_folder&&(a.includes("edit_contents")&&(s=i.NameSpaceAccess.ACCESS_WRITER),a.includes("change_folder_options")&&(s=i.NameSpaceAccess.ACCESS_OWNER),a.includes("view_members")||(n=!1)),new e({blockHash:r.block_hash,canViewContainingNSMembers:n,config:u.fromServerObject(r),currentFQPath:t,currentMountPoint:r.containing_mount_point,currentNSAllowsNesting:o,currentNSID:r.containing_ns_id,currentNSPath:r.containing_ns_path,currentSharedFolderPermissionRole:s,inactiveNSIDByFQPath:r.old_path_to_ns_id,isCurrentlyInRoot:r.in_root_dir,isInFolderMode:r.inside_dir,isInsideArchivedTeamFolder:r.inside_archived_team_folder,isInsideTeamFolderRoot:r.inside_team_folder_root,isInsideDeletedFolder:r.inside_deleted_dir,isInsideDeletedNestedSharedFolder:r.inside_deleted_nested_shared_folder,isInsideDeletedSharedFolder:r.inside_deleted_shared_folder,isInsideSharedFolder:r.inside_shared_folder,isInsideTeamFolderTree:r.inside_team_folder_tree,isNonUserRelativeContext:r.is_non_user_relative_context,pathRoot:r.path_root,permanentDeletionDisabledStateByNSID:r.permanent_delete_is_disabled_by_ns_id,rootNSID:r.root_ns_id,showPinnedTeamFolder:r.show_pinned_team_folder,showSharedFolderCreateTeamPromo:r.show_shared_folder_create_team_promo,teamFolderOwnerTeamApiId:r.team_folder_owner_team_dbtid,syncSetting:r.sync_setting})},e.prototype.set=function(e,r){return s.set(this,e,r)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e.prototype.isCurrentPathWriteable=function(){var e=this,r=e.currentSharedFolderPermissionRole;return!e.isInsideSharedFolder||r===i.NameSpaceAccess.ACCESS_WRITER||r===i.NameSpaceAccess.ACCESS_OWNER},e.prototype.getNameOfTargetFolder=function(){return n.filename(this.currentFQPath)},e})();r.BrowseContext=h;var l=(function(){function e(e){this.title=e.title,this.pad_id=e.pad_id,this.url=e.url,this.title_highlights=e.title_highlights,this.highlight_spans=e.highlight_spans,this.creator_name=e.creator_name,this.last_modified_date=e.last_modified_date,this.request_id=e.request_id,this.sort_rank=e.sort_rank,this.ts=e.ts}return e.fromServerObject=function(r){return new e(r)},e})();r.Paper=l;var d=(function(){function e(e){this.name=e.name,this.url=e.url,this.folder_id=e.folder_id,this.is_project=e.is_project,this.title_highlights=e.title_highlights,this.highlight_spans=e.highlight_spans,this.request_id=e.request_id,this.sort_rank=e.sort_rank}return e.fromServerObject=function(r){return new e(r)},e})();r.PaperFolder=d}),define("modules/clean/react/maestro/a11y_constants",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e[e.TITLE=0]="TITLE",e[e.SEARCH_BAR=1]="SEARCH_BAR",e[e.NOTIFICATION_BELL=2]="NOTIFICATION_BELL",e[e.CALENDAR_FLYOUT=3]="CALENDAR_FLYOUT",e[e.ACCOUNT_MENU=4]="ACCOUNT_MENU",e[e.MAIN_CONTENT=5]="MAIN_CONTENT",e[e.SIDE_BAR=6]="SIDE_BAR"})(r.LAYOUT_TAB_ORDER||(r.LAYOUT_TAB_ORDER={}))}),define("modules/clean/react/maestro/header",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/maestro/top_menu_container","modules/clean/react/maestro_nav/shared_code/dropbox_logo","modules/clean/react/maestro/a11y_constants","modules/clean/react/maestro/responsive","external/classnames"],function(e,r,t,s,n,a,o,i,c,_){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.render=function(){return s.createElement("header",{className:"maestro-header page-header__shadow"},s.createElement(c.VerticallyFixedWrapper,{className:"page-header",responsive:this.props.responsive},s.createElement("div",{className:_("page-header__title",this.props.titleClass),tabIndex:i.LAYOUT_TAB_ORDER.TITLE},this.props.title),s.createElement(a.TopMenuContainer,t.__assign({},this.props))))},r.defaultProps={showSearchBar:!0,isSearchBarExpanded:!1},r})(s.Component),h=function(e){var r=e.children;return s.createElement("h1",{className:"page-header__heading"},r)};r.MaestroHeaderTitle=h;var l=function(){return s.createElement("a",{href:"/",className:"page-header__logo"},s.createElement(o.DropboxLogo,{alt:"Dropbox"}))};r.MaestroHeaderLogo=l;var d=n(u,["/static/css/maestro_layout-vfl5KaaNy.css"]);r.PageletMaestroHeader=d}),define("modules/clean/react/maestro/layout",["require","exports","tslib","external/react","external/spectrum/match","modules/clean/react/maestro/header","modules/clean/react/maestro/secondary_sidebar","modules/clean/react/maestro/a11y_constants","modules/clean/react/maestro/responsive"],function(e,r,t,s,n,a,o,i,c){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var _=(function(e){function r(r){var t=e.call(this,r)||this;t.isPageResponsive=function(){return!(!document||!document.documentElement)&&document.documentElement.classList.contains(c.RESPONSIVE_CLASS)},t.handleSetup=function(){t.setState({setupComplete:!0})},t.handleMatchMedium=function(){t.setState({isMatchedMedium:!0})},t.handleUnmatchMedium=function(){t.setState({isMatchedMedium:!1})},t.handleMatchLarge=function(){t.setState({isMatchedLarge:!0})},t.handleUnmatchLarge=function(){t.setState({isMatchedLarge:!1})};var s=t.isPageResponsive();return t.state={isResponsive:s,isMatchedMedium:!s,isMatchedLarge:!s,setupComplete:!s},t}return t.__extends(r,e),r.prototype.render=function(){var e=this.props,r=e.user,_=e.titleRegion,u=e.titleClass,h=e.embeddedAppRegion,l=e.actionSidebarRegion,d=e.searchBarProps,p=this.state,E=p.setupComplete,S=t.__rest(p,["setupComplete"]);return s.createElement("div",{className:"maestro-chrome"},S.isResponsive&&s.createElement(n.Match,{media:c.BREAKPOINT_LARGE,onSetup:this.handleSetup,onMatch:this.handleMatchLarge,onUnmatch:this.handleUnmatchLarge}),S.isResponsive&&s.createElement(n.Match,{media:c.BREAKPOINT_MEDIUM,onSetup:this.handleSetup,onMatch:this.handleMatchMedium,onUnmatch:this.handleUnmatchMedium}),E&&s.createElement(a.PageletMaestroHeader,t.__assign({user:r,title:_,titleClass:u,responsive:S},d||{})),E&&s.createElement("main",{className:"maestro-app"},s.createElement("div",{className:"maestro-app-content",tabIndex:i.LAYOUT_TAB_ORDER.MAIN_CONTENT},"function"==typeof h?h(S):h),l&&s.createElement("div",{className:"maestro-secondary-sidebar__shadow",tabIndex:i.LAYOUT_TAB_ORDER.SIDE_BAR},s.createElement(o.MaestroSecondarySidebar,{responsive:S},"function"==typeof l?l(S):l))))},r})(s.PureComponent);r.MaestroChrome=_}),define("modules/clean/react/maestro/responsive",["require","exports","tslib","external/react","external/spectrum/vertically_fixed"],function(e,r,t,s,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RESPONSIVE_CLASS="maestro--responsive",r.BREAKPOINT_MEDIUM="(min-width: 736px)",r.BREAKPOINT_LARGE="(min-width: 1025px)";var a=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.render=function(){var e=this.props,r=e.responsive,a=t.__rest(e,["responsive"]),o=r&&r.isResponsive?"div":n.VerticallyFixed;return s.createElement(o,a)},r.displayName="VerticallyFixedWrapper",r})(s.Component);r.VerticallyFixedWrapper=a}),define("modules/clean/react/maestro/secondary_sidebar",["require","exports","tslib","external/react","modules/clean/react/maestro/responsive","modules/clean/react/prompt/legacy_ha_wrapper"],function(e,r,t,s,n,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.render=function(){return s.createElement(n.VerticallyFixedWrapper,{responsive:this.props.responsive,className:"maestro-secondary-sidebar"},this.props.children,s.createElement(a.LegacyHAWrapper,null))},r})(s.Component);r.MaestroSecondarySidebar=o}),define("modules/clean/react/maestro/top_menu_container",["require","exports","tslib","external/react","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/react/browse/models","modules/core/browser","modules/clean/search/search_bar/controller","modules/clean/search/search_bar/log_helper","modules/core/uri","modules/clean/react/css","modules/clean/web_user_action_events"],function(e,r,t,s,n,a,o,i,c,_,u,h,l){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.onSearch=function(e,t,s){var n=new u({path:"/search/"+r.props.user.role});e&&i.redirect(n.updateQuery({path:r.props.currentPath,query:e,qsid:s,search_token:t}).toString())},r.onSearchResultOpen=function(e){if(e instanceof o.File)if(_.logDropdownSearchAction({result:e,user:r.props.user,action_type:e.is_dir?l.WebUserActionLogEvent.FOLDER_OPEN:l.WebUserActionLogEvent.FILE_VIEW,viewport:"top-menu-dropdown-view"}),e.is_dir)i.open_tab(e.href);else{var t=e.fq_path.substring(1),s=new u({path:"/"+r.props.user.role}).updateQuery({preview:t});i.open_tab(s.toString())}else(e instanceof o.Paper||e instanceof o.PaperFolder)&&(_.logDropdownSearchAction({result:e,user:r.props.user,action_type:l.WebUserActionLogEvent.PAPER_OPEN,viewport:"top-menu-dropdown-view"}),i.open_tab(e.url))},r.onResultObjectPathClick=function(e){_.logDropdownSearchAction({result:e,user:r.props.user,action_type:l.WebUserActionLogEvent.CLICK_PATH_LINK,viewport:"dropdown-view"});var t=a.parent_dir(e.fq_path),s=n.browse_uri_for_fq_path(r.props.user,t||"").toString();i.open_tab(s)},r}return t.__extends(r,e),r.prototype.renderSearchBar=function(){return this.props.showSearchBar?s.createElement(c.SearchBarController,{user:this.props.user,currentPath:this.props.currentPath,isExpanded:this.props.isSearchBarExpanded,onSearch:this.props.onSearch||this.onSearch,onCancelSearch:this.props.onCancelSearch,onSearchResultOpen:this.props.onSearchResultOpen||this.onSearchResultOpen,onResultObjectPathClick:this.props.onResultObjectPathClick||this.onResultObjectPathClick,searchBarExperiments:this.props.searchBarExperiments||{}}):null},r.prototype.renderRightContent=function(){return this.props.rightContent?this.props.rightContent:s.createElement("div",{className:"top-menu-container--search-bar-empty-space"})},r.prototype.render=function(){return s.createElement("div",{className:"top-menu-container "+this.props.classNames},this.renderSearchBar(),this.renderRightContent())},r.defaultProps={showSearchBar:!0,isSearchBarExpanded:!1,classNames:"",currentPath:"/"},r})(s.Component);r.TopMenuContainer=h(d,["/static/css/pagelet-vflBp79rc.css"],[c.SearchBarController])}),define("modules/clean/react/prompt/legacy_ha_wrapper",["require","exports","tslib","external/react","modules/clean/upsell/prompt_event_emitter"],function(e,r,t,s,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.emitUpdateEvent=function(){n.Emitter.emit(n.Events.REACT_HA_DID_UPDATE)},r.prototype.componentDidMount=function(){r.emitUpdateEvent()},r.prototype.componentDidUpdate=function(){r.emitUpdateEvent()},r.prototype.render=function(){return s.createElement("div",null)},r.displayName="LegacyHAWrapper",r})(s.Component);r.LegacyHAWrapper=a}),define("modules/clean/search/api_helpers",["require","exports"],function(e,r){"use strict";function t(){return(new Date).getTimezoneOffset()}Object.defineProperty(r,"__esModule",{value:!0}),r.getCurrentTimezoneOffset=t}),define("modules/clean/search/constants",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MaxResults={MAX_SEARCH_SUGGESTIONS:8,MAX_SEARCH_RESULTS:100},r.FOCUS_SEARCH_BAR_ACTION="search__FOCUS_SEARCH_BAR",r.BLUR_SEARCH_BAR_ACTION="search__BLUR_SEARCH_BAR",r.SET_SEARCH_QUERY_ACTION="search__SET_SEARCH_QUERY",r.SET_SEARCH_SUGGESTIONS_ACTION="search__SET_SEARCH_SUGGESTIONS",r.SET_SLIM_SEARCH_SUGGESTIONS_ACTION="search__SET_SLIM_SEARCH_SUGGESTIONS",
r.SET_HIGHLIGHTED_ROW_ACTION="search__SET_HIGHLIGHTED_ROW",r.HIGHLIGHT_PREVIOUS_ROW_ACTION="search__HIGHLIGHT_PREVIOUS_ROW",r.HIGHLIGHT_NEXT_ROW_ACTION="search__HIGHLIGHT_NEXT_ROW",r.CLEAR_SEARCH_BAR_ACTION="search__CLEAR_SEARCH_BAR",r.SEARCH_SUCCESSFUL_ACTION="search__SEARCH_SUCCESSFUL",r.CLEAR_ALL_HISTORY_ACTION="search__CLEAR_ALL_HISTORY",r.START_SEARCH_ACTION="search__START_SEARCH",r.SET_SEARCH_RESULTS_ACTION="search__SET_SEARCH_RESULTS",r.CONTINUE_SEARCH_ACTION="search__CONTINUE_SEARCH",r.APPEND_SEARCH_RESULTS_ACTION="search__APPEND_SEARCH_RESULTS",r.SET_FULL_SEARCH_RESULTS_ACTION="search__SET_FULL_SEARCH_RESULTS_ACTION",r.CLEAR_SEARCH_ACTION="search__CLEAR_SEARCH",r.SET_SEARCH_SELECTION_ACTION="search__SET_SEARCH_SELECTION",r.CHANGE_FILES_ACTION="search__CHANGE_SEARCH_FILES",r.SET_SCOPE_CHIP_ACTION="search__SET_SCOPE_CHIP_ACTION",r.FULLTEXT_SEARCH_ENDPOINT="/ajax_fulltext_search",r.PARTIAL_SEARCH_ENDPOINT="/ajax_fulltext_search_partial_result",r.SEARCH_METADATA_ENDPOINT="/search/search_metadata";(function(e){e.LOADED="LOADED",e.LOADING_FIRST_PAGE="LOADING_FIRST_PAGE",e.LOADING_ADDITIONAL_PAGE="LOADING_ADDITIONAL_PAGE"})(r.SearchLoadingState||(r.SearchLoadingState={})),r.SEARCH_RECENT_HISTORY_CAPACITY=5,r.SEARCH_RECENT_HISTORY_STORAGE_KEY="search_recent_history"}),define("modules/clean/search/logger",["require","exports","tslib","modules/clean/analytics","modules/clean/search/api_helpers"],function(e,r,t,s,n){"use strict";function a(e){var r=e.searchSessionId,a=e.result,_=e.user,u=e.action_type,h=e.viewport,l=void 0===h?"full-view":h,d=e.view_type,p=(e.latency,e.displayed,n.getCurrentTimezoneOffset()),E={viewport:l,action_type:u,search_session_id:r,view_type:d,position:a.sort_rank,request_id:a.request_id,timezone_offset:p};if(o(a)){var S=a;E=t.__assign({},E,{file_nsid:S.ns_id,file_sjid:S.sjid,match_type:S.match_type})}else if(i(a)){var R=a;E=t.__assign({},E,{paper_pad_id:R.pad_id,position:R.sort_rank,request_id:R.request_id})}else if(c(a)){var f=a;E=t.__assign({},E,{paper_folder_id:f.folder_id,position:f.sort_rank,request_id:f.request_id})}s.SearchClientActivityLogger.log("result_action",_.id,E)}function o(e){return void 0!==e.ns_id}function i(e){return void 0!==e.pad_id}function c(e){return void 0!==e.folder_id}function _(e){var r=e.searchSessionId,t=e.user,a=e.history,o=n.getCurrentTimezoneOffset(),i=a.map(function(e){return e.rawQuery}).reduce(function(e,r,t){return e[t]=r,e},{}),c={search_session_id:r,recent_history_map:JSON.stringify(i),timezone_offset:o,viewport:"dropdown-view"};s.SearchClientActivityLogger.log("recent_history_displayed",t.id,c)}function u(e){var r=e.searchSessionId,t=e.user,a=n.getCurrentTimezoneOffset(),o={search_session_id:r,timezone_offset:a,viewport:"dropdown-view"};s.SearchClientActivityLogger.log("recent_history_cleared",t.id,o)}function h(e){var r=e.searchSessionId,t=e.query,a=e.user,o=e.rank,i=e.action_type,c=n.getCurrentTimezoneOffset(),_={search_session_id:r,query_string:t.rawQuery,position:o,timezone_offset:c,viewport:"dropdown-view",action_type:i};s.SearchClientActivityLogger.log("recent_query_selected",a.id,_)}function l(e){var r=e.searchSessionId,t=e.requestId,a=e.query,o=e.user,i=e.previousPosition,c=e.viewport,_=void 0===c?"dropdown-view":c,u=n.getCurrentTimezoneOffset(),h={search_session_id:r,request_id:t,query_string:a.rawQuery,position:i,timezone_offset:u,viewport:_};s.SearchClientActivityLogger.log("recent_query_stored",o.id,h)}function d(e){var r=e.searchSessionId,t=e.user,a=e.chipAdded,o=n.getCurrentTimezoneOffset(),i={search_session_id:r,timezone_offset:o,path_scoped:a};s.SearchClientActivityLogger.log("scope_chip_changed",t.id,i)}function p(e){var r=e.searchSessionId,t=e.user,a=n.getCurrentTimezoneOffset(),o={search_session_id:r,timezone_offset:a};s.SearchClientActivityLogger.log("search_bar_focus_lost",t.id,o)}function E(e,r){var s=e;return t.__assign({},r,{file_nsid:s.ns_id,file_sjid:s.sjid,match_type:s.match_type||void 0})}function S(e){var r=e.searchSessionId,t=e.result,a=e.user,o=e.previewRequestId,i=e.viewport,c=void 0===i?"dropdown-view":i,_=n.getCurrentTimezoneOffset(),u={search_session_id:r,preview_request_id:o,timezone_offset:_,viewport:c};s.SearchClientActivityLogger.log("preview_started",a.id,E(t,u))}function R(e){var r=e.searchSessionId,t=e.result,a=e.user,o=e.previewRequestId,i=e.viewport,c=void 0===i?"dropdown-view":i,_=e.latency,u=e.displayed,h=n.getCurrentTimezoneOffset(),l={search_session_id:r,preview_request_id:o,timezone_offset:h,viewport:c,latency:_,displayed:u?"true":"false"};s.SearchClientActivityLogger.log("preview_completed",a.id,E(t,l))}function f(e){var r=e.searchSessionId,t=e.result,a=e.user,o=e.previewRequestId,i=e.viewport,c=void 0===i?"dropdown-view":i,_=e.failureType,u=n.getCurrentTimezoneOffset(),h={search_session_id:r,preview_request_id:o,timezone_offset:u,viewport:c,failure_type:_};s.SearchClientActivityLogger.log("preview_failed",a.id,E(t,h))}Object.defineProperty(r,"__esModule",{value:!0}),r.logSearchAction=a,r.logRecentHistoryDisplayed=_,r.logRecentHistoryCleared=u,r.logRecentQuerySelected=h,r.logRecentQueryStored=l,r.logScopeChipChanged=d,r.logSearchBarFocusLost=p,r.logHoverPreviewStarted=S,r.logHoverPreviewCompleted=R,r.logHoverPreviewFailed=f}),define("modules/clean/search/models",["require","exports","external/deep-freeze","modules/clean/react/browse/models"],function(e,r,t,s){"use strict";function n(e){return new s.BrowseContext({isInFolderMode:e.inside_dir,inactiveNSIDByFQPath:e.old_path_to_ns_id,blockHash:e.block_hash})}Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function e(e){this.fq_path=e.fq_path,this.is_unmounted=e.is_unmounted,this.icon=e.icon,this.filename_highlights=e.filename_highlights,this.highlight_spans=e.highlight_spans,this.ns_id=e.ns_id,this.sjid=e.sjid,this.is_dir=e.is_dir,this.type=e.type,this.match_type=e.match_type,this._mount_access_perms=e.mount_access_perms,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.hover_preview_url=e.hover_preview_url,this.request_id=e.request_id,this.sort_rank=e.sort_rank,t(this)}return e.fromServerObject=function(r){return new e(r)},e})();r.SlimFileSearchResult=a,r.extractBrowseContext=n}),define("modules/clean/search/search_bar/actions",["require","exports","modules/clean/search/constants","modules/clean/search/search_bar/dispatcher"],function(e,r,t,s){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(function(){function e(){}return e.prototype.focusSearchBar=function(e){s.SearchBarDispatcher.dispatch({type:t.FOCUS_SEARCH_BAR_ACTION,data:{user:e}})},e.prototype.blurSearchBar=function(){s.SearchBarDispatcher.dispatch({type:t.BLUR_SEARCH_BAR_ACTION})},e.prototype.setSearchQuery=function(e){var r=e.query,n=e.qsid,a=e.keepHighlightedRow,o=e.path;s.SearchBarDispatcher.dispatch({type:t.SET_SEARCH_QUERY_ACTION,data:{query:r,qsid:n,keepHighlightedRow:a,path:o}})},e.prototype.setSearchSuggestions=function(e){var r=e.searchResults,n=e.hasMoreResults;s.SearchBarDispatcher.dispatch({type:t.SET_SEARCH_SUGGESTIONS_ACTION,data:{searchResults:r,hasMoreResults:n}})},e.prototype.setSlimSearchSuggestions=function(e){var r=e.searchResults,n=e.hasMoreResults;s.SearchBarDispatcher.dispatch({type:t.SET_SLIM_SEARCH_SUGGESTIONS_ACTION,data:{searchResults:r,hasMoreResults:n}})},e.prototype.setHighlightedRow=function(e){var r=e.index;s.SearchBarDispatcher.dispatch({type:t.SET_HIGHLIGHTED_ROW_ACTION,data:{index:r}})},e.prototype.highlightPreviousRow=function(){s.SearchBarDispatcher.dispatch({type:t.HIGHLIGHT_PREVIOUS_ROW_ACTION})},e.prototype.highlightNextRow=function(){s.SearchBarDispatcher.dispatch({type:t.HIGHLIGHT_NEXT_ROW_ACTION})},e.prototype.clearSearch=function(){s.SearchBarDispatcher.dispatch({type:t.CLEAR_SEARCH_BAR_ACTION})},e.prototype.searchSuccessful=function(e,r,n,a){s.SearchBarDispatcher.dispatch({type:t.SEARCH_SUCCESSFUL_ACTION,data:{user:e,query:r,searchSessionId:n,requestId:a}})},e.prototype.setScopeChip=function(e,r){s.SearchBarDispatcher.dispatch({type:t.SET_SCOPE_CHIP_ACTION,data:{scope:r,canScope:e}})},e.prototype.clearAllHistory=function(e){s.SearchBarDispatcher.dispatch({type:t.CLEAR_ALL_HISTORY_ACTION,data:{user:e}})},e})();r.SearchBarActions=n,r.searchBarActions=new n}),define("modules/clean/search/search_bar/api",["require","exports","tslib","modules/clean/ajax","modules/clean/filepath","modules/clean/search/constants","modules/clean/analytics","modules/clean/react/browse/models","modules/clean/search/types","modules/clean/search/models","modules/clean/search/api_helpers","modules/clean/search/search_bar/experiments"],function(e,r,t,s,n,a,o,i,c,_,u,h){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var l=(function(e){function r(r){var t=this.constructor,s=this,n=t.prototype;return s=e.call(this,r)||this,s.__proto__=n,s}return t.__extends(r,e),r})(Error);r.RequestAbortedError=l;var d=(function(){function e(){this._searchApiUrl="/search/dropdown_search",this._activeRequest=null}return e.prototype.getSearchApiUrl=function(){return this._searchApiUrl},e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype._extractSlimSearchResultsList=function(e){for(var r=[],t=0,s=e;t<s.length;t++){var n=s[t];switch(n.search_result_type){case c.SearchResultTypes.FILE:r.push(_.SlimFileSearchResult.fromServerObject(n));break;case c.SearchResultTypes.PAPER:r.push(i.Paper.fromServerObject(n));break;case c.SearchResultTypes.PAPER_FOLDER:r.push(i.PaperFolder.fromServerObject(n))}}return r},e.prototype.loadSlimResults=function(e){var r=e.user,t=e.path,s=e.query,n=e.searchSessionID,a=e.webTimer,o=u.getCurrentTimezoneOffset(),i=h.getSearchBarExperiments(),c=i.expDropdownThumbnail,_=i.expHoverPreviews,l=i.expPaperFolders,d={query:s,fq_path:t,timezone_offset:o,thumbnail_exp_variant:c,hover_preview_size:_,show_paper_folder_results:l};return this._fetchSlimResults(d,r,n,a)},e.prototype.fetchAdditionalFileMetadata=function(e){var r=this,t=e.searchResults,n=e.user;return new Promise(function(e,o){var i=t.filter(function(e){return e instanceof _.SlimFileSearchResult}),c=i.map(function(e){return[e.ns_id,e.sjid]});c.length>0?s.WebRequest({url:a.SEARCH_METADATA_ENDPOINT,data:{nsid_sjid_pairs:JSON.stringify(c)},dataType:"json",subject_user:n,success:function(s,n,a){e(r._mergeFullResultsIntoSlimResults(s.search_results,t))},error:function(e,r,t){o("abort"===t?new l:new Error(t))}}):e(t)})},e.prototype._mergeFullResultsIntoSlimResults=function(e,r){for(var s=[],a=function(r){if(r instanceof _.SlimFileSearchResult){var a=e.find(function(e){return e.search_result_type===c.SearchResultTypes.FILE&&n.paths_are_equal(e.fq_path,r.fq_path)});a&&s.push(i.File.fromServerObject(t.__assign({},a,{request_id:r.request_id,sort_rank:r.sort_rank,match_type:r.match_type})))}else(r instanceof i.Paper||r instanceof i.PaperFolder)&&s.push(r)},o=0,u=r;o<u.length;o++){a(u[o])}return s},e.prototype._fetchSlimResults=function(e,r,t,n){var a=this;return new Promise(function(i,c){var u;null!=a._activeRequest&&a._activeRequest.abort();var h={path_scoped:"/"!==e.fq_path,search_type:"dropdown",query_string:e.query,search_session_id:t,timezone_offset:e.timezone_offset};o.SearchClientActivityLogger.log("query_started",r.id,h);var d=(new Date).getTime();a._activeRequest=s.WebRequest({url:a._searchApiUrl,data:e,dataType:"json",subject_user:r,success:function(s,c,u){for(var l=_.extractBrowseContext(s),p=s.search_results,E=u.getResponseHeader("x-dropbox-request-id"),S=0,R=0,f=p;R<f.length;R++){var T=f[R];T.request_id=E,T.sort_rank=S++}var A=a._extractSlimSearchResultsList(p),m=o.SearchClientActivityLogger.create_search_log_dict(h,!1,E,d,e.query,A.length,null,t);o.SearchClientActivityLogger.log("query_completed",r.id,m),n&&n.end(E?E:void 0),i({context:l,searchResults:A,deleted:!1})},error:function(s,a,i){u=s.getResponseHeader("x-dropbox-request-id");var _=o.SearchClientActivityLogger.create_search_log_dict(h,null,u,d,e.query,null,a,t);o.SearchClientActivityLogger.log("query_failed",r.id,_),n&&n.abort(),c("abort"===i?new l:new Error(i))},complete:function(){this._activeRequest=null}})})},e})();r.SearchBarApiClient=d,r.searchBarApiClient=new d}),define("modules/clean/search/search_bar/chips",["require","exports","modules/clean/search/search_bar/actions","modules/clean/search/types","modules/clean/search/search_bar/store","modules/clean/filepath"],function(e,r,t,s,n,a){"use strict";function o(e){return a.paths_are_equal(a.normalize(e),"/")}function i(e){return!!e&&!o(e)}function c(e){return e.expSearchChips===s.SearchChipsVariants.CHIP_IN}function _(e){return e.expSearchChips===s.SearchChipsVariants.CHIP_OUT}function u(e){return h(e)&&i(n.searchBarStore.browseScope())}function h(e){return _(e)||c(e)}function l(e,r){r||(r=n.searchBarStore.browseScope());var s=i(r);h(e)&&t.searchBarActions.setScopeChip(s,r)}function d(e){h(e)&&t.searchBarActions.setScopeChip(!0)}function p(e,r){if(h(e)){var s=i(r);i(r)&&c(e)?t.searchBarActions.setScopeChip(s,r):t.searchBarActions.setScopeChip(s)}}function E(e){return e&&h(e)?n.searchBarStore.scopeChip():n.searchBarStore.browseScope()}Object.defineProperty(r,"__esModule",{value:!0}),r.isScopeChipRoot=o,r.isValidPathForChip=i,r.canScopeCurrentPath=u,r.chipsEnabled=h,r.setScopeChip=l,r.removeScopeChip=d,r.handleScopeChange=p,r.getSearchPathForChips=E}),define("modules/clean/search/search_bar/controller",["require","exports","tslib","external/react","external/react-redux","modules/clean/keycode","modules/clean/react/browse/models","modules/clean/search/logger","modules/clean/search/search_bar/api","modules/clean/search/search_bar/chips","modules/clean/search/search_bar/data/action_creators","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/experiments","modules/clean/search/search_bar/log_helper","modules/clean/search/search_bar/view","modules/clean/search/search_helpers","modules/clean/storage","modules/clean/viewer","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/notify","modules/clean/search/types","modules/clean/react/css"],function(e,r,t,s,n,a,o,i,c,_,u,h,l,d,p,E,S,R,f,T,A,m,O,C){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var I=(function(e){function r(r){var t=e.call(this,r)||this;return t._searchBarWebTimer=null,t._logHistoryItemSelected=function(e,r,s){i.logRecentQuerySelected({searchSessionId:t.props.searchSessionID,query:e,user:t.props.user,rank:r-t.props.headerItems.length,action_type:s})},t._handleHistoryItemClick=function(e,r){t._logHistoryItemSelected(e,r),t._setSearchQuery(e.rawQuery)},t._handleRecentSearchContextMenuCapture=function(e,r){t._logHistoryItemSelected(e,r,A.WebUserActionLogEvent.CONTEXT_MENU)},t._handleInputChange=function(e){t._setSearchQuery(e.currentTarget.value)},t._handleCancelSearch=function(){t._setSearchQuery("")},t._handleScopeChipChange=function(e){var r=t.props.searchBarExperiments;_.chipsEnabled(r)&&(i.logScopeChipChanged({searchSessionId:t.props.searchSessionID,user:t.props.user,chipAdded:e}),e?_.setScopeChip(r):_.removeScopeChip(r),t._setSearchQuery(t.props.rawQuery,!0))},t._onBrowseScopeChange=function(e){_.handleScopeChange(t.props.searchBarExperiments,e)},t._handleInputKeydown=function(e,r){if(e.keyCode===a.KeyCode.ESC){t._handleCancelSearch();var s=t.props.onCancelSearch;return void(s&&s())}if(e.keyCode===a.KeyCode.BACKSPACE&&0===r&&!_.isScopeChipRoot(t.props.scopeChip))return void t._handleScopeChipChange(!1);e.stopPropagation(),e.keyCode===a.KeyCode.UP?(e.preventDefault(),t.props.highlightPreviousRow()):e.keyCode===a.KeyCode.DOWN&&(e.preventDefault(),t.props.highlightNextRow())},t._handleSearch=function(e){t.props.onSearch(e,S.getSearchCsrfToken(),t.props.searchSessionID)},t._navToSelection=function(e,r){var s=t.props.searchSuggestions[e-r];s?t._openSearchResult(s):t._handleSearchResultOpen(t.props.slimSearchSuggestions[e-r])},t._handleInputSubmit=function(e,r){e.preventDefault();var s=t.props.headerItems;if(r<s.length)switch(s[r]){case O.SearchBarDropdownHeaderItemType.SEARCH_ALL:t._handleSearch(t.props.normalizedQuery);break;case O.SearchBarDropdownHeaderItemType.SCOPE_CHIPS:var n=!_.isValidPathForChip(t.props.scopeChip);t._handleScopeChipChange(n)}else t._navToSelection(r,s.length)},t._handleContextMenuCapture=function(e){var r=t.props,s=r.user,n=r.searchSessionID;S.fetchFullSearchResult({searchBarApiClient:c.searchBarApiClient,searchResult:e,user:s,onSuccess:function(e){t._dispatchSearchSuccessful(e.request_id||""),p.logDropdownSearchAction({result:e,user:s,action_type:e instanceof o.File?A.WebUserActionLogEvent.CONTEXT_MENU:A.WebUserActionLogEvent.PAPER_CONTEXT_MENU,viewport:"dropdown-view",searchSessionID:n})}})},t._handleSearchResultOpen=function(e){S.fetchFullSearchResult({searchBarApiClient:c.searchBarApiClient,searchResult:e,user:t.props.user,onSuccess:function(e){t._openSearchResult(e)},onError:function(e){m.error(e)}})},t._handleResultObjectPathClick=function(e){t._dispatchSearchSuccessful(e.request_id||""),t.props.onResultObjectPathClick(e)},t._handleHighlightDropdownItem=function(e){t.props.setHighlightedRow({highlightedSearchRow:e})},t._handleSearchBarFocus=function(){var e=t.props.user;t.props.focusSearchBar({user:e})},t._handleSearchBarBlur=function(){t.props.blurSearchBar()},t._dispatchSearchSuccessful=function(e){if(d.searchRecentHistoryEnabled(t.props.searchBarExperiments)){var r=t.props,s=r.user,n=r.rawQuery,a=r.normalizedQuery,o=r.searchSessionID;(0,r.addQueryToHistory)({user:s,query:{rawQuery:n,normalizedQuery:a},searchSessionId:o,requestId:e})}},t._logSearchBarTTI=function(){t._searchBarWebTimer&&t._searchBarWebTimer.markTimeToInteractive()},t._handleHistoryClearAllClick=function(){var e=t.props,r=e.user;(0,e.clearAllHistory)({user:r})},d.initSearchBarExperiments(r.searchBarExperiments),setTimeout(function(){r.isExpanded?_.setScopeChip(t.props.searchBarExperiments,t.props.currentPath):_.handleScopeChange(t.props.searchBarExperiments,t.props.currentPath)},0),t}return t.__extends(r,e),r.prototype.componentWillMount=function(){if(d.searchRecentHistoryEnabled(this.props.searchBarExperiments)){var e=f.Viewer.get_viewer().get_users().map(function(e){return e.id});R.UserLocalStorage.clearOtherUsers(e)}},r.prototype.componentWillUnmount=function(){this._logFocusLost(this.props.isFocused,!1)},r.prototype.componentWillReceiveProps=function(e){var r=this;this.props.currentPath!==e.currentPath&&setTimeout(function(){r._onBrowseScopeChange(e.currentPath)},0)},r.prototype.componentDidUpdate=function(e){this._logFocusLost(e.isFocused,this.props.isFocused)},r.prototype._logFocusLost=function(e,r){d.searchRecentHistoryEnabled(this.props.searchBarExperiments)&&e&&!r&&i.logSearchBarFocusLost({user:this.props.user,searchSessionId:this.props.searchSessionID})},r.prototype._setSearchQuery=function(e,r){void 0===r&&(r=!1);var t=this.props,s=t.user,n=t.setSearchQueryAndFetchResults,a=t.searchBarExperiments;n({user:s,query:e,searchPath:_.getSearchPathForChips(a),webTimer:this._startSearchBarTimer(),keepHighlightedRow:r})},r.prototype._openSearchResult=function(e){this._dispatchSearchSuccessful(e.request_id||""),this.props.onSearchResultOpen(e)},r.prototype._startSearchBarTimer=function(){return this._searchBarWebTimer?this._searchBarWebTimer.restart():(this._searchBarWebTimer=T.get_timer("search_bar"),this._searchBarWebTimer.initialize({requireTTI:!0,requireTTV:!1,url:c.searchBarApiClient.getSearchApiUrl()})),this._searchBarWebTimer},r.prototype.render=function(){var e=this.props,r=e.user,t=e.isExpanded,n=e.searchBarExperiments,a=e.placeholder,o=e.isFocused,i=e.isActive,c=e.rawQuery,_=e.normalizedQuery,u=e.slimSearchSuggestions,h=e.searchBarLoading,l=e.searchSessionID,d=e.highlightedRow,p=e.searchHistory,S=e.scopeChip,R=e.searchPath,f=e.headerItems;return s.createElement(E.SearchBarView,{user:r,isExpanded:t,searchBarExperiments:n,placeholder:a,isFocused:o,isActive:i,rawQuery:c,normalizedQuery:_,suggestions:u,searchBarLoading:h,searchSessionID:l,highlightedRow:d,searchHistory:p,scopeChip:S,searchPath:R,dropdownHeaderItems:f,onSearch:this._handleSearch,onHistoryClearAllClick:this._handleHistoryClearAllClick,onHistoryItemClick:this._handleHistoryItemClick,onInputChange:this._handleInputChange,onInputKeydown:this._handleInputKeydown,onInputSubmit:this._handleInputSubmit,onSearchResultOpen:this._handleSearchResultOpen,onContextMenuCapture:this._handleContextMenuCapture,onRecentSearchContextMenuCapture:this._handleRecentSearchContextMenuCapture,onResultObjectPathClick:this._handleResultObjectPathClick,onSearchBarFocus:this._handleSearchBarFocus,onSearchBarBlur:this._handleSearchBarBlur,onHighlightDropdownItem:this._handleHighlightDropdownItem,onSearchChipInteraction:this._handleScopeChipChange,onDropdownTTI:this._logSearchBarTTI})},r})(s.PureComponent);r.SearchBarControllerElement=I;var g=l.getStoreForSearchBar(),y=function(e){var r=h.isSearchBarFocused,t=h.isSearchBarActive,s=h.rawQuery,n=h.normalizedQuery,a=h.searchSuggestions,o=h.slimSearchSuggestions,i=h.isSearchBarLoading,c=h.searchSessionID,_=h.highlightedSearchRow,u=h.searchHistory,l=h.scopeChip,d=h.searchPath,p=h.headerItems;return{isFocused:r(e),isActive:t(e),rawQuery:s(e),normalizedQuery:n(e),searchSuggestions:a(e),slimSearchSuggestions:o(e),searchBarLoading:i(e),searchSessionID:c(e),highlightedRow:_(e),searchHistory:u(e),scopeChip:l(e),searchPath:d(e),headerItems:p(e)}},D={blurSearchBar:u.blurSearchBar,focusSearchBar:u.focusSearchBar,highlightPreviousRow:u.highlightPreviousRow,highlightNextRow:u.highlightNextRow,setHighlightedRow:u.setHighlightedRow,addQueryToHistory:u.addQueryToHistory,setSearchQueryAndFetchResults:u.setSearchQueryAndFetchResults,clearAllHistory:u.clearAllHistory},L=n.connect(y,D)(I),v=function(e){return s.createElement(n.Provider,{store:g},s.createElement(L,t.__assign({},e)))};r.SearchBarController=C(v,["/static/css/search/search_bar_react-vflJH9lFk.css"])}),define("modules/clean/search/search_bar/data/action_creators",["require","exports","tslib","modules/clean/search/search_bar/api","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/data/types","modules/clean/search/search_bar/experiments","modules/clean/search/search_bar/history"],function(e,r,t,s,n,a,o,i){"use strict";var c=this;Object.defineProperty(r,"__esModule",{value:!0}),r.focusSearchBar=function(e){var t=e.user;return function(e,s){o.searchRecentHistoryEnabled(o.getSearchBarExperiments())&&e(r.updateHistoryInternal({searchHistory:i.getHistory(t)})),e(r.focusSearchBarActionInternal())}},r.focusSearchBarActionInternal=function(){return{type:a.ActionTypes.FOCUS}},r.blurSearchBar=function(){return{type:a.ActionTypes.BLUR}},r.clearSearchBar=function(){return{type:a.ActionTypes.CLEAR}},r.updateHistoryInternal=function(e){var r=e.searchHistory;return{type:a.ActionTypes.UPDATE_HISTORY,payload:{searchHistory:r}}},r.addQueryToHistory=function(e){var t=e.user,s=e.query,n=e.searchSessionId,a=e.requestId;return function(e,o){var c=i.addQuery(t,s,n,a);e(r.updateHistoryInternal({searchHistory:c}))}},r.clearAllHistory=function(e){var t=e.user;return function(e,s){var n=i.clearAll(t);e(r.updateHistoryInternal({searchHistory:n}))}},r.setSearchQuery=function(e){var r=e.query,t=e.searchSessionID,s=e.keepHighlightedRow,n=e.searchPath;return{type:a.ActionTypes.SET_QUERY,payload:{query:r,searchSessionID:t,keepHighlightedRow:s,searchPath:n}}},r.setSearchSuggestions=function(e){var r=e.searchSuggestions,t=e.hasMoreResults;return{type:a.ActionTypes.SET_SUGGESTIONS,payload:{searchSuggestions:r,hasMoreResults:t}}},r.setSlimSearchSuggestions=function(e){var r=e.slimSearchSuggestions,t=e.hasMoreResults;return{type:a.ActionTypes.SET_SLIM_SUGGESTIONS,payload:{slimSearchSuggestions:r,hasMoreResults:t}}},r.setHighlightedRow=function(e){var r=e.highlightedSearchRow;return{type:a.ActionTypes.SET_HIGHLIGHTED_ROW,payload:{highlightedSearchRow:r}}},r.highlightPreviousRow=function(){return{type:a.ActionTypes.HIGHLIGHT_PREVIOUS_ROW}},r.highlightNextRow=function(){return{type:a.ActionTypes.HIGHLIGHT_NEXT_ROW}},r.setBrowseScope=function(e){var r=e.browseScope;return{type:a.ActionTypes.SET_BROWSE_SCOPE,payload:{browseScope:r}}},r.setScopeChip=function(e){var r=e.canScope,t=e.scopeChip;return{type:a.ActionTypes.SET_SCOPE_CHIP,payload:{canScope:r,scopeChip:t}}},r.setSearchQueryAndFetchResults=function(e){var a=e.user,o=e.searchPath,i=e.query,_=e.webTimer,u=e.searchSessionID,h=e.keepHighlightedRow;return function(e,l){return t.__awaiter(c,void 0,void 0,function(){var c,d,p,E;return t.__generator(this,function(t){switch(t.label){case 0:if((c=function(){return i===n.rawQuery(l())&&o===n.searchPath(l())})())return[2];if(e(r.setSearchQuery({query:i,searchPath:o,searchSessionID:u,keepHighlightedRow:h})),!n.isSearchBarLoading(l()))return[3,5];t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.searchBarApiClient.loadSlimResults({user:a,path:o,query:n.normalizedQuery(l()),searchSessionID:n.searchSessionID(l()),webTimer:_})];case 2:return d=t.sent().searchResults,c()?(e(r.setSlimSearchSuggestions({slimSearchSuggestions:d})),[4,s.searchBarApiClient.fetchAdditionalFileMetadata({searchResults:d,user:a})]):[2];case 3:return p=t.sent(),c()?(e(r.setSearchSuggestions({searchSuggestions:p})),[3,5]):[2];case 4:if(E=t.sent(),!(E instanceof s.RequestAbortedError))throw E;return[3,5];case 5:return[2]}})})}}}),define("modules/clean/search/search_bar/data/reducer",["require","exports","tslib","modules/clean/search/search_bar/data/types","modules/clean/search/store_helpers"],function(e,r,t,s,n){"use strict";function a(e,r){switch(void 0===e&&(e=o),r.type){case s.ActionTypes.FOCUS:return i(e,r);case s.ActionTypes.BLUR:return c(e,r);case s.ActionTypes.UPDATE_HISTORY:return _(e,r);case s.ActionTypes.SET_QUERY:return u(e,r);case s.ActionTypes.SET_SUGGESTIONS:return h(e,r);case s.ActionTypes.SET_SLIM_SUGGESTIONS:return l(e,r);case s.ActionTypes.SET_HIGHLIGHTED_ROW:return d(e,r);case s.ActionTypes.HIGHLIGHT_PREVIOUS_ROW:return E(e,r);case s.ActionTypes.HIGHLIGHT_NEXT_ROW:return p(e,r);case s.ActionTypes.SET_BROWSE_SCOPE:return S(e,r);case s.ActionTypes.SET_SCOPE_CHIP:return R(e,r);case s.ActionTypes.CLEAR:return f(e,r);default:return e}}Object.defineProperty(r,"__esModule",{value:!0}),r.SEARCH_BAR_REDUCER_KEY="SEARCH_BAR";var o={isSearchBarFocused:!1,searchHistory:[],query:"",searchSessionID:n.generateRandomID(),searchPath:"",isSearchBarLoading:!1,searchSuggestions:[],hasMoreResults:!1,slimSearchSuggestions:[],highlightedSearchRow:0,browseScope:"/",canScope:!1,scopeChip:"/"},i=function(e,r){return t.__assign({},e,{highlightedSearchRow:0,isSearchBarFocused:!0})},c=function(e,r){return t.__assign({},e,{highlightedSearchRow:0,isSearchBarFocused:!1})},_=function(e,r){var s=r.payload.searchHistory;return t.__assign({},e,{searchHistory:s})},u=function(e,r){var s=r.payload,a=s.query,o=s.searchPath,i=s.searchSessionID,c=s.keepHighlightedRow,_=e.searchSessionID;i?_=i:n.shouldStartNewSearchSession(e.query,a)&&(_=n.generateRandomID());var u=c?e.highlightedSearchRow:0;return t.__assign({},e,{query:a,searchPath:o,searchSessionID:_,searchSuggestions:[],hasMoreResults:!1,isSearchBarLoading:!n.isBlank(a),slimSearchSuggestions:[],highlightedSearchRow:u})},h=function(e,r){var s=r.payload,n=s.searchSuggestions,a=s.hasMoreResults;return t.__assign({},e,{searchSuggestions:n,hasMoreResults:!!a,isSearchBarLoading:!1})},l=function(e,r){var s=r.payload,n=s.slimSearchSuggestions,a=s.hasMoreResults;return t.__assign({},e,{slimSearchSuggestions:n,hasMoreResults:!!a,isSearchBarLoading:!1})},d=function(e,r){var s=r.payload.highlightedSearchRow;return t.__assign({},e,{highlightedSearchRow:s})},p=function(e,r){var s=!n.isBlank(e.query),a=e.slimSearchSuggestions.length||e.searchSuggestions.length||!s&&e.searchHistory.length||0,o=0;o+=s?1:0,o+=e.canScope?1:0;var i=Math.min(a+o-1,e.highlightedSearchRow+1);return t.__assign({},e,{highlightedSearchRow:i})},E=function(e,r){return t.__assign({},e,{highlightedSearchRow:Math.max(0,e.highlightedSearchRow-1)})},S=function(e,r){var s=r.payload.browseScope;return t.__assign({},e,{browseScope:s})},R=function(e,r){var s=r.payload,n=s.canScope,a=s.scopeChip;return t.__assign({},e,{canScope:n,scopeChip:a||"/"})},f=function(e,r){var s=e.scopeChip,n=e.searchHistory,a=e.browseScope;return t.__assign({},o,{scopeChip:s,searchHistory:n,browseScope:a})};r.searchBarReducer=a}),define("modules/clean/search/search_bar/data/selectors",["require","exports","external/reselect","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/search/search_bar/data/reducer","modules/clean/search/store_helpers","modules/clean/search/types"],function(e,r,t,s,n,a,o,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=function(e){return e[a.SEARCH_BAR_REDUCER_KEY]};r.isSearchBarFocused=function(e){return c(e).isSearchBarFocused},r.searchHistory=function(e){return c(e).searchHistory},r.rawQuery=function(e){return c(e).query},r.normalizedQuery=function(e){return o.normalize(r.rawQuery(e))},r.searchSessionID=function(e){return c(e).searchSessionID},r.isSearchBarActive=function(e){return!!r.rawQuery(e)},r.searchPath=function(e){return c(e).searchPath},r.isSearchBarLoading=function(e){return c(e).isSearchBarLoading},r.searchSuggestions=function(e){return c(e).searchSuggestions},r.hasMoreResults=function(e){return c(e).hasMoreResults},r.slimSearchSuggestions=function(e){return c(e).slimSearchSuggestions},r.highlightedSearchRow=function(e){return c(e).highlightedSearchRow},r.searchResultForPath=function(e,t){return r.searchSuggestions(e).find(function(e){return e instanceof n.File&&s.paths_are_equal(e.fq_path,t)})},r.browseScope=function(e){return c(e).browseScope},r.scopeChip=function(e){return c(e).scopeChip},r.canScope=function(e){return c(e).canScope},r.headerItems=t.createSelector(r.normalizedQuery,r.canScope,function(e,r){var t=""!==e,s=[];return t&&s.push(i.SearchBarDropdownHeaderItemType.SEARCH_ALL),r&&s.push(i.SearchBarDropdownHeaderItemType.SCOPE_CHIPS),s})}),define("modules/clean/search/search_bar/data/store",["require","exports","modules/clean/redux/store","modules/clean/search/search_bar/data/reducer"],function(e,r,t,s){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n;r.getStoreForSearchBar=function(){if(!n){var e=(r={},r[s.SEARCH_BAR_REDUCER_KEY]=s.searchBarReducer,r);n=t.getStoreAndRegisterReducers(e)}return n;var r}}),define("modules/clean/search/search_bar/data/types",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e.FOCUS="SEARCH_BAR_FOCUS",e.BLUR="SEARCH_BAR_BLUR",e.CLEAR="SEARCH_BAR_CLEAR",e.UPDATE_HISTORY="SEARCH_BAR_UPDATE_HISTORY",e.ADD_QUERY_TO_HISTORY="SEARCH_BAR_ADD_QUERY_TO_HISTORY",e.CLEAR_ALL_HISTORY="SEARCH_BAR_CLEAR_ALL_HISTORY",e.SET_QUERY="SEARCH_BAR_SET_QUERY",e.SET_SUGGESTIONS="SEARCH_BAR_SET_SUGGESTIONS",e.SET_SLIM_SUGGESTIONS="SEARCH_BAR_SET_SLIM_SUGGESTIONS",e.SET_HIGHLIGHTED_ROW="SEARCH_BAR_SET_HIGHLIGHTED_ROW",e.HIGHLIGHT_PREVIOUS_ROW="SEARCH_BAR_HIGHLIGHT_PREVIOUS_ROW",e.HIGHLIGHT_NEXT_ROW="SEARCH_BAR_HIGHLIGHT_NEXT_ROW",e.SET_BROWSE_SCOPE="SEARCH_BAR_SET_BROWSE_SCOPE",e.SET_SCOPE_CHIP="SEARCH_BAR_SET_SCOPE_CHIP"})(r.ActionTypes||(r.ActionTypes={}))}),define("modules/clean/search/search_bar/dispatcher",["require","exports","modules/clean/flux/dispatcher"],function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SearchBarDispatcher=t.Dispatcher}),define("modules/clean/search/search_bar/experiments",["require","exports","modules/clean/search/types","modules/core/exception","external/lodash"],function(e,r,t,s,n){"use strict";function a(e){if(void 0!==u)return void s.assert(n.isEqual(u,e),"mismatch of expected and provided experiments");u=e}function o(){return u||{}}function i(e){return e.expSearchRecentHistory===t.SearchRecentHistoryVariants.WITH_ICON||e.expSearchRecentHistory===t.SearchRecentHistoryVariants.WITHOUT_ICON}function c(e){u=e}function _(){u=void 0}
Object.defineProperty(r,"__esModule",{value:!0});var u=void 0;r.initSearchBarExperiments=a,r.getSearchBarExperiments=o,r.searchRecentHistoryEnabled=i,r.testMockSetup=c,r.testMockTeardown=_}),define("modules/clean/search/search_bar/history",["require","exports","external/lodash","modules/clean/search/constants","modules/clean/storage","modules/clean/search/logger"],function(e,r,t,s,n,a){"use strict";function o(e){return n.UserLocalStorage.get(e.id,s.SEARCH_RECENT_HISTORY_STORAGE_KEY)||[]}function i(e,r,i,c){void 0===i&&(i=""),void 0===c&&(c="");var _=o(e),u=function(e,r){return e.normalizedQuery===r.normalizedQuery},h=t.findIndex(_,function(e){return u(e,r)});return a.logRecentQueryStored({searchSessionId:i,requestId:c,query:r,user:e,previousPosition:h}),_=_.filter(function(e){return!u(e,r)}),_=[r].concat(_).slice(0,s.SEARCH_RECENT_HISTORY_CAPACITY),n.UserLocalStorage.set(e.id,s.SEARCH_RECENT_HISTORY_STORAGE_KEY,_),_}function c(e,r){void 0===r&&(r=""),a.logRecentHistoryCleared({searchSessionId:r,user:e});var t=[];return n.UserLocalStorage.set(e.id,s.SEARCH_RECENT_HISTORY_STORAGE_KEY,t),t}function _(){n.UserLocalStorage.clearOtherUsers([])}function u(){n.UserLocalStorage.clearOtherUsers([])}Object.defineProperty(r,"__esModule",{value:!0}),r.getHistory=o,r.addQuery=i,r.clearAll=c,r.testMockSetup=_,r.testMockTeardown=u}),define("modules/clean/search/search_bar/log_helper",["require","exports","modules/clean/search/logger","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/data/selectors"],function(e,r,t,s,n){"use strict";function a(e){var r=e.result,a=e.user,o=e.action_type,i=e.viewport,c=e.view_type,_=e.searchSessionID;t.logSearchAction({searchSessionId:_||n.searchSessionID(s.getStoreForSearchBar().getState()),result:r,user:a,action_type:o,viewport:i,view_type:c})}Object.defineProperty(r,"__esModule",{value:!0}),r.logDropdownSearchAction=a}),define("modules/clean/search/search_bar/store",["require","exports","tslib","modules/clean/flux/base_store","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/data/action_creators","modules/clean/search/constants"],function(e,r,t,s,n,a,o,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=(function(e){function r(r){var t=e.call(this,r)||this;return t._reduxStore=n.getStoreForSearchBar(),t}return t.__extends(r,e),r.prototype.isSearchBarFocused=function(){return a.isSearchBarFocused(this._reduxStore.getState())},r.prototype.isSearchBarActive=function(){return a.isSearchBarActive(this._reduxStore.getState())},r.prototype.isSearchBarLoading=function(){return a.isSearchBarLoading(this._reduxStore.getState())},r.prototype.rawQuery=function(){return a.rawQuery(this._reduxStore.getState())},r.prototype.normalizedQuery=function(){return a.normalizedQuery(this._reduxStore.getState())},r.prototype.searchHistory=function(){return a.searchHistory(this._reduxStore.getState())},r.prototype.searchSuggestions=function(){return a.searchSuggestions(this._reduxStore.getState())},r.prototype.hasMoreResults=function(){return a.hasMoreResults(this._reduxStore.getState())},r.prototype.slimSearchSuggestions=function(){return a.slimSearchSuggestions(this._reduxStore.getState())},r.prototype.highlightedSearchRow=function(){return a.highlightedSearchRow(this._reduxStore.getState())},r.prototype.browseScope=function(){return a.browseScope(this._reduxStore.getState())},r.prototype.scopeChip=function(){return a.scopeChip(this._reduxStore.getState())},r.prototype.searchSessionID=function(){return a.searchSessionID(this._reduxStore.getState())},r.prototype.findSearchFileSuggestion=function(e){var r=e.fq_path;return a.searchResultForPath(this._reduxStore.getState(),r)},r.prototype.headerItems=function(){return a.headerItems(this._reduxStore.getState())},r.prototype.searchPath=function(){return a.searchPath(this._reduxStore.getState())},r.prototype._focusSearchBar=function(e){var r=e.user;this._reduxStore.dispatch(o.focusSearchBar({user:r})),this.emit_change()},r.prototype._blurSearchBar=function(){this._reduxStore.dispatch(o.blurSearchBar()),this.emit_change()},r.prototype._setSearchQuery=function(e){var r=e.query,t=e.qsid,s=e.keepHighlightedRow,n=e.path;this._reduxStore.dispatch(o.setSearchQuery({query:r,searchSessionID:t,keepHighlightedRow:s,searchPath:n})),this.emit_change()},r.prototype._setSearchSuggestions=function(e){var r=e.searchResults,t=e.hasMoreResults;this._reduxStore.dispatch(o.setSearchSuggestions({searchSuggestions:r,hasMoreResults:t})),this.emit_change()},r.prototype._setSlimSearchSuggestions=function(e){var r=e.searchResults,t=e.hasMoreResults;this._reduxStore.dispatch(o.setSlimSearchSuggestions({slimSearchSuggestions:r,hasMoreResults:t})),this.emit_change()},r.prototype._setHighlightedSearchRow=function(e){var r=e.index;this._reduxStore.dispatch(o.setHighlightedRow({highlightedSearchRow:r})),this.emit_change()},r.prototype._highlightPreviousSearchRow=function(){this._reduxStore.dispatch(o.highlightPreviousRow()),this.emit_change()},r.prototype._highlightNextSearchRow=function(){this._reduxStore.dispatch(o.highlightNextRow()),this.emit_change()},r.prototype._clearSearch=function(){this._reduxStore.dispatch(o.clearSearchBar()),this.emit_change()},r.prototype._searchSuccessful=function(e){var r=e.user,t=e.query,s=e.searchSessionId,n=e.requestId;this._reduxStore.dispatch(o.addQueryToHistory({user:r,query:t,searchSessionId:s,requestId:n})),this.emit_change()},r.prototype._setScopeChip=function(e){var r=e.canScope,t=e.scope;this._reduxStore.dispatch(o.setScopeChip({canScope:r,scopeChip:t})),this.emit_change()},r.prototype._clearAllHistory=function(e){var r=e.user;this._reduxStore.dispatch(o.clearAllHistory({user:r})),this.emit_change()},r.prototype._new_payload=function(e){var r=e.action;switch(r.type){case i.FOCUS_SEARCH_BAR_ACTION:this._focusSearchBar(r.data);break;case i.BLUR_SEARCH_BAR_ACTION:this._blurSearchBar();break;case i.SET_SEARCH_QUERY_ACTION:this._setSearchQuery(r.data);break;case i.SET_SEARCH_SUGGESTIONS_ACTION:this._setSearchSuggestions(r.data);break;case i.SET_SLIM_SEARCH_SUGGESTIONS_ACTION:this._setSlimSearchSuggestions(r.data);break;case i.SET_HIGHLIGHTED_ROW_ACTION:this._setHighlightedSearchRow(r.data);break;case i.HIGHLIGHT_PREVIOUS_ROW_ACTION:this._highlightPreviousSearchRow();break;case i.HIGHLIGHT_NEXT_ROW_ACTION:this._highlightNextSearchRow();break;case i.CLEAR_SEARCH_BAR_ACTION:this._clearSearch();break;case i.SEARCH_SUCCESSFUL_ACTION:this._searchSuccessful(r.data);break;case i.SET_SCOPE_CHIP_ACTION:this._setScopeChip(r.data);break;case i.CLEAR_ALL_HISTORY_ACTION:this._clearAllHistory(r.data)}},r})(s);r.SearchBarStore=c,r.searchBarStore=new c}),define("modules/clean/search/search_bar/view",["require","exports","tslib","external/classnames","external/spectrum/icon_global","external/spectrum/icon_content","external/react","modules/clean/keycode","modules/clean/react/maestro/a11y_constants","modules/clean/search/types","modules/core/i18n","modules/clean/web_timing_logger","modules/clean/search/search_bar/chips","modules/clean/search/search_bar/experiments"],function(e,r,t,s,n,a,o,i,c,_,u,h,l,d){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var p=(function(r){function n(){var e=null!==r&&r.apply(this,arguments)||this;return e._renderDropdown=function(){},e._handleNavigation=function(){e._searchBarInput.blurSearchBarTextInput()},e._onHistoryItemClick=function(r,t){e.props.onHistoryItemClick&&e.props.onHistoryItemClick(r,t)},e._onSearchResultOpen=function(r){e.props.onSearchResultOpen(r),e._handleNavigation()},e._onResultObjectPathClick=function(r){e.props.onResultObjectPathClick(r),e._handleNavigation()},e._onSearch=function(r){var t=e.props.onSearch;t&&t(r),e._handleNavigation()},e._setSearchBarInputRef=function(r){return e._searchBarInput=r},e._setSearchBarDropdownRef=function(r){e._searchBarDropdown=r},e}return t.__extends(n,r),n.prototype.getSearchBarInput=function(){return this._searchBarInput},n.prototype.getSearchBarDropdown=function(){return this._searchBarDropdown},n.prototype._shouldRenderDropdown=function(){var e=this.props,r=e.searchBarExperiments,t=e.searchHistory,s=e.normalizedQuery,n=e.dropdownHeaderItems,a=_.SearchBarDropdownHeaderItemType.SCOPE_CHIPS;return!!(d.searchRecentHistoryEnabled(r)&&t&&t.length||l.chipsEnabled(r)&&n&&n.indexOf(a)!==-1||s&&s.length)},n.prototype.componentDidMount=function(){var r=this;h.waitForTTI().then(function(){e(["modules/clean/search/search_bar/dropdown"],function(e){var s=e.SearchBarDropdown;r._renderDropdown=function(){return r._shouldRenderDropdown()?o.createElement(s,t.__assign({},r.props,{searchHistory:r.props.searchHistory||[],onHistoryItemClick:r._onHistoryItemClick,onSearchResultOpen:r._onSearchResultOpen,onResultObjectPathClick:r._onResultObjectPathClick,onSearch:r._onSearch,isOpen:r.props.isFocused,ref:r._setSearchBarDropdownRef,searchBarExperiments:r.props.searchBarExperiments,dropdownHeaderItems:r.props.dropdownHeaderItems||[]})):null},r._shouldRenderDropdown()&&r.forceUpdate()})})},n.prototype.render=function(){var e=this.props,r=e.isActive,n=e.isExpanded,a=e.isFocused,i={"is-active":r,"is-collapsed":!(n||a),"is-expanded":n,"is-focused":a,"search-bar":!0};return o.createElement("div",{className:"search-bar--container u-l-fr"},o.createElement("div",{className:s(i)},o.createElement(E,t.__assign({},this.props,{ref:this._setSearchBarInputRef})),this._renderDropdown()))},n.defaultProps={rawQuery:"",normalizedQuery:"",showLinkToResultsPage:!0},n})(o.Component);r.SearchBarView=p;var E=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.focusSearchBarTextInput=function(){r.props.isFocused||r._searchBarTextInput.focus()},r._onKeyDown=function(e){e.keyCode===i.KeyCode.ESC&&r.blurSearchBarTextInput(),r.props.onInputKeydown(e,r._getCursorPosition())},r._onSubmit=function(e){var t=r.props.highlightedRow,s=r.props.searchHistory||[],n=!r.props.normalizedQuery&&s.length>0,a=r.props.dropdownHeaderItems||[],o=t-a.length;if(n&&o>=0){e.preventDefault();var i=s[o];return void(r.props.onHistoryItemClick&&r.props.onHistoryItemClick(i,o))}return t<a.length&&a[t]===_.SearchBarDropdownHeaderItemType.SCOPE_CHIPS||r.blurSearchBarTextInput(),r.props.onInputSubmit(e,t)},r._setSearchBarTextInputRef=function(e){return r._searchBarTextInput=e},r}return t.__extends(r,e),r.prototype._getCursorPosition=function(){return this._searchBarTextInput.selectionEnd},r.prototype.getSearchBarTextInput=function(){return this._searchBarTextInput},r.prototype.blurSearchBarTextInput=function(){this._searchBarTextInput.blur(),this.props.onSearchBarBlur()},r.prototype.render=function(){var e=this.props,r=e.onInputChange,s=e.onSearchBarFocus,a=e.onSearchBarBlur,i=e.placeholder,_=e.isFocused,h=e.isActive,l=e.highlightedRow,d=e.rawQuery;return o.createElement("form",{className:"search-bar__input",onSubmit:this._onSubmit},o.createElement("button",{"aria-label":u._("Search"),className:"search-bar__button",type:"submit"},o.createElement(n.IconGlobal,{name:"search-small"})),o.createElement(S,t.__assign({},this.props,{focusSearchInput:this.focusSearchBarTextInput})),o.createElement("input",{"aria-activedescendant":"search-dropdown-suggestion"+l,"aria-autocomplete":"list","aria-expanded":_&&h,"aria-label":u._("Search"),"aria-owns":"search-bar__suggestions",className:"search-bar__text-input",onChange:r,onFocus:s,onBlur:a,onKeyDown:this._onKeyDown,placeholder:i?i:u._("Search"),ref:this._setSearchBarTextInputRef,role:"combobox",value:d,tabIndex:c.LAYOUT_TAB_ORDER.SEARCH_BAR}))},r})(o.Component),S=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r._onMouseDownFocus=function(e){e.stopPropagation(),e.preventDefault(),r.props.focusSearchInput()},r._onMouseDownClose=function(e){e.stopPropagation(),e.preventDefault();var t=r.props.onSearchChipInteraction;t&&(t(!1),r.props.focusSearchInput())},r}return t.__extends(r,e),r.prototype.render=function(){return this.props.scopeChip&&l.chipsEnabled(this.props.searchBarExperiments)&&l.isValidPathForChip(this.props.scopeChip)?o.createElement("ul",{className:"search_bar__chip_list"},this._renderChip()):null},r.prototype._renderChip=function(){var e=u._("This Folder");return o.createElement("li",{className:"search_bar__chip",title:e,onMouseDown:this._onMouseDownFocus},o.createElement(a.IconContent,{name:"folder-small",height:"17px",width:"17px"}),o.createElement("span",{className:"search_bar__chip_text"},e),o.createElement("span",{className:"search_bar__chip_x",onMouseDown:this._onMouseDownClose}))},r})(o.Component)}),define("modules/clean/search/search_helpers",["require","exports","external/sjcl","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/api","modules/clean/react/browse/models","modules/clean/search/models","modules/core/i18n","modules/core/uri","modules/clean/browse_uri_interface","modules/core/cookies"],function(e,r,t,s,n,a,o,i,c,_,u,h){"use strict";function l(e){var r=e.user,t=e.searchPath,s=e.normalizedQuery,n=e.searchSessionID;return new _({path:"/search/"+r.role,query:{path:t,query:s,qsid:n,search_token:S()}})}function d(e,r){return e instanceof i.SlimFileSearchResult?u.browse_uri_for_fq_path(r,e.fq_path).toString():e.url}function p(e){var r=e.searchBarApiClient,t=e.searchResult,_=e.user,u=e.onSuccess,h=e.onError;if(t instanceof i.SlimFileSearchResult){var l=n.searchResultForPath(s.getStoreForSearchBar().getState(),t.fq_path);l?u(l):r.fetchAdditionalFileMetadata({searchResults:[t],user:_}).then(function(e){if(e.length>0)u(e[0]);else if(h){var r=c._("There was a problem completing this request.");h(r)}}).catch(function(e){!h||e instanceof a.RequestAbortedError||h(e.message)})}else(t instanceof o.Paper||t instanceof o.PaperFolder)&&u(t)}function E(e){return 0===e.button&&!e.altKey&&!e.ctrlKey&&!e.metaKey}function S(){var e=t.codec.utf8String.toBits(h.read("__Host-js_csrf")),r=t.codec.utf8String.toBits("search"),s=new t.misc.hmac(e);return t.codec.base64.fromBits(s.encrypt(r))}Object.defineProperty(r,"__esModule",{value:!0}),r.buildSearchURL=l,r.resultObjectToUrl=d,r.fetchFullSearchResult=p,r.shouldHandleClick=E,r.getSearchCsrfToken=S}),define("modules/clean/search/store_helpers",["require","exports"],function(e,r){"use strict";function t(e){return e.trim().replace(/\ +/g," ")}function s(e){return!t(e)}function n(e,r){return!(s(e)||!s(r))||e.length>=3&&1===r.length}function a(){for(var e="",r=0;r<32;r++){var t=Math.floor(10*Math.random());e+=String(t)}return e}Object.defineProperty(r,"__esModule",{value:!0}),r.normalize=t,r.isBlank=s,r.shouldStartNewSearchSession=n,r.generateRandomID=a}),define("modules/clean/search/types",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SearchResultTypes={FILE:"FILE",PAPER:"PAPER",PAPER_FOLDER:"PAPER_FOLDER"};(function(e){e.WITH_ICON="WITH_ICON",e.WITHOUT_ICON="WITHOUT_ICON",e.OFF="OFF",e.CONTROL="CONTROL"})(r.SearchRecentHistoryVariants||(r.SearchRecentHistoryVariants={}));(function(e){e.CHIP_IN="CHIP_IN",e.CHIP_OUT="CHIP_OUT",e.OFF="OFF",e.CONTROL="CONTROL"})(r.SearchChipsVariants||(r.SearchChipsVariants={}));(function(e){e.CACHED="CACHED",e.UNCACHED="UNCACHED",e.OFF="OFF",e.CONTROL="CONTROL"})(r.HoverPreviewsVariants||(r.HoverPreviewsVariants={}));(function(e){e.RENDER="RENDER",e.CALCULATE_ONLY="CALCULATE_ONLY",e.OFF="OFF",e.CONTROL="CONTROL"})(r.DropdownThumbnailVariants||(r.DropdownThumbnailVariants={}));(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL"})(r.ScopeFilterRightRailVariants||(r.ScopeFilterRightRailVariants={}));(function(e){e.SEARCH_ALL="SEARCH_ALL",e.SCOPE_CHIPS="SCOPE_CHIPS"})(r.SearchBarDropdownHeaderItemType||(r.SearchBarDropdownHeaderItemType={}))}),define("modules/clean/sharing/access_level",["require","exports","external/lodash"],function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e[e.ACCESS_NO_ACCESS=0]="ACCESS_NO_ACCESS",e[e.ACCESS_READER_NO_COMMENT=-10]="ACCESS_READER_NO_COMMENT",e[e.ACCESS_READER=1]="ACCESS_READER",e[e.ACCESS_WRITER=2]="ACCESS_WRITER",e[e.ACCESS_OWNER=3]="ACCESS_OWNER"})(r.NameSpaceAccess||(r.NameSpaceAccess={})),r.ACCESS_LEVEL={OWNER:"owner",WRITER:"writer",READER:"reader",READER_NO_COMMENT:"reader_no_comment"},r.ACCESS_VALUES=t.values(r.ACCESS_LEVEL);var s={reader_no_comment:-10,reader:1,writer:2,owner:3};r.isLowerAccess=function(e,t){var n=Object.keys(s);return e!==t&&n.indexOf(e)!==-1&&n.indexOf(t)!==-1&&r.getMaxAccess([e,t])===e},r.getMaxAccess=function(e){if(0===e.length)throw Error("Argument accessLevels are not valid.");for(var r=e[0],t=s[r],n=0;n<e.length;n++){var a=e[n],o=s[a];o>t&&(t=o,r=a)}return r}}),define("modules/clean/web_user_action_events",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e.ADD_COMMENT="add_comment",e.ARCHIVE="archive",e.ATTACHMENT_ADD_SUCCESS="attachment_add_success",e.ATTACHMENT_CLICKED="attachment_clicked",e.ATTACHMENT_REMOVED="attachment_removed",e.CALENDAR_TAB_CLICKED="calendar_tab_clicked",e.CLICK_ADD_ATTACHMENT="click_add_attachment",e.CLICK_CONVERT_INDIVIDUAL_ACCOUNT="click_convert_individual_account",e.CLICK_LEARN_MORE_ACCOUNT_CONVERSION="click_learn_more_account_conversion",e.CLICK_PATH_LINK="click_path_link",e.CLICK_REVIEW_SUMMARY_DELETE_USER="click_review_summary_delete_user",e.CONTEXT_MENU="context_menu",e.COPY="copy",e.CREATE_FOLDER="create_folder",e.DISBAND_TEAM_KEEP="disband_team_keep",e.DISBAND_TEAM_LEARN_MORE="disband_team_learn_more",e.DISBAND_TEAM_VIEW="disband_team_view",e.DELETE="delete",e.DOWNLOAD="download",e.EVENTS="events",e.FILE_VIEW="file_view",e.FOLDER_OPEN="folder_open",e.LEAVE_TEAM_CANCEL="leave_team_cancel",e.LEAVE_TEAM_LEARN_MORE="leave_team_learn_more",e.LEAVE_TEAM_VIEW="leave_team_view",e.LINK_GOOGLE_CAL_CLICKED="link_google_cal_clicked",e.LINK_GOOGLE_CAL_SUCCESS="link_google_cal_success",e.MOVE="move",e.OPEN_ADD_TO_COLLECTION_MODAL="open_add_to_collection_modal",e.OPEN_CALENDAR_FLYOUT="open_calendar_flyout",e.OPEN_COPY_MODAL="open_copy_modal",e.OPEN_DELETE_USER_MODAL="open_delete_user_modal",e.OPEN_MOVE_MODAL="open_move_modal",e.OPEN_ROW="open_row",e.PAPER_CONTEXT_MENU="paper_context_menu",e.PAPER_OPEN="paper_open",e.PERMANENT_DELETE="permanent_delete",e.RENAME="rename",e.RESTORE="restore",e.SELECT_ROW="select_row",e.SHARE="share",e.SHOW_IN_FOLDER="show_in_folder",e.SORT_RECORDS="sort_records",e.STAR="star",e.REMOVE_STAR="remove_star",e.SWITCH_ACCOUNT="switch_account",e.SWITCH_VIEW_TYPE="switch_view_type",e.TOGGLE_DELETED_FILES="toggle_deleted_files",e.UNMOUNTED_VIEW="unmounted_view",e.UPLOAD_FILE="upload_file",e.VERSIONS="versions",e.VIEW_SHARE_MODEL="view_share_model",e.OPEN_DESKTOP="open_via_unity"})(r.WebUserActionLogEvent||(r.WebUserActionLogEvent={}))}),define("modules/clean/web_user_action_logger",["require","exports","modules/clean/ajax"],function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_ERRORS=3;var s=(function(){function e(){this.errorCount=0,this.lastError=Date.now(),this.shouldReport=!0}return e.prototype.log=function(e,s,n){var a=this;return this.shouldReport&&(this.errorCount<r.MAX_ERRORS||Date.now()-this.lastError>6e5)?new Promise(function(o,i){t.SilentBackgroundRequest({url:"/log/web_user_action",data:{_subject_uid:e,event_type:s,extra_params:JSON.stringify(n)},error:function(e){429===e.status?a.errorCount=r.MAX_ERRORS:a.errorCount++,a.lastError=Date.now(),i(e)},success:function(e){try{var r=JSON.parse(e);r&&!r.continue_sending&&(a.shouldReport=!1),a.errorCount=0,o(e)}catch(e){throw a.errorCount++,a.lastError=Date.now(),i(e),e}}})}):Promise.resolve({})},e})();r.WebUserActionLogClass=s,r.WebUserActionLog=new s});
//# sourceMappingURL=pkg-embedded_app.min.js-vflmso2Po.map