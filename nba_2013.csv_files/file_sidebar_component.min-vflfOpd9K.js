define(["require","exports","tslib","external/react","modules/core/i18n","modules/clean/react/file_sidebar/file_sidebar_base","modules/clean/react/file_sidebar/store/sidebar/helpers","modules/clean/react/file_sidebar/store/sidebar/actions","modules/clean/react/file_sidebar/store/sidebar/selectors","modules/clean/react/file_sidebar/store/file_activity/actions","modules/clean/react/file_sidebar/store/file_activity/selectors","modules/clean/react/file_sidebar/file_sidebar_connect","modules/clean/react/file_sidebar/comments_wrapper_component","modules/clean/react/file_activity_stream/file_activity_stream","modules/clean/react/file_sidebar/file_sidebar_logger","modules/clean/video_annotations_prototype/video_annotation_wrapper_component","modules/clean/video_annotations_prototype/video_annotation_prototype_helper"],function(e,t,i,o,n,r,s,a,l,c,p,d,u,m,_,b,f){"use strict";function h(e){return{activityContext:e.activityContext,hideComments:e.hideComments,isCommentsDemo:e.isCommentsDemo,shouldInitiallyFocusInput:e.shouldInitiallyFocusInput,currentFile:e.currentFile,sharedLinkInfo:e.sharedLinkInfo,user:e.user,showToggleButton:e.showToggleButton}}function y(e){return i.__assign({},l.getSidebarState(e),{fileActivityCount:p.getVisibleActivityCount(e),tabs:l.getTabsState(e)})}Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSelectTab=function(e){var i=t.props,o=i.dispatch,n=i.fileActivityCount,r=i.tabs.comments,s=i.user;o(a.selectTab(e)),_.logSidebarTabSelected({selected_tab:e,num_comments:r.extra.commentCount,num_events:n,viewing_user_id:s?s.id:null})},t}return i.__extends(t,e),t.prototype.notifyStore=function(e){this.props.dispatch(a.openFile({file:e.currentFile,isVersionHistoryMode:e.isVersionHistoryMode,user:e.user})),e.user&&this.props.dispatch(c.getActivityStream(e.user.id,e.currentFile))},t.prototype.componentDidMount=function(){this.notifyStore(this.props)},t.prototype.componentWillReceiveProps=function(e){var t={file:this.props.currentFile,isVersionHistoryMode:this.props.isVersionHistoryMode,user:this.props.user},i={file:e.currentFile,isVersionHistoryMode:e.isVersionHistoryMode,user:e.user};s.isContextChanged(t,i)&&this.notifyStore(e)},t.prototype.componentWillUnmount=function(){this.props.dispatch(c.reset()),this.props.dispatch(a.reset())},t.prototype.renderCommentsTab=function(){if(f.VideoAnnotationPrototypeHelper.shouldShowVideoPrototype(this.props.currentFile)){var e=f.VideoAnnotationPrototypeHelper.toVideoAnnotationsWrapperProps(this.props);return o.createElement(r.FileSidebarBase.Tab,{key:"comments",name:n._("Comments"),count:0},o.createElement(b.VideoAnnotationWrapperComponent,i.__assign({},e)))}var e=h(i.__assign({},this.props,{hideComments:!1,hideCommentsOverride:!1}));return o.createElement(r.FileSidebarBase.Tab,{key:"comments",name:n._("Comments"),count:this.props.tabs.comments.count},o.createElement(u.CommentsWrapperComponent,i.__assign({},e)))},t.prototype.renderFileActivityTab=function(){var e=this.props,t=e.currentFile,i=e.user;return o.createElement(r.FileSidebarBase.Tab,{key:"activity",name:n._("Activity")},o.createElement(m.FileActivityStream,{file:t,user:i}))},t.prototype.render=function(){var e=this.props,t=e.activeTab,i=e.open,n=e.ready,s=e.tabs,a=s.comments,l=s.activity,c=[a.show?this.renderCommentsTab():null,l.show?this.renderFileActivityTab():null].filter(function(e){return e});return 0===c.length?o.createElement("div",{className:"file-sidebar"}):o.createElement(r.FileSidebarBase,{activeTabKey:t,isOpen:n&&i,onSelectTab:this.onSelectTab,headerComponent:this.props.headerComponent},c)},t})(o.Component);t.FileSidebarComponent=d.fileSidebarConnect(y)(v)});
//# sourceMappingURL=file_sidebar_component.min.js-vfli7AD_G.map