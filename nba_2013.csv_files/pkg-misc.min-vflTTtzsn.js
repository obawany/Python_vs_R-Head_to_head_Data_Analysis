define("modules/clean/browse/browse_drag_utils",["require","exports"],function(t,e){"use strict";function o(t){if(!t||!t.types)return null;if((function(t,e){for(var o=0,n=t;o<n.length;o++){if(e===n[o])return!0}return!1})(t.types,"Files"))return null;var e,o=null;try{e=t.getData("text/x-moz-url")}catch(t){}if(null!=e){var n=e.split("\n");n.length>=1&&(o=n[0])}if(!o)try{o=t.getData("text/uri-list")}catch(t){}if(!o)try{o=t.getData("Url")}catch(t){}return o||(o=null),o}function n(t){return"[InternetShortcut]\r\nURL="+t+"\r\n"}function i(){for(var t=0,e=u;t<e.length;t++){if(!(0,e[t])())return!1}return!0}function r(t){u.push(t)}function s(t){var e=u.indexOf(t);e>=0&&u.splice(e,1)}function a(){u=[]}Object.defineProperty(e,"__esModule",{value:!0});var u=[];e.getDraggedLink=o,e.buildUrlLinkfileContents=n,e.isFileDragEnabled=i,e.addFileDragEnabledCheck=r,e.removeFileDragEnabledCheck=s,e.removeAllFileDragEnabledChecks=a}),define("modules/clean/comments/utils",["require","exports","modules/clean/activity/activity_user","modules/clean/comments/revisions","modules/clean/comments/store","modules/clean/react/file_viewer/store","modules/clean/viewer","modules/constants/comments_panel","modules/clean/annotations/annotation","modules/core/exception","modules/core/i18n"],function(t,e,o,n,i,r,s,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(t){if(t===-1)return new o.ActivityUser({id:-1,fname:"Demo",lname:"User",display_name:"Demo User",email:"demo_user@example.com",initials:"DU",is_email_verified:!0,is_signed_in:!0});var e=s.Viewer.get_viewer();return null!=t?o.ActivityUser.fromUser(e.get_user_by_id(t)):e.work_user||e.personal_user?o.ActivityUser.fromUser(e.work_user||e.personal_user):e.is_signed_in?void 0:new o.ActivityUser};e.getActivityUser=u;var d=function(t){return u(t.actorId).is_signed_in},l=function(){if(!i.isFileActivityReady())return!1;var t=i.isCommentingEnabled();return a.ALLOW_VIEW_ANNOTATE_MODES||(t=t&&!i.areCommentsHidden()),t},c=function(t){if(!i.isFileActivityReady())return!1;var e=d(i.state);return null==t&&(t=r.FileViewerStore.instance.getIsFullscreen()),e&&l()&&!t&&n.isRevisionEqual(i.state.viewing.revision,i.state.activity.latest_revision)};e.canAnnotate=c;var h=function(){return!!c()&&(a.ALLOW_VIEW_ANNOTATE_MODES?i.state.regionCreationEnabled:!i.areCommentsHidden())};e.isRegionCreationEnabled=h;var _=function(){return!i.areCommentsHidden()&&l()};e.shouldShowExistingAnnotations=_;var p=function(){return this.keyCode||this.which||this.charCode};e.normalizedKeyCode=p}),define("modules/clean/legacy_pyxl_controllers/bubble_dropdown",["require","exports","external/lodash","jquery","modules/clean/keycode","modules/core/dom"],function(t,e,o,n,i,r){"use strict";var s=(function(){function t(e,i,r,s,a,u,d){var l=this;null==u&&(u=0),this.closeDropdown=this.closeDropdown.bind(this),this.openDropdown=this.openDropdown.bind(this),this.repositionDropdown=this.repositionDropdown.bind(this),this._activateNonButton=this._activateNonButton.bind(this),this._onTargetKeydown=this._onTargetKeydown.bind(this),this._onDropdownKeydown=this._onDropdownKeydown.bind(this),this._on_mouseover=this._on_mouseover.bind(this),this._on_mouseout=this._on_mouseout.bind(this),this._on_global_hover=this._on_global_hover.bind(this),this._toggle_bubble=this._toggle_bubble.bind(this),this._show_bubble=this._show_bubble.bind(this),this._hide_bubble=this._hide_bubble.bind(this),this.$root=e,this.arrow_direction=i,this.show_on_hover=r,this.show_close_button=s,this.shown_by_default=a,this.top_adjustment=u,this.tabindex=d,this.$target=this.$root.find(".bubble-dropdown-target"),this.$dropdown=this.$root.find(".bubble-dropdown"),this.$arrow_anchor=this.$root.find(".bubble-dropdown-arrow-anchor"),this.$arrow=this.$dropdown.find(".bubble-arrow");var c={top:"bottom",left:"right",bottom:"top",right:"left"};if(this.target_position=c[this.arrow_direction],this.$target.on("keydown",this._onTargetKeydown),this.$dropdown.on("keydown",this._onDropdownKeydown),this.$target.attr("aria-expanded",!1),this.show_close_button)this.$root.find(".bubble-dropdown-x").on("click",this.closeDropdown);else if(this.show_on_hover){if(this.$target.on("mouseover",this._on_mouseover),this.$dropdown.on("mouseover",this._on_mouseover),this.$target.on("mouseout",this._on_mouseout),this.$dropdown.on("mouseout",this._on_mouseout),this.$target.attr("tabindex",0).on("focus",this._show_bubble),0===this.$dropdown.find(this._focus_selectors).length){var h=o.uniqueId("bubble-dropdown-tooltip-");this.$dropdown.attr({id:h,role:"tooltip"}),this.$target.attr("aria-describedby",h)}n(document).on(t.HOVER_SHOWN,this._on_global_hover)}else{this.$target.click(this._toggle_bubble);var _=0;this.tabindex&&(_=this.tabindex),"BUTTON"!==this.$target.get(0).tagName&&this.$target.attr({role:"button",tabindex:_}).on("keyup",this._activateNonButton),n("body").on("click",function(t){return!!n(t.target).is("select")||(n(t.target).closest(l.$target).length||n(t.target).closest(l.$dropdown).length||l._hide_bubble(),!0)})}this.shown_by_default&&this.openDropdown()}return t.initClass=function(){this.HOVER_SHOWN="bubble:hover:shown",this.prototype._dropdown_shown=!1,this.prototype._focus_selectors="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]"},t.prototype.closeDropdown=function(){if(this._dropdown_shown)return this._hide_bubble()},t.prototype.openDropdown=function(){if(!this._dropdown_shown)return this._show_bubble()},t.prototype.repositionDropdown=function(){if(this._dropdown_shown)return this._show_bubble()},t.prototype._activateNonButton=function(t){if([i.KeyCode.ENTER,i.KeyCode.SPACE].includes(t.keyCode))return this._toggle_bubble(),!1},t.prototype._onTargetKeydown=function(t){return(t.keyCode===i.KeyCode.ESC&&!this.show_on_hover||t.keyCode===i.KeyCode.TAB&&t.shiftKey||t.keyCode===i.KeyCode.TAB&&1===this.$root.find(this._focus_selectors).length)&&this._hide_bubble(),!0},t.prototype._onDropdownKeydown=function(t){if(this.show_on_hover||t.keyCode!==i.KeyCode.ESC){if(t.keyCode===i.KeyCode.TAB&&!t.shiftKey){var e=this.$root.find(this._focus_selectors);t.target===e[e.length-1]&&this._hide_bubble(!this.show_on_hover)}}else this._hide_bubble(!0);return!0},t.prototype._on_mouseover=function(){return n(document).trigger(t.HOVER_SHOWN,this.$target),this._show_bubble(),clearTimeout(this.$dropdown.data("timeout_id"))},t.prototype._on_mouseout=function(){var t=setTimeout(this._hide_bubble,200);return this.$dropdown.data("timeout_id",t)},t.prototype._on_global_hover=function(t,e){if(this._dropdown_shown&&e!==this.$target)return this._hide_bubble(),clearTimeout(this.$dropdown.data("timeout_id"))},t.prototype._toggle_bubble=function(){return this._dropdown_shown?this._hide_bubble():this._show_bubble(),!0},t.prototype._show_bubble=function(){var t,e;if(!this.$target.hasClass("disabled")){this.$dropdown.show();var o=this.$arrow_anchor.length?this.$arrow_anchor:this.$target,n=this.$arrow.position().top,i=this.$arrow.position().left;switch(this.arrow_direction){case"left":t=o.outerWidth()+this.$arrow.outerWidth(),e=o.outerHeight()/2-n;break;case"right":t=-1*(this.$dropdown.outerWidth()+this.$arrow.outerWidth()),e=o.outerHeight()/2-n;break;case"top":t=o.outerWidth()/2-i,e=o.outerHeight()+this.$arrow.outerHeight()-this.top_adjustment;break;case"bottom":t=o.outerWidth()/2-i,e=-1*(this.$dropdown.outerHeight()+this.$arrow.outerHeight()+this.top_adjustment)}return r.clone_position(this.$dropdown,o,{setHeight:!1,setWidth:!1,offsetLeft:t,offsetTop:e}),this._dropdown_shown=!0,this.$target.addClass("bubble-dropdown-target--active").attr("aria-expanded",!0)}},t.prototype._hide_bubble=function(t){if(this.$dropdown.hide(),this._dropdown_shown=!1,this.$target.removeClass("bubble-dropdown-target--active").attr("aria-expanded",!1),t)return this.$target.focus()},t})();return s.initClass(),s}),define("modules/clean/legacy_pyxl_controllers/bubble_menu",["require","exports","tslib","jquery","modules/clean/keycode","modules/clean/legacy_pyxl_controllers/bubble_dropdown"],function(t,e,o,n,i,r){"use strict";return(function(t){function e(e,o,n,i){var r=this;return null==i&&(i=0),r=t.call(this,e,o,n,null,null,i)||this,r.onMouseEnter=r.onMouseEnter.bind(r),r.onKeyDown=r.onKeyDown.bind(r),r.$target.on("keydown",r.onKeyDown),r.$menu=r.$root.find('*[role="menu"]'),r.$menuitems=r.$root.find('*[role="menuitem"]'),r.$menuitems.attr("role","menuitem"),r.$menuitems.on("keydown",r.onKeyDown),r.$menuitems.on("mouseenter",r.onMouseEnter),r}return o.__extends(e,t),e.prototype.focusPrevious=function(t){var e=this.$menuitems.index(t);return e=[-1,0].includes(e)?this.$menuitems.length-1:e-1,this.$menuitems.get(e).focus()},e.prototype.focusNext=function(t){var e=this.$menuitems.index(t);return e=[-1,this.$menuitems.length-1].includes(e)?0:e+1,this.$menuitems.get(e).focus()},e.prototype.onMouseEnter=function(t){return n(this.$menu).removeClass("bubble-menu--keyboard")},e.prototype.onKeyDown=function(t){return n(this.$menu).addClass("bubble-menu--keyboard"),t.keyCode===i.KeyCode.DOWN?(this.focusNext(t.target),t.stopPropagation(),t.preventDefault()):t.keyCode===i.KeyCode.UP?(this.focusPrevious(t.target),t.stopPropagation(),t.preventDefault()):void 0},e})(r)}),define("modules/clean/legacy_pyxl_controllers/input",["require","exports","tslib","jquery","modules/clean/accessibility/tabbable","modules/clean/web_timing_logger","modules/core/exception","modules/core/i18n"],function(t,e,o,n,i,r,s,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(t){var e=n.data(t,"input-element");return s.assert(e.length,"TextInput element has no related input element please ensure it was setup correctly"),e};n.valHooks.textinput={get:function(t){return u(t).val()},set:function(t,e){return u(t).val(e).trigger("input")}};var d=(function(t){function e(e,o){void 0===o&&(o=!0);var i=t.call(this)||this;return i._on_change=i._on_change.bind(i),i.$text_input=e,i.persistent_label=i.$text_input.is(".label-above"),i.$input=i.$text_input.find(".text-input-input"),i.$text_input.data("input-element",i.$input),i.$label=i.$text_input.find("label"),i.$text_input.find(".error-message").length&&i.$input.addClass("input-error"),i.$text_input.each(function(t,e){return e.type="textinput"}),i.$text_input.focus(function(){return setTimeout(function(){return i.$input.focus()},0)}),n(function(){if("BODY"===(null!=document.activeElement?document.activeElement.tagName:void 0))return n(".autofocus:visible").first().focus()}),i._listen(),o&&i._on_change(),i}return o.__extends(e,t),e.prototype._listen=function(){var t=this;return this.$input.on("keydown keyup paste input blur",function(){return t._on_change()}),this.$input.on("blur",function(e){return t.$text_input.trigger(e)}),this.$input.on("focus",function(){return t.$input.removeClass("input-error")})},e.prototype._on_change=function(){this.persistent_label||this.$label.toggle(!this.$input.val());var t=this.$text_input.find(".error-message");if(t.length)return t[0].remove()},e})(i);e.TextInput=d;var l=(function(t){function e(e,o){void 0===o&&(o=!0);var n=t.call(this,e,o)||this;return n.$caps=n.$text_input.find(".password-caps-indicator"),n.$caps_lock=!1,n.$text_input.on("keypress",function(t){var e,o=/Mac/.test(navigator.platform),i=null!=t.charCode?t.charCode:t.keyCode,r=String.fromCharCode(i);return r.toLowerCase()===r.toUpperCase()?e=void 0:r===r.toLowerCase()?e=t.shiftKey:r!==r.toUpperCase()||t.shiftKey&&o||(e=!t.shiftKey),null!=e&&(n.$caps_lock=e),n.$caps_lock?n.$caps.addClass("password-caps-indicator-activated"):n.$caps.removeClass("password-caps-indicator-activated")}),n}return o.__extends(e,t),e})(d);e.PasswordInput=l;var c=(function(e){function i(o,n){var i=e.call(this,o,!1)||this;return i._on_change=i._on_change.bind(i),i.$bubble_title=i.$text_input.find(".password-bubble-title"),i.$bubble_desc=i.$text_input.find(".password-bubble-desc"),i.$meter=i.$text_input.find(".password-input-meter"),i.$default_bubble_text=i.$bubble_desc.text(),i.$last_pwd="",i._on_change(),n?r.waitForTTI().then(function(){return t(["external/zxcvbn"],function(t){return i.zxcvbn=t})}):t(["external/zxcvbn"],function(t){return i.zxcvbn=t}),i}return o.__extends(i,e),i.prototype._on_change=function(){var t,o,n=this.$input.val();if(this.$last_pwd!==n){if(this.$last_pwd=n,"correcthorsebatterystaple"===n||"Tr0ub4dour&3"===n||"Tr0ub4dor&3"===n){var i=void 0;t=0,o=a._("lol",{comment:"'lol'='laugh out loud'"}),this.$bubble_title.text(o),"correcthorsebatterystaple"===n?(i=a._("Whoa there, don't take advice from a webcomic too literally ;)",{comment:"This text is displayed rarely, whenever a user selects a password that is from this comic: http://imgs.xkcd.com/comics/password_strength.png"}),this.$bubble_desc.text(i)):(i=a._("Guess again",{comment:"this text is displayed rarely, whenever a user selects a password that is from this comic: http://imgs.xkcd.com/comics/password_strength.png"}),this.$bubble_desc.text(i))}else{var r=["",a._("Weak"),a._("So-so"),a._("Good"),a._("Great!")];t=this._score(n),o=r[t],this.$bubble_title.text(o),this.$bubble_desc.text(this.$default_bubble_text)}return this.$meter.find(".password-input-dot").removeClass("password-input-dot-selected"),this.$meter.find(".password-input-dot").slice(4-t,4).addClass("password-input-dot-selected"),e.prototype._on_change.call(this)}},i.prototype._get_user_inputs=function(){for(var t=["dropbox"],e=0,o=Array.from(this.$text_input.closest("form").find("input[type=text], input[type=email]"));e<o.length;e++){var i=o[e];t.push(n(i).val())}return t},i.prototype._score=function(t){return this.zxcvbn&&t?Math.max(1,this.zxcvbn(t,this._get_user_inputs()).score):0},i})(l);e.PasswordWatchInput=c}),define("modules/clean/react/browse/comment_status",["require","exports","modules/clean/activity/constants","modules/clean/file_activity/api","modules/clean/filetypes","modules/clean/flux/dispatcher","modules/clean/react/browse/actions","modules/clean/react/browse/constants","modules/clean/react/browse/store","modules/core/exception"],function(t,e,o,n,i,r,s,a,u,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l={},c=function(t){return d.assert(!!u.getBrowseStore().user(),"Called fetchCommentStatus but the browse store user was not set"),n.fetchCommentStatusBatch({actorId:u.getBrowseStore().user().id,context:o.ActivityContext.BROWSE_FILE_VIEWER,contextDataList:t,isBackgroundRequest:!0})},h=function(t){return null==t.feedback_off&&null==t.comment_count&&null==t.unresolved_comment_count},_=function(t){return t.type===i.FileTypes.FILE},p=function(t){return null!=t.after},b=function(t){var e=t.files,o=e.filter(_).filter(h).map(function(t){return t.fq_path});o.length>0&&c(o).then(function(t){"requestIdleCallback"in window?window.requestIdleCallback(function(){return s.browseActions.addCommentStatusBatch({commentStatusByFqPath:t})}):s.browseActions.addCommentStatusBatch({commentStatusByFqPath:t})})},f=function(t){var e=t.fileDeltas;t.path;b({files:e.filter(p).map(function(t){return t.after})})},m=function(t){var e=t.action;switch(e.type){case a.BrowseActionType.LOAD_PATH:case a.BrowseActionType.ADD_FILES_AND_SET_LOADING_STATE:b(e.data);break;case a.BrowseActionType.ADD_FILES:b(e.data);break;case a.BrowseActionType.INITIALIZE_EVERYTHING:b(e.data);break;case a.BrowseActionType.CHANGE_FILES:f(e.data)}};e.setup=function(t){void 0===t&&(t=r.Dispatcher),l={dispatcher:t,dispatchToken:t.register(m)},b({files:u.getBrowseStore().files().toArray()})},e.teardown=function(){l.dispatcher&&l.dispatchToken&&l.dispatcher.unregister(l.dispatchToken),l={}}});
//# sourceMappingURL=pkg-misc.min.js-vflFEIq-B.map